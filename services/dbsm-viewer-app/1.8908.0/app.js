!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("_")):"function"==typeof define&&define.amd?define("dbsm-viewer-app",["_"],t):"object"==typeof exports?exports["dbsm-viewer-app"]=t(require("_")):e["dbsm-viewer-app"]=t(e._)}("undefined"!=typeof self?self:this,e=>(()=>{var t,r,n={161:(e,t,r)=>{"use strict";t.__esModule=!0,t.makeValuePresentation=void 0;var n=r(2321),o=r(8536);t.makeValuePresentation=({dataType:e,format:t,fieldType:r,value:n},o)=>{const a=i({format:t,fieldType:r,value:n},o);return s({dataType:e,fieldType:r,value:a})};const a=[n.FieldType.date,n.FieldType.time,n.FieldType.dateTime],i=({format:{type:e,params:t}={},fieldType:r,value:n},i)=>"datetime"===e&&(a.includes(r)||o.Value.isIsoString(n))?l({fieldType:r,value:n,dateFormat:t.dateFormat},i):c({fieldType:r,value:n}),s=({value:e,fieldType:t,dataType:r})=>(d[r]??d.default)({fieldType:t,value:e}),l=({dateFormat:e,fieldType:t,value:r},{formatter:a})=>{const i=t===n.FieldType.time?`1970-01-01T${r}Z`:r,s=new Date(i);if(isNaN(s.getTime())||t===n.FieldType.dateTime&&!o.Value.isIsoString(r))return r;const l=t===n.FieldType.date||t===n.FieldType.time?"UTC":void 0;return a.formatDateTime(s.toISOString(),e,{timeZone:l})},c=({fieldType:e,value:t})=>t&&(e===n.FieldType.dateTime||o.Value.isIsoString(t))?new Date(t).toString():t,d={text:({fieldType:e,value:t})=>null==t?"":Array.isArray(t)?t.join(", "):e===n.FieldType.address?"object"==typeof t&&"formatted"in t?t.formatted:t:String(t),default:({value:e})=>e}},168:(e,t,r)=>{"use strict";var n=r(6441).isPromise,o=r(9199),a=o.sequence,i=o.try_,s=r(5369),l=r(5556),c=l.isEffect,d=l.isImmediateEffect,u=l.isQueuedEffect,p=function(e){return function(t){return e.push(t),function(){var r=e.indexOf(t);r>=0&&e.splice(r,1)}}};e.exports=function(){var e=[],t=[],r=Promise.resolve();return{middleware:function(o){return function(l){return function(p){var f=function(e){var t=i(function(){return e.run()});return t.fold(function(r){var n=e.resultActionCreator?o.dispatch(e.resultActionCreator(!0,r)):Promise.resolve();return[t,n]},function(r){if(n(r)){var a=r.then(function(t){return e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,t)):Promise.resolve()},function(t){throw e.resultActionCreator&&o.dispatch(e.resultActionCreator(!0,t)).catch(function(){}),t});return[t,a]}var i=e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,r)):Promise.resolve();return[t,i]})},h=function(){var e=void 0,n=new Promise(function(t){return e=t}),o=new Promise(function(e,o){var a=r=r.then(function(){return n}).then(function(e,t){return function(r){if(r.length>0){var n=r.filter(u).map(f);return Promise.all(n.map(function(e){return e[1]})).then(function(){return e()},t),Promise.all(n.map(function(e){return e[0]}).map(function(e){return e.fold(function(e){return Promise.reject(e)},function(e){return e})})).catch(t)}return e(),Promise.resolve()}}(e,o),o).catch(o).then(function(){a===r&&t.slice().forEach(function(e){return e()})})});return{promise:o,trigger:e}},m=function(e){var t=h(),r=t.promise,n=t.trigger;return i(function(){return function(e){var t=e.filter(d).map(f);return t.map(function(e){return e[0]}).map(function(e){return e.fold(function(e){throw e},function(e){return e})}),t.map(function(e){return e[1]}).map(function(e){return e.catch(function(){})}),e.filter(u)}(e)}).fold(function(e){throw n([]),e},function(e){return n(e),r})},g=o.getState(),y=l(p),v=o.getState();if(g!==v){var _=s(g,v);return a(e.slice().map(function(e){return i(function(){return e(_)||[]})})).fold(function(e){throw e},function(e){return m(e.filter(c))})}return Promise.resolve(y)}}},subscribe:p(e),onIdle:p(t)}}},298:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ExpressionError:()=>n,arrayResult:()=>y,booleanResult:()=>S,dateResult:()=>g,errorResult:()=>v,evaluateExpression:()=>R,getErrorInExpression:()=>P,getExpressionFunctions:()=>N,htmlStringResult:()=>I,isVariableUsed:()=>C,loadExpressionFunctions:()=>b,nullResult:()=>_,numberResult:()=>T,objectResult:()=>m,plainTextResult:()=>E,undefinedResult:()=>w});class n extends Error{constructor(e,t){super(e),this._errorParams=t}get errorParams(){return this._errorParams}}const o={ALIGN:(e,t,r)=>`<p style="text-align: ${t};" class="wixui-rich-text__text">${r}</p>`,SPACES:(e,t)=>"&nbsp;".repeat(Number(t)),STRIKE:(e,t)=>s(e,`<span style="text-decoration: line-through" class="wixui-rich-text__text">${t}</span>`),UNDERLINE:(e,t)=>s(e,`<span style="text-decoration: underline" class="wixui-rich-text__text">${t}</span>`),ITALIC:(e,t)=>s(e,`<span style="font-style: italic" class="wixui-rich-text__text">${t}</span>`),BOLD:(e,t)=>s(e,`<span style="font-weight: bold" class="wixui-rich-text__text">${t}</span>`),HIGHLIGHT:(e,t,r)=>s(e,`<span style="background-color: ${t}" class="wixui-rich-text__text">${r}</span>`),COLOR:(e,t,r)=>s(e,`<span style="color: ${t}" class="wixui-rich-text__text">${r}</span>`)},a=e=>"string"==typeof e.name&&e.name in o,i=e=>void 0!==e&&(!!a(e)||i(e.parentFunction));function s(e,t){return i(e.parentFunction)?t:`<p class="wixui-rich-text__text">${t}</p>`}const l=(...e)=>[...e],c={true:!0,false:!1,undefined:void 0,null:null},d=e=>Object.prototype.hasOwnProperty.call(c,e),u=({expression:e,functions:t,variables:r,throwIfVariableUnknown:i})=>{if("integer"===e.type)return parseInt(e.value);if("float"===e.type)return parseFloat(e.value);if("string"===e.type)return e.value;if("function"===e.type){const s=e.arguments.map(e=>u({expression:e,functions:t,variables:r,throwIfVariableUnknown:i}));if("function"==typeof e.name)return e.name(...s);if(a(e))return o[e.name](e,...s);const l=t[e.name];if(l)return l(...s);throw new n("Unknown function "+e.name,{key:"Expression_Editor_Error_Unknown_Function",function:e.name})}if("variable"===e.type){if(d(e.name))return c[e.name];if(i&&!(e.name in r))throw new n("Unknown variable "+e.name,{key:"Expression_Editor_Error_Unknown_Variable",fieldId:e.name});return r[e.name]}throw new Error("Unknown AST node "+JSON.stringify(e))},p=(e,t)=>new n("Syntax error. "+e,{key:t}),f=e=>{if(0===e.trim().length)return{type:"string",parentFunction:void 0,closed:!0,value:"",doubleQuoted:!1,startedAt:0};let t={type:"initial",parentFunction:void 0},r=0,n=e[r];const o=()=>{n=e[++r]},a=e=>{t={type:"initial",parentFunction:e},o()},i=()=>void 0===n||")"===n&&(t.parentFunction&&!t.parentFunction.closed||"function"===t.type&&!t.closed)||"]"===n&&(t.parentFunction&&t.parentFunction.name===l&&!t.parentFunction.closed||"function"===t.type&&t.name===l&&!t.closed),s=()=>{if(void 0===n){const r=t.parentFunction||t;if("function"===r.type&&!r.closed){if(r.name===l)throw p("Array was not closed. Started at index "+r.startedAt+" with: "+e.slice(r.startedAt),"Expression_Editor_Error_Missing_Brackets");throw p("Function was not closed. Started at index "+r.startedAt+" with: "+e.slice(r.startedAt),"Expression_Editor_Error_Missing_Parentheses")}}if(t.parentFunction)return"function"!==t.type||t.closed?(t.parentFunction.closed=!0,t=t.parentFunction,t.parentFunction&&(t=t.parentFunction)):(t.closed=!0,t=t.parentFunction),void o();for(o();/^\s$/.test(n||"");)o();if(void 0!==n)throw p("Unexpected characters after a finished expression at index "+r+": "+e.slice(r),"Expression_Editor_Error_Unexpected_Symbol_After_Parentheses");return t};for(;;){if("initial"===t.type){if("["===n){t={type:"function",parentFunction:t.parentFunction,closed:!1,name:l,startedAt:r,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("-"===n){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:"-"},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("_"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){t={type:"variable",parentFunction:t.parentFunction,closed:!1,name:n,startedAt:r},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if('"'===n||"'"===n){t={type:"string",parentFunction:t.parentFunction,closed:!1,doubleQuoted:'"'===n,startedAt:r,value:""},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(/^\s$/.test(n)){o();continue}throw p(`Unexpected character "${n}" near: ${e.slice(r)}`,"Expression_Editor_Error_Unwanted_Symbols")}if("function"!==t.type){if("integer"===t.type){if("."===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"float",parentFunction:t.parentFunction,closed:!1,value:t.value+n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("_"===n||"-"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"variable",parentFunction:t.parentFunction,closed:!1,name:t.value+n,startedAt:r-t.value.length},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){if(t.closed)throw p(`Integer has unexpected whitespace near: ${e.slice(r-1)}`,"Expression_Editor_Error_Separated_Integer");t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw p(`Unexpected character "${n}" after integer near: ${e.slice(r)}`,"Expression_Editor_Error_Separated_Integer")}if("float"===t.type){if(n>="0"&&n<="9"){if(t.closed)throw p(`Floating number has unexpected whitespace near: ${e.slice(r-1)}`,"Expression_Editor_Error_Separated_Decimal");t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw p(`Floating number has an unexpected character "${n}" near: ${e.slice(r)}`,"Expression_Editor_Error_Separated_Decimal")}if("string"!==t.type){if("variable"===t.type){if(n>="0"&&n<="9"||"_"===n||"-"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){if(t.closed)throw p(`Unexpected whitespace near: ${e.slice(r-1)}`,"Expression_Editor_Error_Separated_Field_Id");t.name+=n,o();continue}if("("===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"function",parentFunction:t.parentFunction,closed:!1,name:t.name,startedAt:t.startedAt,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw p(`Unexpected character "${n}" in an identifier near: ${e.slice(r-1)}`,"Expression_Editor_Error_Separated_Field_Id")}}else{if(t.closed){if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}throw p("Unexpected characters after a closed string at index "+r+": "+e.slice(r),"Expression_Editor_Error_Unexpected_Symbol_After_Quotes")}if(void 0===n)throw t.doubleQuoted?p(`Double-quoted string was not closed. Started with: ${e.slice(t.startedAt)}`,"Expression_Editor_Error_Missing_Double_Quotes"):p(`Single-quoted string was not closed. Started with: ${e.slice(t.startedAt)}`,"Expression_Editor_Error_Missing_Single_Quote");if("\\"===n){if("\\"!==e[r+1]&&'"'!==e[r+1]&&"'"!==e[r+1])throw p(`Backslash cannot escape character ${e[r+1]} near: ${e.slice(r)}`,"Expression_Editor_Error_Separated_Field_Id");t.value+=e[r+1],o()}else t.doubleQuoted&&'"'===n||!t.doubleQuoted&&"'"===n?t.closed=!0:t.value+=n;o()}}else{if(","===n){if(t.closed)throw p("Unexpected comma after a closed top-level function near: "+e.slice(r),"Expression_Editor_Error_Unexpected_Symbol_After_Parentheses");if(0===t.arguments.length)throw p("Function was not closed or first argument missing. Started at index "+t.startedAt+" with: "+e.slice(t.startedAt),"Expression_Editor_Error_Extra_Comma_In_Function");a(t);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}if(t.closed)throw p(`Unexpected character "${n}" near: ${e.slice(r)}`,"Expression_Editor_Error_Unexpected_Symbol_After_Parentheses");t={type:"initial",parentFunction:t}}}},h=e=>"function"===e.type&&(!!a(e)||e.arguments.some(e=>h(e))),m=e=>({type:"object",value:e}),g=e=>({type:"date",value:e}),y=e=>({type:"array",value:e}),v=e=>({type:"error",value:e}),_=()=>({type:"null",value:null}),E=e=>({type:"plainText",value:e}),I=e=>({type:"htmlString",value:e}),T=e=>({type:"number",value:e}),S=e=>({type:"boolean",value:e}),w=()=>({type:"undefined",value:void 0}),R=({expression:e,functions:t,variables:r,throwIfVariableUnknown:n=!1})=>(({expression:e,functions:t,variables:r,throwIfVariableUnknown:n})=>{const o=u({expression:e,functions:t,variables:r,throwIfVariableUnknown:n});return null===o?_():void 0===o?w():"boolean"==typeof o?S(o):"number"==typeof o||"bigint"==typeof o?T(o):"string"==typeof o?h(e)?I(o):E(o):o instanceof Date?g(o):o instanceof Error?v(o):Array.isArray(o)?y(o):"object"==typeof o?m(o):E("Error: unsupported value type "+typeof o)})({expression:f(e),functions:t,variables:r,throwIfVariableUnknown:n}),P=({expression:e,functions:t,variables:r})=>{try{return void(t&&r?R({expression:e,functions:t,variables:r,throwIfVariableUnknown:!0}):f(e))}catch(e){return e instanceof n?e:new n(e instanceof Error?e.message:"Unexpected error: "+e)}},C=(e,t)=>{if(d(t))return!1;const r=e=>{switch(e.type){case"variable":return e.name===t;case"function":return e.arguments.some(r);default:return!1}};try{return r(f(e))}catch{return!1}};let O;const b=async()=>{if(O)return;const{utils:e,...t}=await r.e(622).then(r.bind(r,1330));O={...t,...e.symbols}},N=()=>O},798:(e,t)=>{"use strict";var r=Object.prototype.hasOwnProperty;function n(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,a,i=[];for(a in"string"!=typeof t&&(t="?"),e)if(r.call(e,a)){if((n=e[a])||null!=n&&!isNaN(n)||(n=""),a=o(a),n=o(n),null===a||null===n)continue;i.push(a+"="+n)}return i.length?t+i.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,o={};t=r.exec(e);){var a=n(t[1]),i=n(t[2]);null===a||null===i||a in o||(o[a]=i)}return o}},958:e=>{"use strict";const t=Symbol.for("union-type-any-symbol"),r=e=>r=>{const n=Object.keys(r);for(const t of n)if(t===e.name)return r[t](e.payload);if(r[t])return r[t]();throw new Error(`Variant "${e.name}" not covered in pattern with keys [${n}].\nThis could mean you did not include all variants in your Union's matchWith function.`)},n=(e,t,n={})=>Object.keys(t).reduce((o,a)=>(o[a]=((e,t,n,o)=>{const a=Symbol(`[${e}:${t}]`),i=(...e)=>{const i=n(...e),s={matchWith:r({name:t,payload:i}),toString:()=>t,[a]:!0};return Object.keys(o).forEach(e=>{s[e]=o[e](s)}),s};return i.hasInstance=e=>e&&!0===e[a],i})(e,a,t[a],n),o),{});n.any=t,e.exports=n},998:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMS_PLUGIN_ID=t.PAGE_LINK_PLUGIN_ID=t.SHARED_PLUGIN_ID=t.MULTILINGUAL_PLUGIN_ID=t.UrlizedFormat=t.URLIZED_PLUGIN_ID=t.SINGLES_PLUGIN_ID=t.GRID_APPLESS_PLUGIN_ID=t.PublishingStatus=t.DRAFT_DATE_FIELD_KEY=t.PUBLISH_DATE_FIELD_KEY=t.PUBLISH_STATUS_FIELD_KEY=t.PUBLISHING_PLUGIN_ID=void 0,t.PUBLISHING_PLUGIN_ID="publishing",t.PUBLISH_STATUS_FIELD_KEY="_publishStatus",t.PUBLISH_DATE_FIELD_KEY="_publishDate",t.DRAFT_DATE_FIELD_KEY="_draftDate",function(e){e.DRAFT="DRAFT",e.PUBLISHED="PUBLISHED"}(t.PublishingStatus||(t.PublishingStatus={})),t.GRID_APPLESS_PLUGIN_ID="gridAppless",t.SINGLES_PLUGIN_ID="singleItem",t.URLIZED_PLUGIN_ID="urlized",function(e){e.PLAIN="plain",e.ORIGINAL="original"}(t.UrlizedFormat||(t.UrlizedFormat={})),t.MULTILINGUAL_PLUGIN_ID="multilingual",t.SHARED_PLUGIN_ID="shared",t.PAGE_LINK_PLUGIN_ID="persistentPageLink",t.CMS_PLUGIN_ID="cms"},1298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=void 0;var n=r(9587);t.resultToWebMethodPayload=function(e,t){var r=t?JSON.parse(JSON.stringify(e,t)):(0,n.convertToCustomFormat)(e);return void 0===r?{}:{result:r}};t.exceptionToWebMethodPayload=function(e,t,r){return void 0===t&&(t=function(e){return e}),void 0===r&&(r=function(e){return""}),{result:e instanceof Error?{message:t(e.message),name:e.name,stack:r(e.stack),code:e.code,_elementoryError:!0}:e,exception:!0}};var o=function(e,t){return"/_webMethods/packages/".concat(encodeURIComponent(e),"/").concat(t,".ajax")};t.generatePackageWebMethodUrl=o;t.generateBackendPackageWebMethodUrl=function(e,t){return o("".concat(e,"-backend"),t)};t.getBackendPackageNameFromImportName=function(e){return"".concat(e,"-backend")}},1361:e=>{var t=Object.prototype.toString;function r(e){return"function"==typeof e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var n=typeof e;if("boolean"===n)return"boolean";if("string"===n)return"string";if("number"===n)return"number";if("symbol"===n)return"symbol";if("function"===n)return"GeneratorFunction"===r(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(r(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(n=t.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")}},1406:(e,t,r)=>{e.exports={ITEM_TYPES:r(6724).w$}},1460:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},1822:(e,t,r)=>{"use strict";t.__esModule=!0,t.Schema=void 0;var n=r(2321);const o=t.Schema={make:({id:e="",fields:t={}}={})=>({id:e,fields:t}),makeField:({type:e="text",referencedCollection:t}={})=>({type:e,referencedCollection:t}),getFieldType:(e,t)=>a(e,t).type,getReferencedCollectionIds:e=>{const t=Object.entries(e.fields).reduce((e,[t,{referencedCollection:r}])=>r?e.add(r):e,new Set);return Array.from(t)},getReferencedCollectionId:(e,t)=>a(e,t).referencedCollection,isFieldOfType:(e,t,r)=>o.getFieldType(e,t)===n.FieldType[r]},a=(e,t)=>e.fields[t]??{}},2110:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},2129:(e,t,r)=>{"use strict";t.__esModule=!0,t.datasetEvents=t.DatasetEvents=void 0;var n=r(6196);function o(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function a(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var i=new WeakMap;class s{constructor(){o(this,i,new Map)}static of(){return new s}on(e,t,r){a(i,this).has(e.id)||a(i,this).set(e.id,new Map);const n=a(i,this).get(e.id);n.has(t)||n.set(t,new Set);n.get(t).add(r)}off(e,t,r){if(!a(i,this).has(e.id))throw n.CoreError.of(`Dataset "${e.id}" has no subscriptions`);{const o=a(i,this).get(e.id);if(!o.has(t))throw n.CoreError.of("Can't unsubscribe from non existent event");{const s=o.get(t);if(!s.delete(r))throw n.CoreError.of("Can't unsubscribe a listener that was not subscribed");0===s.size&&(o.delete(t),0===o.size&&a(i,this).delete(e.id))}}}emit(e,t,...r){if(a(i,this).has(e.id)){const n=a(i,this).get(e.id);if(n.has(t))for(const e of n.get(t))e(...r)}}}t.DatasetEvents=s;t.datasetEvents=s.of()},2131:(e,t)=>{"use strict";t.__esModule=!0,t.Config=void 0;const r=t.Config={make:({livePreview:e=r.makeLivePreview()}={})=>({livePreview:e}),makeLivePreview:({enabled:e=!1,updatedComponentIds:t=[],dataIsInvalidated:r=!1}={})=>({enabled:e,updatedComponentIds:t,dataIsInvalidated:r}),isLivePreviewEnabled:e=>e.livePreview.enabled,filterConnectionsByUpdatedComponents:(e,t)=>{const{livePreview:{enabled:r,updatedComponentIds:n}}=e,o=new Set(n);return r&&n.length?t.filter(e=>o.has(e.compId)):t}}},2321:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(3709),t),o(r(2931),t),o(r(8313),t),o(r(9998),t),o(r(9666),t),o(r(1205),t),o(r(6742),t),o(r(4145),t),o(r(6219),t)},2523:e=>{e.exports=(e,t)=>t.reduce((e,t)=>e.chain(e=>t.map(t=>Array.isArray(t)?e.concat([t]):e.concat(t))),e.of([]))},2557:(e,t)=>{"use strict";t.__esModule=!0,t.Dataset=void 0;const r=t.Dataset={make:({id:e="",collectionId:t="",mode:n="read-write",pagination:o=r.makePagination(),currentRecordIndex:a=0,filter:i=null,sort:s=null}={})=>({id:e,collectionId:t,mode:n,pagination:o,currentRecordIndex:a,filter:i,sort:s}),makePagination:({type:e="offset",offset:t=0,pageSize:r=1,total:n=0}={})=>({type:e,offset:t,pageSize:r,total:n}),getReadOptions:({collectionId:e,filter:t,sort:r})=>({collectionId:e,filter:t,sort:r}),getTotalCount:e=>e.pagination.total,getCurrentRecordIndex:e=>e.currentRecordIndex,isReadonly:e=>"read"===e.mode,hasNextRecord:({pagination:{total:e},currentRecordIndex:t})=>t+1<e,hasPrevRecord:({currentRecordIndex:e})=>e>0,updateListing:(e,{records:t})=>({...e,records:t}),updateCurrentRecord:(e,t)=>({...e,records:[t]})}},2569:(e,t)=>{"use strict";t.__esModule=!0,t.Connection=void 0;const r=t.Connection={make:({compId:e="",...t}={})=>({compId:e,...r.makeDescriptor(t)}),makeDescriptor:({properties:e={},dynamicProperties:t={},extraData:r={},behaviors:n={}}={})=>({properties:e,dynamicProperties:t,extraData:r,behaviors:n})}},2614:(e,t,r)=>{"use strict";t.__esModule=!0,t.BindDataToComponents=void 0;var n=r(6196),o=r(2131);t.BindDataToComponents=({config:e,datasetEvents:t,errorReporter:r})=>({dataset:n,connections:s,components:l})=>{const c=i({errorReporter:r,errorMessage:"Failed executing component's method"});for(const{compId:r,behaviors:i}of s){const[s,d]=Object.entries(i).at(0)??[];if(!d)continue;const{[d.type]:u}=a,p=l.find(({id:e})=>e===r);o.Config.isLivePreviewEnabled(e)||(t.on(n,"dataInitialLoadSuccess",()=>c(p.execute,d.hide)),t.on(n,"dataLoadSuccess",()=>c(p.execute,d.hide)),t.on(n,"recordSaveAttempt",()=>c(p.execute,d.hide)),t.on(n,"recordChange",()=>c(p.execute,d.hide)),t.on(n,u,()=>c(p.execute,d.show)))}};const a={success:"recordSaveSuccess",failure:"recordSaveFailure"},i=({errorReporter:e,errorMessage:t})=>(r,...o)=>{try{r(...o)}catch(r){e.report(n.CoreError.of(t,{cause:r}))}}},2852:()=>{if("function"!=typeof self.queueMicrotask&&(self.queueMicrotask=function(e){Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}),"function"!=typeof Array.prototype.at){const e=Reflect.getPrototypeOf(Int8Array);for(const t of[Array,String,e])Object.defineProperty(t.prototype,"at",{value:function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0})}},2931:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Operator=void 0,function(e){e.and="$and",e.or="$or",e.not="$not",e.eq="$eq",e.ne="$ne",e.lt="$lt",e.lte="$lte",e.gt="$gt",e.gte="$gte",e.hasSome="$hasSome",e.hasAll="$hasAll",e.contains="$contains",e.startsWith="$startsWith",e.endsWith="$endsWith",e.urlized="$urlized"}(t.Operator||(t.Operator={}))},3185:t=>{"use strict";t.exports=e},3459:(e,t,r)=>{var n,o,a=r(1460),i=r(7253),s=0,l=0;e.exports=function(e,t,r){var c=t&&r||0,d=t||[],u=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:o;if(null==u||null==p){var f=a();null==u&&(u=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:l+1,g=h-s+(m-l)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,l=m,o=p;var y=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;d[c++]=y>>>24&255,d[c++]=y>>>16&255,d[c++]=y>>>8&255,d[c++]=255&y;var v=h/4294967296*1e4&268435455;d[c++]=v>>>8&255,d[c++]=255&v,d[c++]=v>>>24&15|16,d[c++]=v>>>16&255,d[c++]=p>>>8|128,d[c++]=255&p;for(var _=0;_<6;++_)d[c+_]=u[_];return t||i(d)}},3542:(e,t,r)=>{"use strict";t.__esModule=!0,t.makeBehaviorRelatedProps=void 0;var n=r(2557);t.makeBehaviorRelatedProps=(e,t)=>{const r=[];for(const[a,i]of Object.entries(e.behaviors)){var n;const e=null==(n=o[a])?void 0:n.call(o,i,t);null!=e&&e.length&&r.push(e)}return r};const o={input:({disabled:e},t)=>n.Dataset.isReadonly(t)?[e,!0]:[],click:({action:e,disabled:t},r)=>"next"===e&&!n.Dataset.hasNextRecord(r)||"previous"===e&&!n.Dataset.hasPrevRecord(r)?[t,!0]:[]}},3709:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e.asc="asc",e.desc="desc"}(t.Direction||(t.Direction={}))},3751:(e,t,r)=>{"use strict";t.__esModule=!0,t.propEntryMaker=void 0;var n=r(6196),o=r(2131),a=r(5212),i=r(1822),s=r(8536);t.propEntryMaker=e=>({schema:t,referencedSchemas:r,currentRecord:n,connection:o},a)=>{if(n){const i=l({schema:t,currentRecord:n,referencedSchemas:r,connection:o},a);if(c(a.config,i.value))return e({valueData:i,connection:o},a)}};const l=({schema:e,currentRecord:t,referencedSchemas:r,connection:{expression:n,fieldName:o}},a)=>n?d({expression:n,schema:e,currentRecord:t},a):u({fieldName:o,schema:e,referencedSchemas:r,currentRecord:t},a),c=(e,t)=>!(o.Config.isLivePreviewEnabled(e)&&s.Value.isEmpty(t)),d=({expression:e,schema:t,currentRecord:r},{dataExpression:o,errorReporter:a})=>{try{const{value:n,type:a}=o.evaluate({expression:e,variables:p(r,t)});return{value:n,type:a,fieldType:void 0}}catch(e){return a.report(n.CoreError.of("Failed to evaluate expression",{cause:e})),{value:"",type:void 0,fieldType:void 0}}},u=({currentRecord:e,fieldName:t,schema:r,referencedSchemas:o},{errorReporter:a})=>{const[s,l]=t.split(".");if(l){const t=i.Schema.getReferencedCollectionId(r,s),c=t&&o.find(({id:e})=>e===t);return c||a.report(n.CoreError.of("Referenced schema not found")),f({record:e[s]??{},fieldName:l,schema:c??i.Schema.make()})}return f({schema:r,record:e,fieldName:s})},p=(e,t)=>{const r={};for(const[n,o]of Object.entries(e))r[n]=(!i.Schema.isFieldOfType(t,n,"boolean")||!s.Value.isEmpty(o))&&o;return r},f=({record:e,fieldName:t,schema:r})=>({value:a.Record.getValue(e,t),fieldType:i.Schema.getFieldType(r,t)})},4058:(e,t,r)=>{"use strict";var n=r(168);e.exports={createMiddleware:n}},4145:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMS_FIELD_PLUGIN_ID=void 0,t.CMS_FIELD_PLUGIN_ID="cms"},4573:(e,t)=>{"use strict";t.EM=t.Jr=void 0,t.Jr="dataBinding",t.EM="1380b703-ce81-ff05-f115-39571d94dfcd";var r={}},5158:(e,t,r)=>{"use strict";t.__esModule=!0,t.RenderDataToComponents=void 0;var n=r(6196),o=r(2557),a=r(1822),i=r(2131),s=r(3751),l=r(5795),c=r(161),d=r(3542);t.RenderDataToComponents=({config:e,formatter:t,dataStore:r,errorReporter:s,dataExpression:l,mediaUtils:c})=>({dataset:d,connections:p,components:h})=>{const m=r.readSchema(d.collectionId),g=a.Schema.getReferencedCollectionIds(m),y=r.readSchemas(g),v=o.Dataset.getReadOptions(d),_=r.readRecords(v),E=f(d,_),I=i.Config.filterConnectionsByUpdatedComponents(e,p);for(const r of I){const o=u({connection:r,dataset:d,schema:m,referencedSchemas:y,currentRecord:E},{config:e,formatter:t,dataExpression:l,mediaUtils:c,errorReporter:s}),a=h.find(e=>e.id===r.compId);if(o.length)try{a.setData(Object.fromEntries(o))}catch(e){s.report(n.CoreError.of("Failed setting data to component",{cause:e}))}}};const u=(e,t)=>{const{connection:r,dataset:n}=e,o=[...(0,l.makeDynamicProps)(e,t),...(0,d.makeBehaviorRelatedProps)(r,n),...p(r)];for(const[n,a]of Object.entries(r.properties))if(a.properties){const r=u({...e,connection:a},t);o.push([n,Object.fromEntries(r)])}else{const r=(0,s.propEntryMaker)(({valueData:{value:e,fieldType:t},connection:{propName:r,format:n,dataType:o}},a)=>[r,(0,c.makeValuePresentation)({format:n,dataType:o,fieldType:t,value:e},a)]),i=r({...e,connection:{...a,propName:n}},t);i&&o.push(i)}return o},p=e=>{const t=[];for(const[r,n]of Object.entries(e.extraData))t.push([r,n]);return t},f=(e,t)=>{const r=o.Dataset.getCurrentRecordIndex(e);return t.at(r)}},5212:(e,t)=>{"use strict";t.__esModule=!0,t.Record=void 0;t.Record={make:(e={})=>({...e}),getValue:(e,t)=>e[t]}},5369:e=>{"use strict";e.exports=function(e,t){var r={from:e,to:t,hasChanged:function(r){return r(e)!==r(t)},hasChangedToMatch:function(e,n){return r.hasChanged(e)&&n(e(t))},hasChangedToTrue:function(e){return r.hasChangedToMatch(e,function(e){return!0===e})},hasChangedToFalse:function(e){return r.hasChangedToMatch(e,function(e){return!1===e})},hasChangedToNull:function(e){return r.hasChangedToMatch(e,function(e){return null===e})},hasChangedToNotNull:function(e){return r.hasChangedToMatch(e,function(e){return null!==e})}};return r}},5533:e=>{"use strict";const t=e=>({map:r=>t(r(e)),chain:t=>t(e),fold:(t,r)=>r(e),getOrElse:()=>e,orElse:()=>t(e),filter:n=>n(e)?t(e):r()}),r=()=>({map:()=>r(),chain:()=>r(),fold:e=>e(),getOrElse:e=>e,orElse:e=>e(),filter:()=>r()}),n={Just:t,Nothing:r,fromNullable:e=>null!=e?t(e):r(),of:e=>t(e)};e.exports=n},5556:e=>{"use strict";var t=function(e){return null!=e&&"function"==typeof e.run&&"boolean"==typeof e.isQueued&&(!e.resultActionCreator||"function"==typeof e.resultActionCreator)};e.exports={isEffect:t,isImmediateEffect:function(e){return t(e)&&!e.isQueued},isQueuedEffect:function(e){return t(e)&&e.isQueued}}},5583:e=>{e.exports.$={COMPONENT:"COMPONENT_SCOPE",GLOBAL:"GLOBAL_SCOPE"}},5795:(e,t,r)=>{"use strict";t.__esModule=!0,t.makeDynamicProps=void 0;var n=r(2321),o=r(2557),a=r(3751),i=r(161);t.makeDynamicProps=({connection:e,dataset:t,schema:r,referencedSchemas:n,currentRecord:o},a)=>{const i=[];if(Object.keys(e.dynamicProperties).length)for(const[s,l]of Object.entries(e.dynamicProperties)){const e=c[s]({dataset:t,schema:r,referencedSchemas:n,currentRecord:o,connection:l},a);e&&i.push(e)}return i};const s=(0,a.propEntryMaker)(({valueData:{value:e,type:t,fieldType:r},connection:{typeMapping:o,extraData:a,propName:s,format:c}},d)=>[o["htmlString"===t?n.FieldType.richText:r]??s,r===n.FieldType.url?l(e,a):(0,i.makeValuePresentation)({format:c,value:e,dataType:"text",fieldType:r},d)]),l=(e,t)=>{const r=e||"";return`<a href=${r} target="${(null==t?void 0:t.target)??"_blank"}"${null!=t&&t.rel?` rel="${t.rel}"`:""} style="text-decoration: underline">${r}</a>`},c={text:s,link:(0,a.propEntryMaker)(({valueData:{value:e},connection:{propName:t}},{mediaUtils:r})=>{let n;if(e)try{n=r.convertToUrl(e)}catch{n=e}else n="";return[t,n]}),totalCount:({dataset:e,connection:{propName:t}})=>{if("cursor"!==e.pagination.type)return[t,String(o.Dataset.getTotalCount(e))]}}},6076:(e,t,r)=>{var n=r(998).default,o=r(8921);e.exports=function(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},6096:(e,t,r)=>{var n=r(1460),o=r(7253);e.exports=function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[a+s]=i[s];return t||o(i)}},6196:(e,t,r)=>{"use strict";var n=r(2110);t.__esModule=!0,t.UserError=t.UnhandledPromiseRejection=t.ServerValidationError=t.ServerError=t.DatasetError=t.DataBindingError=t.CoreError=t.AppError=void 0;var o=n(r(9929));class a extends Error{static of(e,t,r){return new this(e,t,r)}static withMessage(e){return class extends(this){constructor(t,r){super(e,t,r)}}}static with({message:e,options:t}){return class extends(this){constructor(r){super(e||r instanceof String&&r,{...t,...r instanceof Object?r:{}})}}}constructor(e,t,r="DataBindingError"){super(e,t),(0,o.default)(this,"options",void 0),(0,o.default)(this,"scope",void 0),(0,o.default)(this,"code",void 0);const{cause:n,...a}=t||{};this.name=r,this.options=a,this.cause||(this.cause=n)}toString(){return this.cause?`${super.toString()}\nCaused by ${this.cause.toString()}`:super.toString()}}t.DataBindingError=a,(0,o.default)(a,"scopes",{USER_SCOPE:"userCodeZone",APPLICATION_SCOPE:"applicationCodeZone",SERVER_SCOPE:"wixDataCodeZone",CORE_SCOPE:"coreCodeZone"});t.AppError=class extends a{constructor(e,t){super(e,t,"AppError"),this.scope=a.scopes.APPLICATION_SCOPE}};t.CoreError=class extends a{constructor(e,t){super(e,t,"CoreError"),this.scope=a.scopes.CORE_SCOPE}};class i extends a{constructor(e,t,r="UserError"){super(e,t,r),this.scope=a.scopes.USER_SCOPE}}t.UserError=i;t.DatasetError=class extends i{constructor(e,t){const{code:r,...n}=t;super(e,n,"DatasetError"),this.code=r}};class s extends i{constructor(e,t){super(e,t,"ServerValidationError")}}t.ServerValidationError=s,(0,o.default)(s,"codes",["WD_SITE_IN_TEMPLATE_MODE","WD_PERMISSION_DENIED","WD_COLLECTION_DELETED","WD_VALIDATION_FAILED"]);t.ServerError=class extends a{constructor(e,t){const{code:r,...n}=t;super(e,n,"ServerError"),this.scope=a.scopes.SERVER_SCOPE,this.code=r}};t.UnhandledPromiseRejection=class extends a{constructor(e){super("Async operation error wasn't handled",e,"UnhandledPromiseRejection")}}},6219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6289:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapValues=void 0,t.mapValues=function(e,t){var r={};return Object.keys(e).forEach(function(n){var o=t(e[n]);void 0!==o&&(r[n]=o)}),r}},6441:e=>{"use strict";e.exports.isPromise=function(e){return null!=e&&"function"==typeof e.then}},6492:(e,t,r)=>{var n=r(3459),o=r(6096),a=o;a.v1=n,a.v4=o,e.exports=a},6500:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(){return!0},e.prototype.convertToCustomFormat=function(e,t){return t&&void 0===e?null:e},e.prototype.canConvertFromCustomFormat=function(){return!0},e.prototype.convertFromCustomFormat=function(e){return e},e}();t.DefaultConverter=r},6692:e=>{"use strict";const t=e=>({map:r=>t(r(e)),chain:t=>t(e),fold:(t,r)=>r(e),getOrElse:()=>e,merge:()=>e}),r=e=>({map:()=>r(e),chain:()=>r(e),fold:t=>t(e),getOrElse:e=>e,merge:()=>e}),n={Ok:t,Error:r,try:e=>{try{return t(e())}catch(e){return r(e)}},fromNullable:(e,n)=>null!=e?t(e):r(n),fromMaybe:(e,n)=>e.fold(()=>r(n),e=>t(e)),of:e=>t(e)};e.exports=n},6724:(e,t)=>{"use strict";t.w$=t.cb=void 0,t.cb="STATIC_PAGE_V2",t.w$={DEFAULT:"DEFAULT",STATIC_PAGE:"STATIC_PAGE",STATIC_PAGE_V2:t.cb,STORES_PRODUCT:"STORES_PRODUCT",FORUM_POST:"FORUM_POST",FORUM_CATEGORY:"FORUM_CATEGORY",PRO_GALLERY_ITEM:"PRO_GALLERY_ITEM",BLOG_POST:"BLOG_POST",BLOG_CATEGORY:"BLOG_CATEGORY",BLOG_TAGS:"BLOG_TAGS",BLOG_ARCHIVE:"BLOG_ARCHIVE",GROUPS_PAGE:"GROUPS_PAGE",GROUPS_POST:"GROUPS_POST",EVENTS_PAGE:"EVENTS_PAGE",CHALLENGES_PAGE:"CHALLENGES_PAGE",SEARCH_PAGE:"SEARCH_PAGE",BOOKINGS_SERVICE:"BOOKINGS_SERVICE",BOOKINGS_CALENDAR:"BOOKINGS_CALENDAR",BOOKINGS_FORM:"BOOKINGS_FORM",BREADCRUMBS_COMPONENT:"BREADCRUMBS_COMPONENT",BLOG_HASHTAGS:"BLOG_HASHTAGS",RESTAURANTS_ORDER_PAGE:"RESTAURANTS_ORDER_PAGE",MEMBERS_AREA_PROFILE:"MEMBERS_AREA_PROFILE",VIDEO_COMPONENT:"VIDEO_COMPONENT",PORTFOLIO_COLLECTIONS:"PORTFOLIO_COLLECTIONS",PORTFOLIO_PROJECTS:"PORTFOLIO_PROJECTS",GIFT_CARD:"GIFT_CARD",SCHEDULE_PAGE:"SCHEDULE_PAGE",WIX_DATA_PAGE_ITEM:"WIX_DATA_PAGE_ITEM",REVIEWS_COMPONENT:"REVIEWS_COMPONENT",STORES_CATEGORY:"STORES_CATEGORY",STORES_GALLERY_COMPONENT:"STORES_GALLERY_COMPONENT",PAGINATED_COMPONENT:"PAGINATED_COMPONENT",RESTAURANTS_MENU_PAGE:"RESTAURANTS_MENU_PAGE",RESTAURANTS_MENU_COMPONENT:"RESTAURANTS_MENU_COMPONENT",MEMBERS_AREA_PROFILE_TABS:"MEMBERS_AREA_PROFILE_TABS",SERVICES_COMPONENT:"SERVICES_COMPONENT",PAYMENT_PAGE:"PAYMENT_PAGE",THANK_YOU_PAGE:"THANK_YOU_PAGE",PROTECTED_PAGE:"PROTECTED_PAGE",MEMBERS_AREA_AUTHOR_PROFILE:"MEMBERS_AREA_AUTHOR_PROFILE",PRICING_PLANS:"PRICING_PLANS",EVENTS_LIST_COMPONENT:"EVENTS_LIST_COMPONENT",STORES_SUB_CATEGORY:"STORES_SUB_CATEGORY",IMAGES_COMPONENT:"IMAGES_COMPONENT",MEDIA_COMPONENT:"MEDIA_COMPONENT"}},6742:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMaxPageSize=void 0;const n=r(9666);t.DefaultMaxPageSize={[n.PagingMode.Offset]:1e3,[n.PagingMode.Cursor]:100}},7253:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,o=t;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},7301:(e,t,r)=>{"use strict";const n=r(958),o=r(6692),a=r(5533);e.exports={union:n,Result:o,Maybe:a}},7511:e=>{var t=Object.prototype.hasOwnProperty;function r(e){return"[Throws: "+(e?e.message:"?")+"]"}function n(e){var n=[];return function e(o){if(null===o||"object"!=typeof o)return o;if(-1!==n.indexOf(o))return"[Circular]";if(n.push(o),"function"==typeof o.toJSON)try{var a=e(o.toJSON());return n.pop(),a}catch(e){return r(e)}if(Array.isArray(o)){var i=o.map(e);return n.pop(),i}var s=Object.keys(o).reduce(function(n,a){return n[a]=e(function(e,n){if(t.call(e,n))try{return e[n]}catch(e){return r(e)}return e[n]}(o,a)),n},{});return n.pop(),s}(e)}e.exports=function(e,t,r){return JSON.stringify(n(e),t,r)},e.exports.ensureProperties=n},7877:(e,t,r)=>{"use strict";t.__esModule=!0;var n=r(2614);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||(t[e]=n[e]))});var o=r(5158);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===o[e]||(t[e]=o[e]))});var a=r(2557);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===a[e]||(t[e]=a[e]))});var i=r(2569);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||(t[e]=i[e]))});var s=r(5212);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||(t[e]=s[e]))});var l=r(1822);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===l[e]||(t[e]=l[e]))});var c=r(6196);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===c[e]||(t[e]=c[e]))});var d=r(2129);Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===d[e]||(t[e]=d[e]))});var u=r(8654);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===u[e]||(t[e]=u[e]))});var p=r(9327);Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===p[e]||(t[e]=p[e]))})},8313:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedFilterOperator=t.FieldType=void 0,function(e){e.number="number",e.text="text",e.image="image",e.boolean="boolean",e.document="document",e.url="url",e.richText="richtext",e.date="date",e.dateTime="datetime",e.video="video",e.reference="reference",e.multiReference="multi-reference",e.pageLink="pagelink",e.object="object",e.mediaGallery="media-gallery",e.address="address",e.stringArray="array<string>",e.color="color",e.audio="audio",e.time="time",e.array="array",e.richContent="rich-content",e.language="language",e.documentArray="array<document>",e.any="any",e.legacyBook="bookType",e.legacyExternalUrl="externalUrl",e.legacyBrokenRef="broken-reference",e.legacyExternalVideo="externalVideo",e.legacyImage="Image"}(t.FieldType||(t.FieldType={})),function(e){e.eq="eq",e.ne="ne",e.lt="lt",e.lte="lte",e.gt="gt",e.gte="gte",e.hasSome="hasSome",e.hasAll="hasAll",e.contains="contains",e.startsWith="startsWith",e.endsWith="endsWith",e.urlized="urlized",e.exists="exists"}(t.AllowedFilterOperator||(t.AllowedFilterOperator={}))},8360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertersComposer=void 0;var n=r(6289),o=function(e){return null!==e&&"object"==typeof e},a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._converters=e}return e.prototype.convertToCustomFormat=function(e,t,r){var n;if(void 0===t&&(t=new Set),void 0===r&&(r=!1),o(e)){if(t.has(e))throw new TypeError("Converting circular structure to JSON");t.add(e)}if(Array.isArray(e))return this._convertArray(e,t);var a=null===(n=this._findConverterToCustomFormat(e))||void 0===n?void 0:n.convertToCustomFormat(e,r);return o(e)?this._convertObject(a,e,t):a},e.prototype.convertFromCustomFormat=function(e){var t,r=this,a=e;return Array.isArray(e)?a=e.map(function(e){return r.convertFromCustomFormat(e)}):o(e)&&(a=(0,n.mapValues)(e,this.convertFromCustomFormat.bind(this))),null===(t=this._findConverterFromCustomFormat(a))||void 0===t?void 0:t.convertFromCustomFormat(a)},e.prototype._convertObject=function(e,t,r){var o,a=this;return o="function"==typeof e.toJSON?(0,n.mapValues)(e.toJSON(),function(e){return a.convertToCustomFormat(e,r)}):(0,n.mapValues)(e,function(e){return a.convertToCustomFormat(e,r)}),r.delete(t),o},e.prototype._convertArray=function(e,t){var r=this,n=e.map(function(e){return r.convertToCustomFormat(e,t,!0)});return t.delete(e),n},e.prototype._findConverterFromCustomFormat=function(e){return this._converters.find(function(t){return t.canConvertFromCustomFormat(e)})},e.prototype._findConverterToCustomFormat=function(e){return this._converters.find(function(t){return t.canConvertToCustomFormat(e)})},e}();t.ConvertersComposer=a},8536:(e,t)=>{"use strict";t.__esModule=!0,t.Value=void 0;t.Value={isEmpty:e=>""===e||null==e,isIsoString:e=>"string"==typeof e&&r.test(e)};const r=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?Z$/},8654:(e,t,r)=>{"use strict";var n=r(2110);t.__esModule=!0,t.dataExpression=t.DataExpression=void 0;var o=n(r(9929)),a=r(298);function i(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function s(e,t){return e.get(l(e,t))}function l(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var c=new WeakMap;class d{static of(e){return new d(e)}constructor(e){var t,r,n;(0,o.default)(this,"initialize",async()=>{await s(c,this).loadExpressionFunctions()}),(0,o.default)(this,"evaluate",({expression:e,variables:t})=>{const{evaluateExpression:r,getExpressionFunctions:n}=s(c,this);return r({expression:e,variables:t,functions:n()})}),i(this,c,void 0),r=this,n=e,(t=c).set(l(t,r),n)}}t.DataExpression=d;t.dataExpression=d.of({loadExpressionFunctions:a.loadExpressionFunctions,getExpressionFunctions:a.getExpressionFunctions,evaluateExpression:a.evaluateExpression})},8815:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(e){return e instanceof Date},e.prototype.convertToCustomFormat=function(e){return{$date:e.toISOString()}},e.prototype.canConvertFromCustomFormat=function(e){return this._isObjectWith$Date(e)&&"string"==typeof e.$date&&(t=e.$date,!Number.isNaN(Date.parse(t)));var t},e.prototype.convertFromCustomFormat=function(e){return new Date(e.$date)},e.prototype._isObjectWith$Date=function(e){return!!e&&"object"==typeof e&&"$date"in e},e}();t.DateConverter=r},8921:(e,t,r)=>{var n=r(998).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9199:e=>{"use strict";var t=function(){},r=function(e,r){return e.fold(r.Error||t,r.Ok||t)},n=function(e){return{map:function(e){return this},fold:function(t,r){return t(e)},chain:function(e){return this},match:function(e){return r(this,e)},value:e}},o=function e(t){return{map:function(r){return e(r(t))},fold:function(e,r){return r(t)},chain:function(e){return e(t)},match:function(e){return r(this,e)},value:t}},a={Left:n,Right:o};e.exports={Either:a,sequence:function(e){return e.reduce(function(e,t){return e.chain(function(e){return t.map(function(t){return e.concat(t)})})},o([]))},try_:function(e){try{return o(e())}catch(e){return n(e)}}}},9327:(e,t)=>{"use strict";function r(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function n(e,t){return e.get(o(e,t))}function o(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}t.__esModule=!0,t.MediaUtils=void 0;var a=new WeakMap;class i{static of(e){return new i(e)}constructor(e){var t,n,i;r(this,a,void 0),n=this,i=e,(t=a).set(o(t,n),i)}convertToUrl(e){const t=n(a,this).parseMediaItemUri(e);if(t.error)throw new Error("MediaUtils: Failed to convert wix media uri to URL",{cause:t.error});switch(t.type){case n(a,this).types.IMAGE:return n(a,this).getScaleToFillImageURL(t.mediaId,t.width,t.height,t.width,t.height,{name:t.title});case n(a,this).types.VIDEO:return`https://video.wixstatic.com/video/${t.mediaId}/file`;case n(a,this).types.AUDIO:return`https://static.wixstatic.com/mp3/${t.mediaId}`;default:throw new Error("MediaUtils: Unsupported media type")}}}t.MediaUtils=i},9587:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var n=r(8360),o=r(8815),a=r(6500),i=new n.ConvertersComposer(new o.DateConverter,new a.DefaultConverter);t.convertToCustomFormat=function(e){return i.convertToCustomFormat(e)};t.convertFromCustomFormat=function(e){return i.convertFromCustomFormat(e)}},9666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PagingMode=void 0,function(e){e.Offset="OFFSET",e.Cursor="CURSOR"}(t.PagingMode||(t.PagingMode={}))},9676:(e,t,r)=>{"use strict";t.aU=t.pY=void 0;var n=r(9587);Object.defineProperty(t,"pY",{enumerable:!0,get:function(){return n.convertToCustomFormat}}),Object.defineProperty(t,"aU",{enumerable:!0,get:function(){return n.convertFromCustomFormat}});var o=r(1298)},9929:(e,t,r)=>{var n=r(6076);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},9942:(e,t,r)=>{"use strict";var n=r(9973),o=r(798),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,d=/^[a-zA-Z]:/;function u(e){return(e||"").toString().replace(a,"")}var p=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function h(e){var t,n=("undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{}).location||{},o={},a=typeof(e=e||n);if("blob:"===e.protocol)o=new y(unescape(e.pathname),{});else if("string"===a)for(t in o=new y(e,{}),f)delete o[t];else if("object"===a){for(t in e)t in f||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=s.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function g(e,t){e=(e=u(e)).replace(i,""),t=t||{};var r,n=c.exec(e),o=n[1]?n[1].toLowerCase():"",a=!!n[2],s=!!n[3],l=0;return a?s?(r=n[2]+n[3]+n[4],l=n[2].length+n[3].length):(r=n[2]+n[4],l=n[2].length):s?(r=n[3]+n[4],l=n[3].length):r=n[4],"file:"===o?l>=2&&(r=r.slice(2)):m(o)?r=n[4]:o?a&&(r=r.slice(2)):l>=2&&m(t.protocol)&&(r=n[4]),{protocol:o,slashes:a||m(o),slashesCount:l,rest:r}}function y(e,t,r){if(e=(e=u(e)).replace(i,""),!(this instanceof y))return new y(e,t,r);var a,s,l,c,f,v,_=p.slice(),E=typeof t,I=this,T=0;for("object"!==E&&"string"!==E&&(r=t,t=null),r&&"function"!=typeof r&&(r=o.parse),a=!(s=g(e||"",t=h(t))).protocol&&!s.slashes,I.slashes=s.slashes||a&&t.slashes,I.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||d.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(I.protocol)))&&(_[3]=[/(.*)/,"pathname"]);T<_.length;T++)"function"!=typeof(c=_[T])?(l=c[0],v=c[1],l!=l?I[v]=e:"string"==typeof l?~(f="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof c[2]?(I[v]=e.slice(0,f),e=e.slice(f+c[2])):(I[v]=e.slice(f),e=e.slice(0,f))):(f=l.exec(e))&&(I[v]=f[1],e=e.slice(0,f.index)),I[v]=I[v]||a&&c[3]&&t[v]||"",c[4]&&(I[v]=I[v].toLowerCase())):e=c(e,I);r&&(I.query=r(I.query)),a&&t.slashes&&"/"!==I.pathname.charAt(0)&&(""!==I.pathname||""!==t.pathname)&&(I.pathname=function(e,t){if(""===e)return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],a=!1,i=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),i++):i&&(0===n&&(a=!0),r.splice(n,1),i--);return a&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}(I.pathname,t.pathname)),"/"!==I.pathname.charAt(0)&&m(I.protocol)&&(I.pathname="/"+I.pathname),n(I.port,I.protocol)||(I.host=I.hostname,I.port=""),I.username=I.password="",I.auth&&(~(f=I.auth.indexOf(":"))?(I.username=I.auth.slice(0,f),I.username=encodeURIComponent(decodeURIComponent(I.username)),I.password=I.auth.slice(f+1),I.password=encodeURIComponent(decodeURIComponent(I.password))):I.username=encodeURIComponent(decodeURIComponent(I.auth)),I.auth=I.password?I.username+":"+I.password:I.username),I.origin="file:"!==I.protocol&&m(I.protocol)&&I.host?I.protocol+"//"+I.host:"null",I.href=I.toString()}y.prototype={set:function(e,t,r){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||o.parse)(t)),a[e]=t;break;case"port":a[e]=t,n(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,l.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!r;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";a[e]=t.charAt(0)!==i?i+t:t}else a[e]=t;break;case"username":case"password":a[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(a.username=t.slice(0,s),a.username=encodeURIComponent(decodeURIComponent(a.username)),a.password=t.slice(s+1),a.password=encodeURIComponent(decodeURIComponent(a.password))):a.username=encodeURIComponent(decodeURIComponent(t))}for(var c=0;c<p.length;c++){var d=p[c];d[4]&&(a[d[1]]=a[d[1]].toLowerCase())}return a.auth=a.password?a.username+":"+a.password:a.username,a.origin="file:"!==a.protocol&&m(a.protocol)&&a.host?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,r=this,n=r.host,a=r.protocol;a&&":"!==a.charAt(a.length-1)&&(a+=":");var i=a+(r.protocol&&r.slashes||m(r.protocol)?"//":"");return r.username?(i+=r.username,r.password&&(i+=":"+r.password),i+="@"):r.password?(i+=":"+r.password,i+="@"):"file:"!==r.protocol&&m(r.protocol)&&!n&&"/"!==r.pathname&&(i+="@"),(":"===n[n.length-1]||l.test(r.hostname)&&!r.port)&&(n+=":"),i+=n+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(i+=r.hash),i}},y.extractProtocol=g,y.location=h,y.trimLeft=u,y.qs=o,e.exports=y},9973:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.AccessLevel=t.PermissionRole=t.CollectionOperation=t.DataOperation=void 0,function(e){e.aggregate="aggregate",e.bulkInsert="bulkInsert",e.bulkRemove="bulkRemove",e.bulkSave="bulkSave",e.bulkUpdate="bulkUpdate",e.count="count",e.distinct="distinct",e.find="find",e.get="get",e.insert="insert",e.insertReference="insertReference",e.isReferenced="isReferenced",e.queryReferenced="queryReferenced",e.remove="remove",e.removeReference="removeReference",e.replaceReferences="replaceReferences",e.save="save",e.truncate="truncate",e.update="update",e.patch="patch",e.bulkPatch="bulkPatch"}(t.DataOperation||(t.DataOperation={})),function(e){e.UPDATE="update",e.REMOVE="remove"}(t.CollectionOperation||(t.CollectionOperation={})),function(e){e.anyone="anyone",e.siteMember="siteMember",e.siteMemberAuthor="siteMemberAuthor",e.admin="admin"}(t.PermissionRole||(t.PermissionRole={})),function(e){e.ANYONE="ANYONE",e.SITE_MEMBER="SITE_MEMBER",e.SITE_MEMBER_AUTHOR="SITE_MEMBER_AUTHOR",e.CMS_EDITOR="CMS_EDITOR",e.PRIVILEGED="PRIVILEGED"}(t.AccessLevel||(t.AccessLevel={})),function(e){e.driver="driver",e.docstore="docstore",e.app="app",e.external="external",e.dynamicApplication="dynamicApplication",e.staticAppSchema="staticAppSchema"}(t.Storage||(t.Storage={}))}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e].call(r.exports,r,r.exports,a),r.exports}a.m=n,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var o=Object.create(null);a.r(o);var i={};t=t||[null,r({}),r([]),r(r)];for(var s=2&n&&e;("object"==typeof s||"function"==typeof s)&&!~t.indexOf(s);s=r(s))Object.getOwnPropertyNames(s).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,a.d(o,i),o},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,r)=>(a.f[r](e,t),t),[])),a.u=e=>"formulajs.chunk.min.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="https://static.parastorage.com/services/dbsm-viewer-app/7da06f6f1f06a81f5b20e84666d8815e5501e029ece15e84eb5467b9/webworker/",(()=>{var e={524:1};a.f.i=(t,r)=>{e[t]||importScripts(a.p+a.u(t))};var t=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app||[],r=t.push.bind(t);t.push=t=>{var[n,o,i]=t;for(var s in o)a.o(o,s)&&(a.m[s]=o[s]);for(i&&i(a);n.length;)e[n.pop()]=1;r(t)}})();var i={};return(()=>{"use strict";a.r(i),a.d(i,{createControllers:()=>oy,initAppForPage:()=>ny});var e={};a.r(e),a.d(e,{Pz:()=>ie,t8:()=>ae,Cm:()=>se});var t=a(4573);const r={"tpa/addVariantToCart":async({wixSdk:e,currentItem:r})=>{const{window:n,location:o,site:a}=e,i=await a.getPublicAPI(t.EM),s="Mobile"===n.formFactor;if(r.managedVariant)await i.cart.addProducts([{productId:r.productId,quantity:1,options:{choices:r.choices}}]),s?await i.navigate.toCart():i.cart.showMinicart();else if(s){const e=await i.product.getRelativeProductUrl({id:r.productId});o.to?.(e)}else await i.product.openQuickView(r.productId)},"tpa/addProductToCart":async({wixSdk:e,currentItem:r})=>{const{window:n,location:o,site:a}=e,i=await a.getPublicAPI(t.EM),s="Mobile"===n.formFactor;var l;(l=r).customFields&&l.customFields.length>0||Object.keys(l.productOptions||{}).length>0?s?o.to?.(r.productPageUrl):await i.product.openQuickView(r._id):(await i.cart.addProducts([{productId:r._id,quantity:1}]),s?await i.navigate.toCart():i.cart.showMinicart())},"tpa/quicklyViewProduct":async({wixSdk:e,currentItem:r})=>{const n=await e.site.getPublicAPI(t.EM);await n.product.openQuickView(r._id)},"tpa/purchasePricingPlan":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].checkout.startOnlinePurchase(t._id)},"tpa/pricingPlansNavigateToCheckout":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].customPurchaseFlow.navigateToCheckout({planId:t._id})}};a(2852),a(9942);var n=a(7877),o=a(9929),s=a.n(o),l=a(3185);function c(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function d(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var u=new WeakMap;const p=new class{constructor(){c(this,u,new Proxy({},{get(e,t){if(e[t])return e[t];throw new ReferenceError(`There is no ${t} in context. Check if the context has been already set`)}}))}set(e){Object.entries(e).forEach(e=>{let[t,r]=e;d(u,this)[t]=r})}get(){return d(u,this)}},f=p.get(),h=p.set.bind(p);class m{constructor(e){this._context=e,this._eventToListener=new _}dispatch(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this._eventToListener.has(e)?this._eventToListener.get(e).reduce((t,o)=>[...t,f.errorReporting(o,n.AppError.with({message:`${e} listener failed`,options:{extra:this._context}}))(this._context,...r)],[]):void 0}subscribe(e,t){return e.constructor===Object?Object.entries(e).reduce((e,t)=>{let[r,n]=t;return[...e,this.subscribe(r,n)]},[]):(this._eventToListener.getOrDefault(e,new E).add(t),()=>this.unsubscribe(e,t))}unsubscribe(e,t){return this._eventToListener.has(e)&&this._eventToListener.get(e).delete(t)}}class g{constructor(){var e=this;this.promise=new Promise((t,r)=>{this.resolve=function(){return t(...arguments),e.promise},this.reject=function(){return r(...arguments),e.promise}})}}const y=(e,t)=>function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];try{const r=e(...n);return(null==r?void 0:r.catch)instanceof Function?r.catch(e=>t(e,...n)):r}catch(e){return t(e,...n)}},v=e=>null!=e&&e.then?e:{then:t=>t(e)};class _ extends Map{getOrDefault(e,t){return this.has(e)?this.get(e):this.set(e,t).get(e)}find(e){const[,t]=Array.from(this).find(t=>{let[r,n]=t;return e(n,r,this)})||[];return t}}class E extends Set{reduce(e,t){return Array.from(this).reduce((t,r,n)=>e(t,r,n,this),t)}}const I="unknown",T=e=>{const t=e.split("/"),r=t[t.length-3],n=t[t.length-2];if(!(e=>/^\d+\.\d+\.\d+$/.test(e))(n))throw new Error(`Invalid version string ${n}`);return{appName:r,version:n}},S=e=>{try{const{appName:t,version:r}=T(e);return`${t}@${r}`}catch{return I}},w=()=>{const e=new Error;return e.stack?e.stack.toString():""},R=e=>{const t=w().match(new RegExp(`https?://.*?${e}.*?.js`));return t?t[0]:""},P="detailsRepeaterRole",C="detailsDatasetRole",O="filterInputRole",b="textRole",N="imageRole",D="siteButtonRole",A="checkboxRole",F="galleryRole",x="mediaGalleryRole",L="ratingsDisplayRole",U="dropdownOptionsRole",M="MobuiPickerOptionsRole",k="gridRole",B="datepickerRole",V="radioGroupRole",G="uploadButtonRole",j="repeaterRole",$="dynamicRepeaterRole",q="pageRole",W="paginationRole",z="addressInputRole",H="googleMapRole",Y="timePickerRole",J="progressBarRole",K="selectionTagsOptionsRole",Q="signatureInputRole",X="richContentRole",Z="userInputFilterDropdownRole",ee="userInputFilterCheckboxRole",te="userInputFilterRadioGroupRole",re="userInputFilterCheckboxGroupRole",ne="userInputFilterSelectionTagsRole",oe="userInputFilterRangeSliderRole",ae="READ_WRITE",ie="READ",se="WRITE";var le,ce,de,ue,pe;!function(e){e.HIDDEN="hidden",e.VISIBLE="visible"}(le||(le={})),function(e){e.URL_TOO_LONG="URL_TOO_LONG",e.PREFIX_STARTS_WITH_TEXT="PREFIX_STARTS_WITH_TEXT",e.NO_FIELD_IN_PREFIX="NO_FIELD_IN_PREFIX",e.NO_SPECIAL_CHARS="NO_SPECIAL_CHARS",e.NO_DELETED_FIELD="NO_DELETED_FIELD",e.ONLY_EXISTING_FIELDS="ONLY_EXISTING_FIELDS",e.PATTERN_ALREADY_EXISTS="PATTERN_ALREADY_EXISTS",e.SEPARATE_FIELDS="SEPARATE_FIELDS",e.UNSUPPORTED_FIELDS="UNSUPPORTED_FIELDS",e.URL_EMPTY="URL_EMPTY",e.NO_VARIABLE="NO_VARIABLE",e.EXACT_PATTERN_EXISTS="EXACT_PATTERN_EXISTS"}(ce||(ce={})),function(e){e.SAVE_FAILURE_FEEDBACK="saveFailureFeedback",e.SAVE_SUCCESS_FEEDBACK="saveSuccessFeedback"}(de||(de={})),function(e){e.EQUALS="eq",e.NOT_EQUALS="ne",e.INCLUDES_ANY="includesAny",e.EXCLUDES_ANY="excludesAny",e.INCLUDES_ALL="includesAll",e.GREATER_THAN_OR_EQUAL="ge",e.LESS_THAN_OR_EQUAL="le",e.IN_BETWEEN="inBetween",e.OUTSIDE_OF="outsideOf"}(ue||(ue={})),function(e){e.SINGLE_CHOICE="SINGLE_CHOICE",e.MULTI_CHOICE="MULTI_CHOICE",e.CHECKBOX="CHECKBOX",e.RANGE_SLIDER="RANGE_SLIDER"}(pe||(pe={}));var fe=a(2321);const he=[Z,ee,te,re,ne,oe],{EQUALS:me,NOT_EQUALS:ge,INCLUDES_ALL:ye,INCLUDES_ANY:ve,EXCLUDES_ANY:_e,GREATER_THAN_OR_EQUAL:Ee,LESS_THAN_OR_EQUAL:Ie,IN_BETWEEN:Te,OUTSIDE_OF:Se}=ue,{SINGLE_CHOICE:we,MULTI_CHOICE:Re,CHECKBOX:Pe,RANGE_SLIDER:Ce}=pe,Oe=e=>Array.isArray(e)?e:[e],be=(fe.FieldType.text,fe.FieldType.text,fe.FieldType.number,fe.FieldType.number,fe.FieldType.number,fe.FieldType.number,fe.FieldType.stringArray,fe.FieldType.stringArray,fe.FieldType.text,fe.FieldType.text,fe.FieldType.number,fe.FieldType.number,fe.FieldType.stringArray,fe.FieldType.stringArray,fe.FieldType.stringArray,fe.FieldType.boolean,fe.FieldType.boolean,fe.FieldType.number,fe.FieldType.number,"RESET_ALL"),Ne=[Z,te,re,ne],De=new Map([["new","add"]]),Ae="dbsm-viewer-app";class Fe{constructor(e){let{collectionId:r,collectionName:n,componentType:o,datasetId:a,datasetMode:i,datasetType:s,fieldType:l,filteredBy:c,id:d,numberOfResults:u,pageId:p,pageUrl:f,viewMode:h}=e;this.type=Fe.types.EVENT,this.event={pageId:p,src:79,ver:S(R(Ae)),app_name:Ae,app_id:t.Jr,evid:d,ds_id:a,ds_type:s,mode:i,collection_name:n,collection_id:r,component_type:o,filtered_by:c,field_type:l,number_of_results:u,viewmode:h,page_url:f}}}s()(Fe,"types",{EVENT:"event",ERROR:"error"});class xe extends Fe{constructor(e){let{message:t,code:r}=e;super({}),this.type=Fe.types.ERROR;const n=(e=>{if((0,l.isString)(e)){const t=e.replace(/\D/g,""),r=parseInt(t);if(Number.isNaN(r))return 1}return(0,l.isNumber)(e)?Number.isNaN(e)?1:e:1})(r);this.event={evid:10,src:79,dsc:t,errn:t,errc:n}}}class Le{constructor(e,t,r){const{type:n,fn:o}=t instanceof Function?{type:Le.types.TRACE,fn:t}:{type:t};this.name=e,this.params=r,this.run=()=>this._handlerByType[n](o),this.onStart=e=>this._start=e,this.onEnd=e=>this._end=e,this._start=()=>{},this._end=()=>{},this._handlerByType={[Le.types.TRACE]:e=>(this._start(),v(e()).then(e=>(this._end(),e))),[Le.types.START]:()=>this._start(),[Le.types.END]:()=>this._end()}}}s()(Le,"types",{START:"START",END:"END",TRACE:"TRACE"});class Ue{static with(e){let{category:t,message:r,level:n,data:o}=e;return class extends(this){constructor(e){let{category:a=t,message:i=r,level:s=n,data:l}=e;super({category:a,message:i,level:s,data:l||o?{...l,...o}:void 0})}}}constructor(e){let{category:t,message:r,level:n="info",data:o}=e;this.event={category:t,message:r,level:n,data:o}}}class Me{static with(e){return class extends(this){constructor(t,r){void 0===r&&(r={}),super(t,{...e,...r})}}}constructor(e,t){this._builderByType={[Me.types.DS_API.CALLED]:e=>{let{methodName:t,args:r}=e;return 0===r.length?[`[wix-dataset.${t}] called`]:[`[wix-dataset.${t}] called with (`,JSON.stringify(r),")"]},[Me.types.DS_API.SUCCED]:e=>{let{methodName:t,result:r}=e;return void 0===r?[`[wix-dataset.${t}] returned`]:[`[wix-dataset.${t}] returned with (`,JSON.stringify(r),")"]},[Me.types.DS_API.DEPRECATED]:e=>{let{methodName:t,replacementMethodName:r}=e;return[`[wix-dataset.${t}] is deprecated${r?`; use [wix-dataset.${r}] instead`:""}`]},[Me.types.DS_API.REGISTERED]:e=>{let{methodName:t}=e;return[`[${t} callback registered] on wix-dataset`]},[Me.types.DS_API.TRIGGERED]:e=>{let{eventName:t,eventArgs:r=[]}=e;if(r.length){const e=r.map(e=>e instanceof Error?e.toString():e);return[`[${t} event] triggered on wix-dataset with (`,JSON.stringify(e),")"]}return[`[${t} event] triggered on wix-dataset`]}},this._context=t,this.messages=this._builderByType[e](t)}_getComponentPresentation(){const{component:{nickname:e,parentRepeater:t}}=this._context;return t?`#${t.nickname}.#${e}`:`#${e}`}}s()(Me,"types",{DS_API:{CALLED:"DS_API_CALLED",SUCCED:"DS_API_SUCCED",DEPRECATED:"DS_API_DEPRECATED",REGISTERED:"DS_API_REGISTERED",TRIGGERED:"DS_API_TRIGGERED"}});class ke{constructor(e,t){void 0===t&&(t="log"),this.message=e,this.level=t}}const Be=(e,t)=>[k,W].includes(e)||t&&t.properties&&Object.keys(t.properties).length>0;var Ve=a(7301);const Ge=Object.keys,je=(Object.values,Object.entries),$e=e=>null!=e,qe={AddressInput:{viewerType:["wixui.AddressInput"],sdkType:"$w.AddressInput"},Text:{viewerType:["wysiwyg.viewer.components.WRichText"],sdkType:"$w.Text"},Image:{viewerType:["wysiwyg.viewer.components.WPhoto","wixui.ImageX"],sdkType:"$w.Image"},TextInput:{viewerType:["wysiwyg.viewer.components.inputs.TextInput"],sdkType:"$w.TextInput"},TimePicker:{viewerType:["wixui.TimePicker"],sdkType:"$w.TimePicker"},Button:{viewerType:["wysiwyg.viewer.components.SiteButton"],sdkType:"$w.Button"},IconButton:{viewerType:["wysiwyg.common.components.imagebutton.viewer.ImageButton"],sdkType:"$w.IconButton"},RatingsDisplay:{viewerType:["wixui.RatingsDisplay"],sdkType:"$w.RatingsDisplay"},RatingsInput:{viewerType:["wixui.RatingsInput"],sdkType:"$w.RatingsInput"},VerticalMenu:{viewerType:["wysiwyg.common.components.verticalmenu.viewer.VerticalMenu"],sdkType:"$w.VerticalMenu"},Checkbox:{viewerType:["wysiwyg.viewer.components.inputs.Checkbox"],sdkType:"$w.Checkbox"},Gallery:{viewerType:["wysiwyg.viewer.components.MatrixGallery","wysiwyg.viewer.components.SliderGallery","wysiwyg.viewer.components.SlideShowGallery","wysiwyg.viewer.components.PaginatedGridGallery","wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.Gallery"},Dropdown:{viewerType:["wysiwyg.viewer.components.inputs.ComboBoxInput","wixui.Dropdown"],sdkType:"$w.Dropdown"},TextBox:{viewerType:["wysiwyg.viewer.components.inputs.TextAreaInput"],sdkType:"$w.TextBox"},RichTextBox:{viewerType:["wixui.RichTextBox"],sdkType:"$w.RichTextBox"},Table:{viewerType:["wysiwyg.viewer.components.Grid"],sdkType:"$w.Table"},DatePicker:{viewerType:["wysiwyg.viewer.components.inputs.DatePicker"],sdkType:"$w.DatePicker"},RadioButtonGroup:{viewerType:["wysiwyg.viewer.components.inputs.RadioGroup"],sdkType:"$w.RadioButtonGroup"},UploadButton:{viewerType:["wysiwyg.viewer.components.inputs.UploadButton","wixui.FileUploaderNew","wysiwyg.viewer.components.inputs.FileUploader"],sdkType:"$w.UploadButton"},ClassicSection:{viewerType:["wysiwyg.viewer.components.ClassicSection"],sdkType:"$w.Section"},Column:{viewerType:["wysiwyg.viewer.components.Column"],sdkType:"$w.Column"},Video:{viewerType:["wysiwyg.viewer.components.Video"],sdkType:"$w.Video"},VideoPlayer:{viewerType:["wixui.VideoPlayer"],sdkType:"$w.VideoPlayer"},VideoBox:{viewerType:["wysiwyg.viewer.components.MediaPlayer"],sdkType:"$w.VideoBox"},MusicPlayer:{viewerType:["wixui.MusicPlayer"],sdkType:"$w.AudioPlayer"},Repeater:{viewerType:["wysiwyg.viewer.components.Repeater"],sdkType:"$w.Repeater"},DynamicRepeater:{viewerType:["wixSystemElements.DynamicRepeater"],sdkType:"$w.Repeater"},Pagination:{viewerType:["wixui.Pagination"],sdkType:"$w.Pagination"},Page:{viewerType:["mobile.core.components.Page"],sdkType:"$w.Page"},Document:{viewerType:["fake-document-type"],sdkType:"$w.Document"},MediaContainer:{viewerType:["wysiwyg.viewer.components.MediaContainer"],sdkType:"$w.Container"},StripColumnsContainer:{viewerType:["wysiwyg.viewer.components.StripColumnsContainer"],sdkType:"$w.ColumnStrip"},ToggleSwitch:{viewerType:["wixui.ToggleSwitch"],sdkType:"$w.Switch"},Slider:{viewerType:["wixui.Slider"],sdkType:"$w.Slider"},RangeSlider:{viewerType:["wixui.RangeSlider"],sdkType:"$w.RangeSlider"},StylableButton:{viewerType:["wixui.StylableButton"],sdkType:"$w.StylableButton"},GoogleMap:{viewerType:["wysiwyg.viewer.components.GoogleMap"],sdkType:"$w.GoogleMap"},CheckboxGroup:{viewerType:["wysiwyg.viewer.components.inputs.CheckboxGroup"],sdkType:"$w.CheckboxGroup"},ProgressBar:{viewerType:["wixui.ProgressBar"],sdkType:"$w.ProgressBar"},VectorImage:{viewerType:["wysiwyg.viewer.components.VectorImage","wysiwyg.viewer.components.svgshape.SvgShape"],sdkType:"$w.VectorImage"},SelectionTags:{viewerType:["wixui.SelectionTagsList"],sdkType:"$w.SelectionTags"},Section:{viewerType:["responsive.components.Section"],sdkType:"$w.Section"},SignatureInput:{viewerType:["wixui.SignatureInput"],sdkType:"$w.SignatureInput"},RefComponent:{viewerType:["wysiwyg.viewer.components.RefComponent"],sdkType:"$w.RefComponent"},RichContent:{viewerType:["wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.RichContent"},AppController:{viewerType:["platform.components.AppController"],sdkType:"$w.AppController"},SlideshowRepeater:{viewerType:["wixui.Slideshow"],sdkType:"$w.Slideshow"}},We=(0,l.mapValues)(qe,({sdkType:e})=>e),{AddressInput:ze,RatingsInput:He,TextInput:Ye,TextBox:Je,RichTextBox:Ke,Checkbox:Qe,DatePicker:Xe,RadioButtonGroup:Ze,Dropdown:et,UploadButton:tt,ToggleSwitch:rt,Slider:nt,TimePicker:ot,CheckboxGroup:at,SelectionTags:it,SignatureInput:st}=(Ge(qe).reduce((e,t)=>(e.concat(qe[t].viewerType),e),[]),Ge(qe).map(e=>qe[e].viewerType).reduce((e,t)=>e.concat(t),[]).reduce((e,t)=>(e[t.split(".").reverse()[0]]=t,e),{}),Ge(qe).map(e=>qe[e].sdkType),We),lt=[{type:ze,role:z},{type:He,role:"ratingsInputRole"},{type:Ye,role:"textInputRole"},{type:Je,role:"textAreaRole"},{type:Ke,role:"richTextBoxRole"},{type:Qe,role:A},{type:Xe,role:B},{type:Ze,role:V},{type:et,role:"dropdownRole"},{type:tt,role:G},{type:rt,role:"toggleSwitchRole"},{type:nt,role:"sliderRole"},{type:ot,role:Y},{type:at,role:"checkboxGroupRole"},{type:it,role:"selectionTagsRole"},{type:st,role:Q}],ct=(lt.map(e=>e.type),lt.map(e=>e.role)),dt=e=>e.some(e=>{return t=(0,l.get)(e,"role"),ct.includes(t);var t}),ut=(e,t)=>(e=>[se,ae].includes(e))(e)&&(e=>e.some(e=>"save"===(0,l.get)(e,"config.events.onClick.action")))(t)&&dt(t);function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ft(e){var t=function(e,t){if("object"!=pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pt(t)?t:t+""}function ht(e,t,r){return(t=ft(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach(function(t){ht(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function yt(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var vt="function"==typeof Symbol&&Symbol.observable||"@@observable",_t=function(){return Math.random().toString(36).substring(7).split("").join(".")},Et={INIT:"@@redux/INIT"+_t(),REPLACE:"@@redux/REPLACE"+_t(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+_t()}};function It(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Tt(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(yt(0));if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error(yt(1));return r(Tt)(e,t)}if("function"!=typeof e)throw new Error(yt(2));var o=e,a=t,i=[],s=i,l=!1;function c(){s===i&&(s=i.slice())}function d(){if(l)throw new Error(yt(3));return a}function u(e){if("function"!=typeof e)throw new Error(yt(4));if(l)throw new Error(yt(5));var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error(yt(6));t=!1,c();var r=s.indexOf(e);s.splice(r,1),i=null}}}function p(e){if(!It(e))throw new Error(yt(7));if(void 0===e.type)throw new Error(yt(8));if(l)throw new Error(yt(9));try{l=!0,a=o(a,e)}finally{l=!1}for(var t=i=s,r=0;r<t.length;r++){(0,t[r])()}return e}return p({type:Et.INIT}),(n={dispatch:p,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(yt(10));o=e,p({type:Et.REPLACE})}})[vt]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(yt(11));function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[vt]=function(){return this},e},n}function St(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function wt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error(yt(15))},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=t.map(function(e){return e(o)});return n=St.apply(void 0,a)(r.dispatch),gt(gt({},r),{},{dispatch:n})}}}const Rt={collectionName:null,readWriteType:ie,filter:null,sort:null,includes:null,nested:[],pageSize:100,deferred:!1,onlyUsedFields:!1},Pt="SET_CURRENT_RECORD",Ct="UPDATE_FIELDS",Ot="REFRESH_CURRENT_RECORD",bt="REFRESH_CURRENT_VIEW",Nt="INCREMENT_NUM_PAGES_TO_SHOW",Dt="SET_DEFAULT_RECORD",At="GO_TO_INDEX",Ft="GO_TO_NEXT_PAGE",xt="GO_TO_PREVIOUS_PAGE",Lt="LOAD_PAGE",Ut="GET_RECORD_BY_INDEX_RESULT",Mt="CURRENT_VIEW_UPDATED",kt="REVERT_CHANGES",Bt="RECORD_REVERTED",Vt="SAVE_RECORD",Gt="SAVE_RECORD_RESULT",jt="REMOVE_CURRENT_RECORD",$t="REMOVE_CURRENT_RECORD_RESULT",qt="NEW_RECORD",Wt="NEW_RECORD_RESULT",zt="REFRESH",Ht="SET_USER_INPUT_OPTION_VALUES",Yt={INIT:"INIT",SET_PAGINATION_DATA:"SET_PAGINATION_DATA"},Jt=Yt,Kt=e=>{let{controllerConfig:t={},connections:r=[],isScoped:n=!1,datasetType:o,pageOffset:a}=e;return{type:Yt.INIT,datasetConfig:t.dataset||{},connections:r,isScoped:n,datasetType:o,pageOffset:a}},Qt=e=>({type:Yt.SET_PAGINATION_DATA,paginationData:e}),Xt="SET_FILTER",Zt="SET_SORT",er="SET_IS_DATASET_READY",tr="SET_FIXED_FILTER_ITEM",rr=e=>null==e?void 0:e.readWriteType,nr=e=>null==e?void 0:e.pageSize,or=rr,ar=e=>{let{error:t,payload:r}=e;return t?Ve.Result.Error(r):Ve.Result.Ok(r)},ir={currentRecord:{index:void 0,data:void 0,fieldsToUpdate:void 0,updateSource:void 0},lastSavedRecord:{index:void 0,data:void 0},desiredIndex:void 0,refreshCurrentRecord:!1,removeCurrentRecord:!1,newRecordIndex:null,refreshCurrentView:!1,refreshController:!1,setFilterCalled:!1,revertChanges:!1,saveRecord:!1,defaultRecord:void 0,isForm:void 0,page:{numPagesToShow:1,offset:0,size:Rt.pageSize},schema:void 0,userFilterInitialData:null,isApplyUserInputFiltersActionBindingPresent:!1},sr=e=>((e,t)=>(0,l.inRange)(e,pr(t).offset,pr(t).offset+pr(t).size))(fr(e),e),lr=e=>e.some(e=>"applyUserInputFilters"===(0,l.get)(e,"config.events.onClick.action")),cr=(e,t,r,n)=>{const o={...e,currentRecord:{index:t,data:r,updateSource:n},desiredIndex:t,refreshCurrentRecord:!1,refreshController:!1};return sr(o)?o:{...o,page:{...o.page,offset:Math.floor(o.currentRecord.index/o.page.size)*o.page.size,numPagesToShow:1}}},dr=e=>e.page.size,ur=e=>e.currentRecord.data,pr=e=>e.page,fr=e=>e.currentRecord.index,hr={reducer:function(e,t){switch(void 0===e&&(e=ir),t.type){case Pt:{const{recordIndex:r,record:n,updateSource:o}=t;return cr(e,r,n,o)}case qt:return{...e,newRecordIndex:t.atIndex};case Wt:return ar(t).fold(()=>({...e,newRecordIndex:null}),t=>({...cr(e,e.newRecordIndex,t),newRecordIndex:null}));case Ct:{const{fieldsToUpdate:r,updateSource:n}=t;return{...e,currentRecord:{...e.currentRecord,fieldsToUpdate:r,updateSource:n}}}case At:return{...e,desiredIndex:t.index};case Ut:return ar(t).fold(()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1,refreshController:!1}),t=>t.matchWith({Record:t=>{let{index:r,record:n}=t;return cr(e,r,n)},InvalidIndex:()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1}),NoRecord:()=>cr(e,null,null)}));case Ot:return{...e,refreshCurrentRecord:!0};case jt:return{...e,removeCurrentRecord:!0};case $t:return ar(t).fold(()=>({...e,removeCurrentRecord:!1}),()=>({...e,removeCurrentRecord:!1,refreshCurrentRecord:!0}));case bt:return{...e,refreshCurrentView:!0};case Mt:return{...e,refreshCurrentView:!1};case kt:return{...e,revertChanges:!0};case Bt:return{...e,revertChanges:!1};case Dt:{const{record:r}=t;return{...e,defaultRecord:r}}case Jt.INIT:{const{datasetConfig:r,connections:n,pageOffset:o}=t,a=nr(r),i=or(r);return{...e,isForm:ut(i,n),page:{...e.page,size:a||e.page.size,offset:o||e.page.offset},isApplyUserInputFiltersActionBindingPresent:lr(n)}}case Jt.SET_PAGINATION_DATA:{const r={...e,page:{...e.page,...t.paginationData}};return sr(r)?r:{...r,desiredIndex:r.page.offset}}case Ft:{const t=pr(e),r=dr(e),n=t.offset+r,o={...e,page:{...e.page,numPagesToShow:1,offset:n}};return sr(o)?o:{...o,desiredIndex:o.page.offset}}case xt:{const t=pr(e),r=Math.max(0,t.offset-t.size),n={...e,page:{...e.page,numPagesToShow:1,offset:r}};return sr(n)?n:{...n,desiredIndex:n.page.offset}}case Lt:{const{size:r}=pr(e),n={...e,page:{...e.page,numPagesToShow:1,offset:r*(t.pageNumber-1)}};return sr(n)?n:{...n,desiredIndex:n.page.offset}}case Nt:return{...e,page:{...e.page,numPagesToShow:e.page.numPagesToShow+1}};case Vt:return{...e,saveRecord:!0,lastSavedRecord:{index:void 0,data:void 0}};case Gt:return ar(t).fold(()=>({...e,saveRecord:!1}),t=>({...e,saveRecord:!1,lastSavedRecord:{index:e.currentRecord.index,data:t}}));case Xt:return{...e,setFilterCalled:!0,refreshController:!0};case Zt:case zt:return{...e,refreshController:!0};case Ht:return{...e,userFilterInitialData:t.userFilterInitialData};default:return e}},getPaginationData:pr,hasCurrentRecord:e=>!!ur(e),selectDefaultDraft:e=>({...e.defaultRecord}),selectCurrentRecord:ur,selectCurrentRecordIndex:fr,selectDesiredRecordIndex:e=>e.desiredIndex,selectFieldsToUpdate:e=>e.currentRecord.fieldsToUpdate,selectLastSavedRecord:e=>e.lastSavedRecord.data,selectLastSavedRecordIndex:e=>e.lastSavedRecord.index,selectRefreshCurrentRecord:e=>e.refreshCurrentRecord,selectRemoveCurrentRecord:e=>e.removeCurrentRecord,selectRefreshController:e=>e.refreshController,selectSetFilterCalled:e=>e.setFilterCalled,selectRefreshCurrentView:e=>e.refreshCurrentView,selectRevertChanges:e=>e.revertChanges,selectSaveRecord:e=>e.saveRecord,selectUpdateSource:e=>e.currentRecord.updateSource,selectNewRecordIndex:e=>e.newRecordIndex,isDuringSave:e=>e.saveRecord,isForm:e=>e.isForm,getUserFilterInitialData:e=>e.userFilterInitialData,selectIsApplyUserInputFiltersActionBindingPresent:e=>e.isApplyUserInputFiltersActionBindingPresent},mr="dataset",gr="router_dataset",yr="widget",vr=e=>{const{prop:t,fieldName:r}=(null==e?void 0:e.userInputFilter)??{};return!(!t||!r)},{Cm:_r}=e,Er=["collectionName","readWriteType","includes","cursor"],Ir=["filter","sort"],Tr=e=>(0,l.pick)(e,Er),Sr=e=>(0,l.pick)(e,Ir),wr=e=>{let{datasetConfig:t,connections:r,isScoped:n,datasetType:o}=e;const a=o===gr,i=r.some(e=>{let{role:t}=e;return t===C}),s=n,l=!n,c=t.readWriteType===_r;return{datasetIsRouter:a,datasetIsMaster:i,datasetIsVirtual:s,datasetIsReal:l,datasetIsDeferred:Boolean(t.deferred)&&!(s||i||a||c),dynamicPageNavComponentsShouldBeLinked:a&&l,userFilterConnectionProps:r.filter(e=>{let{role:t,config:r}=e;return he.includes(t)&&vr(r)}).map(e=>{let{config:{userInputFilter:t},role:r}=e;return{...t,role:r}})}},Rr=(e,t)=>({...e,transientData:{...e.transientData,...t}}),Pr={canonicalData:Tr(Rt),canonicalCalculatedData:{},transientData:{isDatasetReady:!1,...Sr(Rt)}},Cr={reducer:function(e,t){switch(void 0===e&&(e=Pr),t.type){case Jt.INIT:{const{datasetConfig:r,connections:n,isScoped:o,datasetType:a}=t;return{...e,canonicalData:{...e.canonicalData,...Tr(t.datasetConfig)},canonicalCalculatedData:wr({datasetConfig:r,connections:n,isScoped:o,datasetType:a}),transientData:{...e.transientData,...Sr(t.datasetConfig)}}}case Xt:{const{filter:r}=t;return Rr(e,{filter:r})}case Zt:{const{sort:r}=t;return Rr(e,{sort:r})}case er:{const{isDatasetReady:r}=t;return Rr(e,{isDatasetReady:r})}case tr:{const{fixedFilterItem:r}=t;return Rr(e,{fixedFilterItem:r})}default:return e}},isWriteOnly:e=>(0,l.get)(e,["canonicalData","readWriteType"])===se,isReadOnly:e=>(0,l.get)(e,["canonicalData","readWriteType"])===ie,getReadWriteMode:e=>(0,l.get)(e,["canonicalData","readWriteType"]),isDatasetReady:e=>(0,l.get)(e,["transientData","isDatasetReady"]),isDatasetConfigured:e=>!!(0,l.get)(e,["canonicalData","collectionName"]),isCursorPagingRequired:e=>!!(0,l.get)(e,["canonicalData","cursor"]),isDatasetRouter:e=>{let{canonicalCalculatedData:{datasetIsRouter:t}}=e;return t},isDatasetMaster:e=>{let{canonicalCalculatedData:{datasetIsMaster:t}}=e;return t},isDatasetVirtual:e=>{let{canonicalCalculatedData:{datasetIsVirtual:t}}=e;return t},isDatasetReal:e=>{let{canonicalCalculatedData:{datasetIsReal:t}}=e;return t},isDatasetDeferred:e=>{let{canonicalCalculatedData:{datasetIsDeferred:t}}=e;return t},shouldLinkDynamicPageNavComponents:e=>{let{canonicalCalculatedData:{dynamicPageNavComponentsShouldBeLinked:t}}=e;return t},getUserFilterConnectionProps:e=>{let{canonicalCalculatedData:{userFilterConnectionProps:t}}=e;return t},getFixedFilterItem:e=>(0,l.get)(e,["transientData","fixedFilterItem"]),getFilter:e=>(0,l.get)(e,["transientData","filter"]),getSort:e=>(0,l.get)(e,["transientData","sort"]),getIncludes:e=>(0,l.get)(e,["canonicalData","includes"])||[],getCollectionName:e=>(0,l.get)(e,["canonicalData","collectionName"])},Or="NEXT_DYNAMIC_PAGE_URL_RESULT",br="PREVIOUS_DYNAMIC_PAGE_URL_RESULT",Nr="INITIALIZE",Dr=(0,Ve.union)("DynamicPageUrlLoadState",{Empty(){},Loading(){},Loaded:e=>{if(!e)throw new Error("url must exist");return{url:e}}},{hasUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!1,Loaded:()=>!0}),shouldLoadUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!0,Loaded:()=>!1})});Dr.fromUrl=e=>e?Dr.Loaded(e):Dr.Empty();const Ar=Dr,{fromUrl:Fr}=Dr,xr={nextDynamicPageUrl:Ar.Empty(),previousDynamicPageUrl:Ar.Empty()},Lr=e=>{const t=(e=>{const t=e.filter(e=>!!(0,l.get)(e,"config.events.onClick.action"));return new Set(t.map(e=>(0,l.get)(e,"config.events.onClick.action")))})(e),r=e=>e?Ar.Loading():Ar.Empty();return{nextDynamicPageUrl:r(t.has("nextDynamicPage")),previousDynamicPageUrl:r(t.has("previousDynamicPage"))}},Ur={reducer:function(e,t){switch(void 0===e&&(e=xr),t.type){case Nr:return{...e,...Lr(t.connections)};case Or:return{...e,nextDynamicPageUrl:Ar.fromUrl(t.payload)};case br:return{...e,previousDynamicPageUrl:Ar.fromUrl(t.payload)};default:return e}},selectNextDynamicPageUrl:e=>e.nextDynamicPageUrl,selectPreviousDynamicPageUrl:e=>e.previousDynamicPageUrl},Mr=function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var a,i=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:Et.INIT}))throw new Error(yt(12));if(void 0===r(void 0,{type:Et.PROBE_UNKNOWN_ACTION()}))throw new Error(yt(13))})}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,o={},s=0;s<i.length;s++){var l=i[s],c=r[l],d=e[l],u=c(d,t);if(void 0===u){t&&t.type;throw new Error(yt(14))}o[l]=u,n=n||u!==d}return(n=n||i.length!==Object.keys(e).length)?o:e}}({records:hr.reducer,config:Cr.reducer,dynamicPages:Ur.reducer}),kr=e=>Cr.getCollectionName(e.config),Br=e=>Cr.getFilter(e.config),Vr=e=>Cr.getSort(e.config),Gr=e=>hr.getPaginationData(e.records),jr=e=>Cr.getReadWriteMode(e.config),$r=e=>Cr.isDatasetConfigured(e.config),qr=e=>Cr.isDatasetReady(e.config),Wr=e=>Cr.isReadOnly(e.config),zr=e=>Cr.isWriteOnly(e.config),Hr=e=>(e=>hr.hasCurrentRecord(e.records))(e)&&!Wr(e),Yr=e=>Cr.isDatasetRouter(e.config),Jr=e=>Cr.isDatasetMaster(e.config),Kr=e=>Cr.isDatasetVirtual(e.config),Qr=e=>Cr.isDatasetReal(e.config),Xr=e=>Cr.isDatasetDeferred(e.config),Zr=e=>Cr.shouldLinkDynamicPageNavComponents(e.config),en=e=>hr.selectCurrentRecord(e.records),tn=e=>hr.selectCurrentRecordIndex(e.records),rn=e=>hr.selectDefaultDraft(e.records),nn=e=>hr.selectDesiredRecordIndex(e.records),on=e=>hr.selectFieldsToUpdate(e.records),an=e=>hr.selectUpdateSource(e.records),sn=e=>hr.selectNewRecordIndex(e.records),ln=e=>Ur.selectNextDynamicPageUrl(e.dynamicPages),cn=e=>Ur.selectPreviousDynamicPageUrl(e.dynamicPages),dn=e=>hr.selectRefreshController(e.records),un=e=>hr.selectSetFilterCalled(e.records),pn=e=>hr.selectRefreshCurrentRecord(e.records),fn=e=>hr.selectRefreshCurrentView(e.records),hn=e=>hr.selectRemoveCurrentRecord(e.records),mn=e=>hr.selectRevertChanges(e.records),gn=e=>hr.selectSaveRecord(e.records),yn=e=>hr.getUserFilterInitialData(e.records),{t8:vn,Pz:_n}=e;class En{constructor(e,t){this._logger=e,this._listenToUnhandledErrors(t),this._predicateByEventType=new _([[Fe,e=>{let{mode:t,env:r}=e;return t.csr&&!r.dev}],[Me,e=>{let{mode:t,env:r}=e;return t.verbose&&r.preview}]])}log(e){if(this._shouldLogErrorBi(e)&&this._logger.log(e,new xe(e.cause||e)),this._shouldLog(e))return this._logger.log(e)}logError(e,t,r){this.log(e instanceof n.DataBindingError?e:new n.AppError(t,{cause:e,...r}))}_shouldLog(e){const t=this._predicateByEventType.find((t,r)=>e instanceof r)||(()=>!0);return t(f.platform.settings)}_shouldLogErrorBi(e){return e instanceof n.DataBindingError&&!(e instanceof n.UserError)&&this._predicateByEventType.get(Fe)(f.platform.settings)}_listenToUnhandledErrors(e){e.addEventListener("unhandledrejection",e=>{e.reason instanceof n.DataBindingError&&(e.preventDefault(),this._logger.log(new n.UnhandledPromiseRejection({cause:e.reason})))})}}const In=e=>(t,r)=>y(t,t=>e.log(new r({cause:t}))),Tn=e=>(t,r)=>y(function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];const i=t(...o);return e.log(new r({data:{args:o,result:i}})),i},t=>{throw e.log(new r({data:{exception:t},level:"error"})),t}),Sn=e=>(t,r)=>function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];if(r.startsWith("on"))return e.log(new Me(Me.types.DS_API.REGISTERED,{methodName:r})),t(...o);if(e.log(new Me(Me.types.DS_API.CALLED,{methodName:r,args:o})),De.has(r)){const t=De.get(r);e.log(new Me(Me.types.DS_API.DEPRECATED,{methodName:r,replacementMethodName:t}))}return v(t(...o)).then(t=>(e.log(new Me(Me.types.DS_API.SUCCED,{methodName:r,result:t})),t))};class wn extends Fe{constructor(e){let{id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,numberOfResults:s,filteredBy:l,componentType:c,fieldType:d}=e;const{platform:{location:{pageId:u,pageUrl:p},settings:{env:h}}}=f;super({id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,viewMode:h.name,pageId:u,pageUrl:p,numberOfResults:s,filteredBy:l,componentType:c,fieldType:d})}}var Rn=a(9676);const Pn=e=>{let{message:t,code:r}=e;const n=new Error(t);return n.code=r,n};class Cn{constructor(e){let{getRequestParams:t,httpClient:r}=e;this.getRequestParams=t,this.httpClient=r}async _makeRequestTo(e,t){const{instance:r,gridAppId:n}=this.getRequestParams();return(await this.httpClient.post(`/_serverless/data-binding-server/${e}`,t,{params:{gridAppId:n},headers:{Authorization:r,"Content-Type":"application/json"}})).data}async fetchBulkData(e){const{recordsByCollectionId:t,recordsInfoByDataset:r}=await this._makeRequestTo("fetch-initial-data",e);return{recordsInfoByDataset:r.reduce((e,t)=>{let{itemIds:r=[],totalCount:n=0,error:o}=t;return[...e,{itemIds:r,totalCount:n,error:o?Pn(o):void 0}]},[]),recordsByCollectionId:Object.entries(t).reduce((e,t)=>{let[r,n]=t;return{...e,[r]:Object.entries(n).reduce((e,t)=>{let[r,n]=t;return{...e,[r]:(0,Rn.aU)(n)}},{})}},{})}}async fetchData(e){const{items:t,...r}=await this._makeRequestTo("fetch-data",e);return{...r,items:t.map(e=>(0,Rn.aU)(e))}}async remove(e){return this._makeRequestTo("remove",e)}async save(e){const{item:t}=await this._makeRequestTo("save",e);return(0,Rn.aU)(t)}}const On=".",bn=e=>(0,l.head)(e.split(On)),Nn=e=>e.split(On),Dn=e=>(0,l.isPlainObject)(e)&&(0,l.has)(e,"_id"),An=(e,t)=>e!==t&&Dn(e)&&!Dn(t)?e:t,Fn=function(e,t){void 0===t&&(t={});for(const r of e){const e=t[r._id];t[r._id]=(0,l.mergeWith)(e,r,An)}return t},xn=(e,t)=>{const r=t.flatMap(e=>["fields",e]).concat("type");return(0,l.get)(e,r)},Ln=(e,t)=>r=>{const n=Nn(r);if(((e,t)=>t.length>=2&&xn(e,[t[0]])===fe.FieldType.reference)(e,n)){const[r,...o]=n,a=e&&e.fields[r]?e.fields[r].referencedCollection:null,i=t&&a?t[a]:null;return xn(i,o)}return xn(e,n)},Un=(e,t)=>null!=t&&null!=t.fields[e]?t.fields[e].referencedCollection:null,Mn=e=>null!=e?e.displayField:null,kn=e=>null!=e?e.maxPageSize:void 0,Bn=e=>(0,l.includes)(e,On),Vn=e=>{let{schema:t,defaultToDbDriverLimit:r}=e;const n=r?100:1e3;return kn(t)??n},Gn=(e,t)=>async r=>{const{baseQuery:n,fieldName:o,schema:a}=r,i=((e,t,r)=>{const n=e.fields[t]?.queryOperators;return!n||n.includes(r)})(a,o,fe.AllowedFilterOperator.ne);if(i)return t({...r,baseQuery:n.ne(o,e)});const s=await t(r);return(0,l.filter)(s,t=>((e=>(0,l.isObject)(e))(t)?t[o]:t)!==e)},jn=e=>Gn("",e),$n=e=>Gn(void 0,e),qn=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=Vn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).find(),i=a.flatMap(e=>e[n]);return(0,l.uniq)(i)},Wn=async e=>{let{baseQuery:t,fieldName:r,schema:n}=e;const o=Vn({schema:n,defaultToDbDriverLimit:!1}),{items:a}=await t.limit(o).distinct(r,null);return a},zn=e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o,filterModel:a}=e;const i=(e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o}=e;const a=bn(o);if(a){var i,s;const e=(null==(i=r.fields[a])?void 0:i.sortable)??!0,o=r.defaultSort?[{[r.defaultSort.fieldName]:r.defaultSort.direction}]:null,l=(null==n?void 0:n.length)>0,c=!((null==n?void 0:n.find(e=>e[a]))||(null==r||null==(s=r.defaultSort)?void 0:s.fieldName)===a)&&e,d=t.sort().ascending(a).getSortModel();if(l)return c?[...n,...d]:n;if(o)return c?[...o,...d]:o;if(e)return d}return null})({wixData:t,schema:r,sortModel:n,fieldName:o});return t.query(r.id).setFilterModel(a).setSortModel(i)},Hn=async e=>{let{baseQuery:t,schema:r,references:n}=e;const o=Vn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.hasSome("_id",n).limit(o).find();return a},Yn=async e=>{let{baseQuery:t,schema:r,wixData:n,customSortExists:o,referencingFieldName:a,referencedFieldName:i,referencedSchema:s}=e;const l=Vn({schema:r,defaultToDbDriverLimit:!1}),{items:c}=await t.limit(l).distinct(a,null),d=jn($n(Hn)),u=await d({baseQuery:n.query(s.id),schema:s,fieldName:i,references:c});return o?c.flatMap(e=>u.filter(t=>t._id===e)):u},Jn=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=Vn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).include(n).find();return a},Kn=async e=>{let{baseQuery:t,schema:r,referencingFieldName:n,referencedFieldName:o}=e;const a=$n(Jn),i=await a({baseQuery:t,schema:r,fieldName:n});return(0,l.uniqBy)(i.map(e=>e[n]).filter(e=>!["",void 0].includes(e[o])),"_id")},Qn=async e=>{var t,r;let{schema:n,schemas:o,wixData:a,fieldName:i,role:s,sortModel:c,filterModel:d}=e;const u=zn({wixData:a,schema:n,fieldName:i,sortModel:c,filterModel:d}),[p,f]=Nn(i),h=null==(t=n.fields[p])?void 0:t.referencedCollection;if(!h)return null;const m=o[h];if(!m)return null;const g=(null==c?void 0:c.length)>0,y=(null==(r=n.allowedOperations)?void 0:r.includes(fe.DataOperation.distinct))?Yn:Kn,v=await y({baseQuery:u,schema:n,schemas:o,wixData:a,fieldName:i,customSortExists:g,referencingFieldName:p,referencedFieldName:f,referencedSchema:m}),_=(e=>{let{referencedItems:t,referencedSchema:r,referencedFieldName:n,customSortExists:o}=e;const a=(0,l.uniq)(t.flatMap(e=>e[n])),i=r.fields[n].type;return o?a:i===fe.FieldType.number?a.sort((e,t)=>e-t):a.sort()})({referencedItems:v,referencedSchema:m,referencedFieldName:f,customSortExists:g}),E=(e=>{let{referencedItems:t,referencedFieldName:r,options:n}=e;return Object.fromEntries(n.map(e=>[e,t.filter(t=>(0,l.isArray)(t[r])?t[r].includes(e):t[r]===e).map(e=>e._id)]))})({referencedItems:v,options:_,referencedFieldName:f});return{fieldName:i,role:s,options:_,referencedItemIdsByOption:E}},Xn=async e=>{var t;let{schema:r,wixData:n,fieldName:o,role:a,filterModel:i}=e;const s={wixData:n,schema:r,filterModel:i,fieldName:o,role:a};return(null==(t=r.allowedOperations)?void 0:t.includes(fe.DataOperation.aggregate))?(async e=>{let{wixData:t,schema:r,filterModel:n,fieldName:o,role:a}=e;const i=t.filter().setFilterModel(n),{items:s}=await t.aggregate(r.id).filter(i).max(o,"max").min(o,"min").run(),{min:l,max:c}=s[0]??{};return{fieldName:o,role:a,min:l,max:c}})(s):(async e=>{let{wixData:t,schema:r,filterModel:n,fieldName:o,role:a}=e;const i=t.query(r.id).setFilterModel(n).limit(1),[{items:s},{items:l}]=await Promise.all([i.ascending(o).find(),i.descending(o).find()]),c=s.map(e=>e[o])[0],d=l.map(e=>e[o])[0];return{fieldName:o,role:a,min:c,max:d}})(s)};class Zn{constructor(e){let{wixData:t,wixDataSchemas:r}=e;this._wixData=eo.reduce((e,r)=>(e[r]=function(){const e=t[r](...arguments);return e.catch instanceof Function?e.catch(e=>{throw io(e)}):e},e),{...t}),this._wixDataSchemas=r}async fetchBulkData(e){const t=await Promise.all(e.map(e=>{let{collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:l,fieldIdsToFetch:c}=e;return this.fetchData({collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:l,fieldIdsToFetch:c}).catch(e=>({error:e}))}));return((e,t)=>t.reduce((t,r,n)=>{let{items:o,nextCursor:a,totalCount:i,uniqueFieldValues:s,error:l}=r;if(l)return t.recordInfosInDatasetOrder.push({error:l}),t;t.recordInfosInDatasetOrder.push({itemIds:o.map(e=>{let{_id:t}=e;return t}),totalCount:i,nextCursor:a});const c=e[n].collectionId,d=t.recordsByCollectionId[c];return t.recordsByCollectionId[c]=Fn(o,d),t.uniqueFieldValuesByCollection[c]={...t.uniqueFieldValuesByCollection[c],...s},t},{recordInfosInDatasetOrder:[],recordsByCollectionId:{},uniqueFieldValuesByCollection:{}}))(e,t)}async fetchData(e){let{collectionId:t,filter:r,sort:n,offset:o=0,includes:a,cursor:i,length:s,uniqueFieldValues:l,fieldIdsToFetch:c}=e;const d=i?this._wixData.fetch(t,i,s):(()=>{let e=this._wixData.query(t).setFilterModel(r).setSortModel(n).skip(o).limit(s);return null==a||a.forEach(t=>{e=e.include(t)}),c&&(e=e.fields(...c)),e.find()})(),u=l.length>0?this._fetchUniqueValues({collectionId:t,fieldKeys:l}):Promise.resolve({}),[p,f]=await Promise.all([d,u]),{items:h,totalCount:m,nextCursor:g}=p;return{items:h,nextCursor:g,totalCount:m||0,uniqueFieldValues:f}}async fetchUserFilterInitialData(e){let{filter:t,sort:r,userFilterConnectionProps:n,schema:o,schemas:a}=e;const i=[oe],s=(0,l.uniqBy)(n.filter(e=>{let{role:t}=e;return i.includes(t)}),"fieldName"),c=(0,l.uniqWith)(n.filter(e=>{let{role:t}=e;return Ne.includes(t)}),(e,t)=>e.fieldName===t.fieldName),d=await Promise.all([...s.map(async e=>{let{fieldName:r,role:n}=e;const a={schema:o,wixData:this._wixData,fieldName:r,role:n,filterModel:t};return Xn(a)}),...c.map(async e=>{let{fieldName:n,role:i}=e;const s=Bn(n),l={wixData:this._wixData,schema:o,schemas:a,fieldName:n,role:i,sortModel:r,filterModel:t};return s?Qn(l):(async e=>{var t;let{wixData:r,schema:n,fieldName:o,role:a,sortModel:i,filterModel:s}=e;const l=zn({wixData:r,schema:n,fieldName:o,sortModel:i,filterModel:s}),c=null==(t=n.allowedOperations)?void 0:t.includes(fe.DataOperation.distinct),d=jn(c?Wn:$n(qn));return{fieldName:o,role:a,options:await d({baseQuery:l,fieldName:o,schema:n})}})(l)})]);return d.filter($e)}async remove(e){let{collectionId:t,recordId:r}=e;return this._wixData.remove(t,r)}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return this._wixData.save(t,r,{includeReferences:n})}async getSibling(e){let{collectionName:t,filter:r,sort:n,fieldValues:o,sortFields:a,directionTowardSibling:i}=e;const s=()=>this._wixData.query(t).setFilterModel(r),{items:[l]}=await to({sort:n,sortFields:a,fieldValues:o,baseQuery:s(),directionTowardSibling:i,createBaseQuery:s}).find();return l}fetchSchemas(e){return this._wixDataSchemas.bulkGet(e,{referencedCollectionsDepth:1})}createSimpleFilter(e,t){return this._wixData.filter().eq(e,t).getFilterModel()}async _fetchUniqueValues(e){let{collectionId:t,fieldKeys:r}=e;return(await Promise.all(r.map(e=>this._wixData.query(t).distinct(e)))).reduce((e,t,n)=>{let{_items:o}=t;return e[r[n]]=o,e},{})}}const eo=["save","remove","find","sort","filter","query","fetch","aggregate"],to=e=>{let{sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a,createBaseQuery:i}=e;return ro({sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a,createBaseQuery:i})(r.length-1).reduce((e,t)=>e.or(t))},ro=e=>{let{baseQuery:t,sortFields:r,sort:n,directionTowardSibling:o,fieldValues:a,createBaseQuery:i}=e;return function e(s){if(-1===s)return[];const c=r[s];if(void 0===a[c]&&n[c]!==o)return e(s-1);return[(0,l.flow)(no(n,o),oo(n[c],o,c,a[c],i),ao(s,r,a))(t),...e(s-1)]}},no=(e,t)=>r=>Object.entries(e).reduce((e,r)=>{let[n,o]=r;return o===t?e.ascending(n):e.descending(n)},r),oo=(e,t,r,n,o)=>a=>e===t?void 0===n?a.isNotEmpty(r):a.gt(r,n):a.lt(r,n).or(o().isEmpty(r)),ao=(e,t,r)=>n=>(0,l.range)(e).reduce((e,n)=>e.eq(t[n],r[t[n]]),n).limit(1),io=e=>{if(!e.stack){const{message:t,code:r}="string"==typeof e?{message:e,code:"WD_VALIDATION_FAILED"}:e,n=new Error(t);return n.code=r,n}return e};class so{constructor(e){s()(this,"warmupData",void 0),this.warmupData=e}getSchemas(){return this.warmupData.get("schemas")}setSchemas(e){this.warmupData.set("schemas",e)}getDataStore(){return this.warmupData.get("dataStore")}setDataStore(e){this.warmupData.set("dataStore",e)}getUserFilterInitialData(e){return this.warmupData.get(`userFilterInitialData-${e}`)}setUserFilterInitialData(e,t){this.warmupData.set(`userFilterInitialData-${e}`,t)}}class lo{constructor(e){if(e&&e.config){this._collectionId=e.config.dataset.collectionName,this._items=e.items,this._schemas=e.schemas;const t=e.nextCursor||void 0,r=e.totalCount||0,n=(e.items||[]).length;this._datasetSize={cursor:t,total:r,loaded:n}}}getSchemas(){return this._schemas}getDataStore(){if(this._items)return(e=>{let{items:t,datasetSize:r,collectionId:n}=e;return{recordInfosInDatasetOrder:[{itemIds:t.map(e=>{let{_id:t}=e;return t}),datasetSize:r,collectionId:n}],recordsByCollectionId:{[n]:Fn(t,{})}}})({items:this._items,datasetSize:this._datasetSize,collectionId:this._collectionId})}getItems(){return this._items}}const{USER_SCOPE:co,APPLICATION_SCOPE:uo,SERVER_SCOPE:po,CORE_SCOPE:fo}=n.DataBindingError.scopes,ho={[uo]:"https://cef68e5a2fd04f08a7c2a02738dbc237@sentry-next.wixpress.com/2411",[co]:"https://e9289aa805f74cfabb806b3a206f4047@sentry-next.wixpress.com/10331",[po]:"https://e9c9bfc492a8457e8358d001a0958cb5@sentry-next.wixpress.com/10332",[fo]:"https://45f18e63f7064a63b07082d2bc09dfdc@sentry-next.wixpress.com/23244"};let mo=function(e,t){return r=>this.mode.dev?(e===Error&&(this.console.error(r),r.cause&&this.console.error("Caused by:",r.cause)),null==r.run?void 0:r.run()):t(r)};class go{constructor(e){let{fedops:t,bi:r,monitor:n,verbose:o,console:a,platform:i}=e;const s=a.factory();mo=mo.bind({mode:i.settings.mode,console:s}),this._eventToHandler=this._createEventToHandler(),this._fedOpsLogger=this._createFedopsLogger(t),this._bi=this._createBiLoggers({bi:r,settings:i.settings}),this._monitor=this._setupMonitor({monitor:n,platform:i}),this._verboseLogger=o.factory(),this._console=s,this._errorMonitorTags={msid:i.settings.metaSiteId,url:(i.location.pageUrl||"").slice(0,200),viewMode:i.settings.mode.name,renderMode:i.settings.env.name}}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1)return t.map(e=>this.log(e));const[n]=t,[,o]=Array.from(this._eventToHandler).find(e=>{let[t]=e;return t.prototype.isPrototypeOf(n)})||[];return o?o(n):this._console.error("This event is not supported by logger",n)}_createEventToHandler(){return new Map([[Error,mo(Error,e=>{if(e instanceof n.UnhandledPromiseRejection)this._console.warn("You have unhandled error in async operation. Consider catching it and handling accordingly.\n",e.cause);else{const{scope:t,cause:r,options:{extra:o,...a}={}}=e;e instanceof n.UserError&&(this._console.error(e),r&&this._console.error("Caused by:",r));const i=r instanceof Error;this._monitor[t].captureException(i?r:e,{tags:{...a,...this._errorMonitorTags,wrapperErrorMessage:i?`${e.name}: ${e.message}\n${e.stack}`.slice(0,200):void 0},contexts:{...o,wrapperError:i?e:void 0}})}})],[Fe,mo(Fe,e=>{let{event:t,type:r}=e;return r===Fe.types.ERROR?this._bi.errorLogger.log(t):this._bi.logger.log(t)})],[Le,mo(Le,e=>{let{name:t,params:r,run:n,onStart:o,onEnd:a}=e;return o(()=>this._fedOpsLogger.interactionStarted(t,r)),a(()=>this._fedOpsLogger.interactionEnded(t,r)),n()})],[Ue,mo(Ue,e=>{let{event:t}=e;this._monitor[uo].addBreadcrumb(t),this._monitor[fo].addBreadcrumb(t)})],[Me,e=>{let{messages:t}=e;return this._verboseLogger.log(...t)}],[ke,e=>{let{message:t,level:r}=e;return this._console[r](t)}]])}_createFedopsLogger(e){let{factory:t,hooks:{start:r,end:n}}=e;return t.getLoggerForWidget({appId:"databinding",appName:"databinding",startHook:r,endHook:n})}_createBiLoggers(e){let{bi:{factory:t},settings:{env:r}}=e;return{logger:t().logger({endpoint:r.editor?"platform":"platform-viewer"}),errorLogger:t().logger({endpoint:"trg"})}}_setupMonitor(e){let{monitor:t,platform:r}=e;return Object.entries(ho).reduce((e,n)=>{let[o,a]=n;return e[o]=(e=>{let{monitor:t,dsn:r,platform:n}=e;const o=R(Ae),a=S(o);return t.createErrorMonitor({dsn:r,appName:Ae,version:a,environment:n.settings.mode.name,user:{id:n.user.id}})})({monitor:t,dsn:a,platform:r}),e},{})}}class yo{constructor(){this._recordInfosByDatasetId={},this._recordsByCollectionId={},this._uniqueFieldValuesByCollection={},this._schemas={},this._userFilterInitialData={}}getData(e){let{datasetId:t,collectionId:r,includes:n}=e;const o=this._recordInfosByDatasetId[t];return o?{datasetSize:o.datasetSize,items:o.itemIds.map(e=>vo(this._recordsByCollectionId[r][e],this.getSchema(r),n))}:null}getRecord(e){var t;let{collectionId:r,recordId:n,includes:o}=e;const a=null==(t=this._recordsByCollectionId[r])?void 0:t[n];return a&&vo(a,this.getSchema(r),o)}updateCollectionData(e){let{collectionId:t,data:r}=e;const{[t]:n}=this._recordsByCollectionId,{[t]:o}=this._uniqueFieldValuesByCollection,{items:a,uniqueFieldValues:i}=r;this._recordsByCollectionId[t]=_o(a,n),this._uniqueFieldValuesByCollection[t]=To(i,o)}getSchema(e){return this._schemas[e]}updateStore(e){let{recordsByCollectionId:t={},recordInfosByDatasetId:r={},uniqueFieldValuesByCollection:n={}}=e;this._recordInfosByDatasetId={...this._recordInfosByDatasetId,...r};for(const[e,r]of Object.entries(t))this._recordsByCollectionId[e]=Eo(r,this._recordsByCollectionId[e]);for(const[e,t]of Object.entries(n))this._uniqueFieldValuesByCollection[e]={...this._uniqueFieldValuesByCollection[e],...t}}getStore(){return{recordInfosByDatasetId:this._recordInfosByDatasetId,recordsByCollectionId:this._recordsByCollectionId,uniqueFieldValuesByCollection:this._uniqueFieldValuesByCollection}}hasDataset(e){return Boolean(this._recordInfosByDatasetId[e])}setUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;this._uniqueFieldValuesByCollection[t]={...this._uniqueFieldValuesByCollection[t],[r]:n}}getUniqueFieldValues(e){var t;let{collectionId:r,fieldKey:n}=e;return null==(t=this._uniqueFieldValuesByCollection[r])?void 0:t[n]}updateSchemas(e){for(const[t,r]of Object.entries(e))this._schemas[t]={...this._schemas[t],...r}}getSchemas(){return this._schemas}getUserFilterInitialData(e){return this._userFilterInitialData[e]}setUserFilterInitialData(e,t){this._userFilterInitialData[e]=t}}const vo=(e,t,r)=>Object.entries(e).reduce((e,n)=>{let[o,a]=n;return((e,t)=>{var r;return(null==t||null==(r=t.fields)||null==(r=r[e])?void 0:r.type)===fe.FieldType.reference})(o,t)&&((e,t)=>!e||!e.includes(t))(r,o)&&Boolean(null==a?void 0:a._id)?e[o]=a._id:e[o]=a,e},{}),_o=function(e,t){return void 0===t&&(t={}),e.reduce((e,t)=>{const r=e[t._id];return e[t._id]=Io(t,r),e},t)},Eo=function(e,t){void 0===t&&(t={});for(const[r,n]of Object.entries(e)){const e=t[r];t[r]=Io(n,e)}return t},Io=(e,t)=>t?(0,l.mergeWith)(t,e,An):e,To=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),{...t,...e}},So=e=>e?.plugins?.[fe.CMS_PLUGIN_ID]?.siteSort?.sort,wo=async({datasetConfigSort:e,getSchema:t})=>{const r=e&&e.length>0?e:(n=await t(),(So(n)||[]).map(({fieldName:e,direction:t})=>({[e]:t})));var n;return r.length>0?r:null},Ro={SCALE_TO_FILL:"fill",SCALE_TO_FIT:"fit",STRETCH:"stretch",ORIGINAL_SIZE:"original_size",TILE:"tile",TILE_HORIZONTAL:"tile_horizontal",TILE_VERTICAL:"tile_vertical",FIT_AND_TILE:"fit_and_tile",LEGACY_STRIP_TILE:"legacy_strip_tile",LEGACY_STRIP_TILE_HORIZONTAL:"legacy_strip_tile_horizontal",LEGACY_STRIP_TILE_VERTICAL:"legacy_strip_tile_vertical",LEGACY_STRIP_SCALE_TO_FILL:"legacy_strip_fill",LEGACY_STRIP_SCALE_TO_FIT:"legacy_strip_fit",LEGACY_STRIP_FIT_AND_TILE:"legacy_strip_fit_and_tile",LEGACY_STRIP_ORIGINAL_SIZE:"legacy_strip_original_size",LEGACY_ORIGINAL_SIZE:"actual_size",LEGACY_FIT_WIDTH:"fitWidth",LEGACY_FIT_HEIGHT:"fitHeight",LEGACY_FULL:"full",LEGACY_BG_FIT_AND_TILE:"legacy_tile",LEGACY_BG_FIT_AND_TILE_HORIZONTAL:"legacy_tile_horizontal",LEGACY_BG_FIT_AND_TILE_VERTICAL:"legacy_tile_vertical",LEGACY_BG_NORMAL:"legacy_normal"},Po="fit",Co="fill",Oo="fill_focal",bo="crop",No="legacy_crop",Do="legacy_fill",Ao="center",Fo="top",xo="top_left",Lo="top_right",Uo="bottom",Mo="bottom_left",ko="bottom_right",Bo="left",Vo="right",Go={[Ao]:{x:.5,y:.5},[xo]:{x:0,y:0},[Lo]:{x:1,y:0},[Fo]:{x:.5,y:0},[Mo]:{x:0,y:1},[ko]:{x:1,y:1},[Uo]:{x:.5,y:1},[Vo]:{x:1,y:.5},[Bo]:{x:0,y:.5}},jo={center:"c",top:"t",top_left:"tl",top_right:"tr",bottom:"b",bottom_left:"bl",bottom_right:"br",left:"l",right:"r"},$o="img",qo={AUTO:"auto",CLASSIC:"classic",SUPER:"super"},Wo=1,zo=2,Ho={radius:"0.66",amount:"1.00",threshold:"0.01"},Yo=25e6,Jo=[1.5,2,4],Ko={HIGH:{size:196e4,quality:90,maxUpscale:1},MEDIUM:{size:36e4,quality:85,maxUpscale:1},LOW:{size:16e4,quality:80,maxUpscale:1.2},TINY:{size:0,quality:80,maxUpscale:1.4}},Qo="HIGH",Xo="MEDIUM",Zo="LOW",ea="TINY",ta="contrast",ra="brightness",na="saturation",oa="hue",aa="blur",ia="jpg",sa="jpeg",la="jpe",ca="png",da="webp",ua="gif",pa="avif",fa="unrecognized",ha="AVIF",ma="PAVIF";function ga(e,...t){return function(...r){const n=r[r.length-1]||{},o=[e[0]];return t.forEach(function(t,a){const i=Number.isInteger(t)?r[t]:n[t];o.push(i,e[a+1])}),o.join("")}}function ya(e){return e[e.length-1]}const va=[ca,sa,ia,la,"wix_ico_mp","wix_mp",da,pa],_a=[sa,ia,la];function Ea(e,t,r){return function(e,t,r=!1){return!((Ia(e)||Sa(e))&&t&&!r)}(e,t,r)&&(function(e){return va.includes(Ca(e))}(e)||function(e,t=!1){return Ta(e)&&t}(e,r))&&!function(e){return/(^https?)|(^data)|(^\/\/)/.test(e)}(e)}function Ia(e){return Ca(e)===da}function Ta(e){return Ca(e)===ua}function Sa(e){return Ca(e)===pa}const wa=["/","\\","?","<",">","|","\u201c",":",'"'].map(encodeURIComponent),Ra=["\\.","\\*"];function Pa(e){return function(e){return _a.includes(Ca(e))}(e)?ia:function(e){return Ca(e)===ca}(e)?ca:Ia(e)?da:Ta(e)?ua:Sa(e)?pa:fa}function Ca(e){return(/[.]([^.]+)$/.exec(e)&&/[.]([^.]+)$/.exec(e)[1]||"").toLowerCase()}function Oa(e,t,r,n,o){let a;return a=o===Co?function(e,t,r,n){return Math.max(r/e,n/t)}(e,t,r,n):o===Po?function(e,t,r,n){return Math.min(r/e,n/t)}(e,t,r,n):1,a}function ba(e,t,r,n,o,a){e=e||n.width,t=t||n.height;const{scaleFactor:i,width:s,height:l}=function(e,t,r,n,o){let a,i=r,s=n;if(a=Oa(e,t,r,n,o),o===Po&&(i=e*a,s=t*a),i&&s&&i*s>Yo){const r=Math.sqrt(Yo/(i*s));i*=r,s*=r,a=Oa(e,t,i,s,o)}return{scaleFactor:a,width:i,height:s}}(e,t,n.width*o,n.height*o,r);return function(e,t,r,n,o,a,i){const{optimizedScaleFactor:s,upscaleMethodValue:l,forceUSM:c}=function(e,t,r,n){if("auto"===n)return function(e,t){const r=Fa(e,t);return{optimizedScaleFactor:Ko[r].maxUpscale,upscaleMethodValue:Wo,forceUSM:!1}}(e,t);if("super"===n)return function(e){return{optimizedScaleFactor:ya(Jo),upscaleMethodValue:zo,forceUSM:!(Jo.includes(e)||e>ya(Jo))}}(r);return function(e,t){const r=Fa(e,t);return{optimizedScaleFactor:Ko[r].maxUpscale,upscaleMethodValue:Wo,forceUSM:!1}}(e,t)}(e,t,a,o);let d=r,u=n;if(a<=s)return{width:d,height:u,scaleFactor:a,upscaleMethodValue:l,forceUSM:c,cssUpscaleNeeded:!1};switch(i){case Co:d=r*(s/a),u=n*(s/a);break;case Po:d=e*s,u=t*s}return{width:d,height:u,scaleFactor:s,upscaleMethodValue:l,forceUSM:c,cssUpscaleNeeded:!0}}(e,t,s,l,a,i,r)}function Na(e,t,r,n){const o=Aa(r)||function(e=Ao){return Go[e]}(n);return{x:Math.max(0,Math.min(e.width-t.width,o.x*e.width-t.width/2)),y:Math.max(0,Math.min(e.height-t.height,o.y*e.height-t.height/2)),width:Math.min(e.width,t.width),height:Math.min(e.height,t.height)}}function Da(e){return e.alignment&&jo[e.alignment]||jo[Ao]}function Aa(e){let t;return!e||"number"!=typeof e.x||isNaN(e.x)||"number"!=typeof e.y||isNaN(e.y)||(t={x:xa(Math.max(0,Math.min(100,e.x))/100,2),y:xa(Math.max(0,Math.min(100,e.y))/100,2)}),t}function Fa(e,t){const r=e*t;return r>Ko[Qo].size?Qo:r>Ko[Xo].size?Xo:r>Ko[Zo].size?Zo:ea}function xa(e,t){const r=Math.pow(10,t||0);return(e*r/r).toFixed(t)}function La(e){return e&&e.upscaleMethod&&qo[e.upscaleMethod.toUpperCase()]||qo.AUTO}function Ua(e,t){const r=Ia(e)||Sa(e);return Ca(e)===ua||r&&t}const Ma={isMobile:!1};function ka(){if("undefined"!=typeof window&&"undefined"!=typeof navigator){const t=window.matchMedia&&window.matchMedia("(max-width: 767px)").matches,r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e=t&&r,Ma["isMobile"]=e}var e}function Ba(){return Ma["isMobile"]}function Va(e,t,r){let n;switch(t.crop&&(n=function(e,t){const r=Math.max(0,Math.min(e.width,t.x+t.width)-Math.max(0,t.x)),n=Math.max(0,Math.min(e.height,t.y+t.height)-Math.max(0,t.y));return r&&n&&(e.width!==r||e.height!==n)?{x:Math.max(0,t.x),y:Math.max(0,t.y),width:r,height:n}:null}(t,t.crop),n&&(e.src.width=n.width,e.src.height=n.height,e.src.isCropped=!0,e.parts.push(ja(n)))),e.fittingType){case Ro.SCALE_TO_FIT:case Ro.LEGACY_FIT_WIDTH:case Ro.LEGACY_FIT_HEIGHT:case Ro.LEGACY_FULL:case Ro.FIT_AND_TILE:case Ro.LEGACY_BG_FIT_AND_TILE:case Ro.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:case Ro.LEGACY_BG_FIT_AND_TILE_VERTICAL:case Ro.LEGACY_BG_NORMAL:e.parts.push(Ga(e,r));break;case Ro.SCALE_TO_FILL:e.parts.push(function(e,t){const r=ba(e.src.width,e.src.height,Co,t,e.devicePixelRatio,e.upscaleMethod),n=Aa(e.focalPoint);return{transformType:n?Oo:Co,width:Math.round(r.width),height:Math.round(r.height),alignment:Da(t),focalPointX:n&&n.x,focalPointY:n&&n.y,upscale:r.scaleFactor>1,forceUSM:r.forceUSM,scaleFactor:r.scaleFactor,cssUpscaleNeeded:r.cssUpscaleNeeded,upscaleMethodValue:r.upscaleMethodValue}}(e,r));break;case Ro.STRETCH:e.parts.push(function(e,t){const r=Oa(e.src.width,e.src.height,t.width,t.height,Co),n={...t};return n.width=e.src.width*r,n.height=e.src.height*r,Ga(e,n)}(e,r));break;case Ro.TILE_HORIZONTAL:case Ro.TILE_VERTICAL:case Ro.TILE:case Ro.LEGACY_ORIGINAL_SIZE:case Ro.ORIGINAL_SIZE:n=Na(e.src,r,e.focalPoint,r.alignment),e.src.isCropped?(Object.assign(e.parts[0],n),e.src.width=n.width,e.src.height=n.height):e.parts.push(ja(n));break;case Ro.LEGACY_STRIP_TILE_HORIZONTAL:case Ro.LEGACY_STRIP_TILE_VERTICAL:case Ro.LEGACY_STRIP_TILE:case Ro.LEGACY_STRIP_ORIGINAL_SIZE:e.parts.push(function(e){return{transformType:No,width:Math.round(e.width),height:Math.round(e.height),alignment:Da(e),upscale:!1,forceUSM:!1,scaleFactor:1,cssUpscaleNeeded:!1}}(r));break;case Ro.LEGACY_STRIP_SCALE_TO_FIT:case Ro.LEGACY_STRIP_FIT_AND_TILE:e.parts.push(function(e){return{transformType:Po,width:Math.round(e.width),height:Math.round(e.height),upscale:!1,forceUSM:!0,scaleFactor:1,cssUpscaleNeeded:!1}}(r));break;case Ro.LEGACY_STRIP_SCALE_TO_FILL:e.parts.push(function(e){return{transformType:Do,width:Math.round(e.width),height:Math.round(e.height),alignment:Da(e),upscale:!1,forceUSM:!0,scaleFactor:1,cssUpscaleNeeded:!1}}(r))}}function Ga(e,t){const r=ba(e.src.width,e.src.height,Po,t,e.devicePixelRatio,e.upscaleMethod);return{transformType:!e.src.width||!e.src.height?Po:Co,width:Math.round(r.width),height:Math.round(r.height),alignment:jo.center,upscale:r.scaleFactor>1,forceUSM:r.forceUSM,scaleFactor:r.scaleFactor,cssUpscaleNeeded:r.cssUpscaleNeeded,upscaleMethodValue:r.upscaleMethodValue}}function ja(e){return{transformType:bo,x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height),upscale:!1,forceUSM:!1,scaleFactor:1,cssUpscaleNeeded:!1}}function $a(e,t){t=t||{},e.quality=function(e,t){const r=e.fileType===ca,n=e.fileType===ia,o=e.fileType===da,a=e.fileType===pa,i=n||r||o||a;if(i){const n=ya(e.parts),o=(s=n.width,l=n.height,Ko[Fa(s,l)].quality);let a=t.quality&&t.quality>=5&&t.quality<=90?t.quality:o;return a=r?a+5:a,a}var s,l;return 0}(e,t),e.progressive=function(e){return!1!==e.progressive}(t),e.watermark=function(e){return e.watermark}(t),e.autoEncode=t.autoEncode??!0,e.encoding=t?.encoding,e.unsharpMask=function(e,t){if(function(e){const t="number"==typeof(e=e||{}).radius&&!isNaN(e.radius)&&e.radius>=.1&&e.radius<=500,r="number"==typeof e.amount&&!isNaN(e.amount)&&e.amount>=0&&e.amount<=10,n="number"==typeof e.threshold&&!isNaN(e.threshold)&&e.threshold>=0&&e.threshold<=255;return t&&r&&n}(t.unsharpMask))return{radius:xa(t.unsharpMask?.radius,2),amount:xa(t.unsharpMask?.amount,2),threshold:xa(t.unsharpMask?.threshold,2)};if(("number"!=typeof(r=(r=t.unsharpMask)||{}).radius||isNaN(r.radius)||0!==r.radius||"number"!=typeof r.amount||isNaN(r.amount)||0!==r.amount||"number"!=typeof r.threshold||isNaN(r.threshold)||0!==r.threshold)&&function(e){const t=ya(e.parts);return!(t.scaleFactor>=1)||t.forceUSM||t.transformType===Po}(e))return Ho;var r;return}(e,t),e.filters=function(e){const t=e.filters||{},r={};qa(t[ta],-100,100)&&(r[ta]=t[ta]);qa(t[ra],-100,100)&&(r[ra]=t[ra]);qa(t[na],-100,100)&&(r[na]=t[na]);qa(t[oa],-180,180)&&(r[oa]=t[oa]);qa(t[aa],0,100)&&(r[aa]=t[aa]);return r}(t)}function qa(e,t,r){return"number"==typeof e&&!isNaN(e)&&0!==e&&e>=t&&e<=r}function Wa(e,t,r,n){const o=function(e){return e?.isSEOBot??!1}(n),a=Pa(t.id),i=function(e,t){const r=/\.([^.]*)$/,n=new RegExp(`(${wa.concat(Ra).join("|")})`,"g");if(t&&t.length){let e=t;const o=t.match(r);return o&&va.includes(o[1])&&(e=t.replace(r,"")),encodeURIComponent(e).replace(n,"_")}const o=e.match(/\/(.*?)$/);return(o?o[1]:e).replace(r,"")}(t.id,t.name),s=o?1:function(e){return Math.min(e.pixelAspectRatio||1,2)}(r),l=Ca(t.id),c=l,d=Ea(t.id,n?.hasAnimation,n?.allowAnimatedTransform),u={fileName:i,fileExtension:l,fileType:a,fittingType:e,preferredExtension:c,src:{id:t.id,width:t.width,height:t.height,isCropped:!1,isAnimated:Ua(t.id,n?.hasAnimation)},focalPoint:{x:t.focalPoint&&t.focalPoint.x,y:t.focalPoint&&t.focalPoint.y},parts:[],devicePixelRatio:s,quality:0,upscaleMethod:La(n),progressive:!0,watermark:"",unsharpMask:{},filters:{},transformed:d};return d&&(Va(u,t,r),$a(u,n)),u}const za=ga`fit/w_${"width"},h_${"height"}`,Ha=ga`fill/w_${"width"},h_${"height"},al_${"alignment"}`,Ya=ga`fill/w_${"width"},h_${"height"},fp_${"focalPointX"}_${"focalPointY"}`,Ja=ga`crop/x_${"x"},y_${"y"},w_${"width"},h_${"height"}`,Ka=ga`crop/w_${"width"},h_${"height"},al_${"alignment"}`,Qa=ga`fill/w_${"width"},h_${"height"},al_${"alignment"}`,Xa=ga`,lg_${"upscaleMethodValue"}`,Za=ga`,q_${"quality"}`,ei=ga`,quality_auto`,ti=ga`,usm_${"radius"}_${"amount"}_${"threshold"}`,ri=ga`,bl`,ni=ga`,wm_${"watermark"}`,oi={[ta]:ga`,con_${"contrast"}`,[ra]:ga`,br_${"brightness"}`,[na]:ga`,sat_${"saturation"}`,[oa]:ga`,hue_${"hue"}`,[aa]:ga`,blur_${"blur"}`},ai=ga`,enc_auto`,ii=ga`,enc_avif`,si=ga`,enc_pavif`,li=ga`,pstr`;function ci(e,t,r,n={},o){if(Ea(t.id,n?.hasAnimation,n?.allowAnimatedTransform)){if(Ia(t.id)||Sa(t.id)){const{alignment:a,...i}=r;t.focalPoint={x:void 0,y:void 0},delete t?.crop,o=Wa(e,t,i,n)}else o=o||Wa(e,t,r,n);return function(e){const t=[];e.parts.forEach(e=>{switch(e.transformType){case bo:t.push(Ja(e));break;case No:t.push(Ka(e));break;case Do:let r=Qa(e);e.upscale&&(r+=Xa(e)),t.push(r);break;case Po:let n=za(e);e.upscale&&(n+=Xa(e)),t.push(n);break;case Co:let o=Ha(e);e.upscale&&(o+=Xa(e)),t.push(o);break;case Oo:let a=Ya(e);e.upscale&&(a+=Xa(e)),t.push(a)}});let r=t.join("/");return e.quality&&(r+=Za(e)),e.unsharpMask&&(r+=ti(e.unsharpMask)),e.progressive||(r+=ri(e)),e.watermark&&(r+=ni(e)),e.filters&&(r+=Object.keys(e.filters).map(t=>oi[t](e.filters)).join("")),e.fileType!==ua&&(e.encoding===ha?(r+=ii(e),r+=ei(e)):e.encoding===ma?(r+=si(e),r+=ei(e)):e.autoEncode&&(r+=ai(e))),e.src?.isAnimated&&e.transformed&&(r+=li(e)),`${e.src.id}/v1/${r}/${e.fileName}.${e.preferredExtension}`}(o)}return t.id}const di={[Ao]:"50% 50%",[xo]:"0% 0%",[Lo]:"100% 0%",[Fo]:"50% 0%",[Mo]:"0% 100%",[ko]:"100% 100%",[Uo]:"50% 100%",[Vo]:"100% 50%",[Bo]:"0% 50%"};Object.entries(di).reduce((e,[t,r])=>(e[r]=t,e),{});function ui(e,t,r,n){if(function(e,t,r){return r&&t&&!function(e){return!e||!e.trim()||"none"===e.toLowerCase()}(t.id)&&Object.values(Ro).includes(e)}(e,t,r)){const o=function(e,t,r){const n={...r},o=Ba();switch(e){case Ro.LEGACY_BG_FIT_AND_TILE:case Ro.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:case Ro.LEGACY_BG_FIT_AND_TILE_VERTICAL:case Ro.LEGACY_BG_NORMAL:const e=o?1e3:1920,r=o?1e3:1920;n.width=Math.min(e,t.width),n.height=Math.min(r,Math.round(n.width/(t.width/t.height))),n.pixelAspectRatio=1}return n}(e,t,r);return{uri:ci(e,t,o,n||{},Wa(e,t,o,n))}}return{uri:""}}const pi=/^media\//i,fi="undefined"!=typeof window?window.devicePixelRatio:1,hi=(e,t)=>{const r=t&&t.baseHostURL;return r?`${r}${e}`:(e=>pi.test(e)?`https://static.wixstatic.com/${e}`:`https://static.wixstatic.com/media/${e}`)(e)};ka();ka();const mi={getScaleToFitImageURL:function(e,t,r,n,o,a){const i=ui(Ro.SCALE_TO_FIT,{id:e,width:t,height:r,name:a&&a.name},{width:n,height:o,htmlTag:$o,alignment:Ao,pixelAspectRatio:a?.devicePixelRatio??fi},a);return hi(i.uri,a)},getScaleToFillImageURL:function(e,t,r,n,o,a){const i=ui(Ro.SCALE_TO_FILL,{id:e,width:t,height:r,name:a&&a.name,focalPoint:{x:a&&a.focalPoint&&a.focalPoint.x,y:a&&a.focalPoint&&a.focalPoint.y}},{width:n,height:o,htmlTag:$o,alignment:Ao,pixelAspectRatio:a?.devicePixelRatio??fi},a);return hi(i.uri,a)},getCropImageURL:function(e,t,r,n,o,a,i,s,l,c){const d=ui(Ro.SCALE_TO_FILL,{id:e,width:t,height:r,name:c&&c.name,crop:{x:n,y:o,width:a,height:i}},{width:s,height:l,htmlTag:$o,alignment:Ao,pixelAspectRatio:c?.devicePixelRatio??fi},c);return hi(d.uri,c)}},gi="tpa/";function yi(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function vi(e,t){return e.get(Ei(e,t))}function _i(e,t,r){return e.set(Ei(e,t),r),r}function Ei(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Ii=new WeakMap,Ti=new WeakMap,Si=new WeakMap,wi=new WeakMap,Ri=new WeakMap,Pi=new WeakMap,Ci=new WeakMap,Oi=new WeakMap;class bi{constructor(e){let{platformUtils:t,platformSettings:r,wixSdk:n,bi:o,tpaActionImplementations:a,devMode:i,verbose:s}=e;yi(this,Ii,void 0),yi(this,Ti,void 0),yi(this,Si,void 0),yi(this,wi,void 0),yi(this,Ri,void 0),yi(this,Pi,void 0),yi(this,Ci,void 0),yi(this,Oi,void 0),_i(Oi,this,e=>n.window.postMessage(e)),_i(Ii,this,this._getSettings({wixSdk:n,platformSettings:r,bi:o,devMode:i,verbose:s})),_i(Ti,this,this._getUser(n.user)),_i(Si,this,this._getLocation(n.location,o)),_i(wi,this,this._getUtils(t)),_i(Ri,this,this._getTimers(n)),_i(Pi,this,async e=>{let{currentItem:t,action:r}=e;const o=a[r];await o({wixSdk:n,currentItem:t})}),_i(Ci,this,this._getSeo(n))}get postMessage(){return vi(Oi,this)}get settings(){return vi(Ii,this)}get user(){return vi(Ti,this)}get location(){return vi(Si,this)}get utils(){return vi(wi,this)}get timers(){return vi(Ri,this)}get executeTpaAction(){return vi(Pi,this)}get seo(){return vi(Ci,this)}_getSettings(e){var t;let{wixSdk:{site:{language:r},window:{viewMode:n,rendering:{env:o},browserLocale:a,multilingual:{currentLanguage:i,siteLanguages:s,isEnabled:l}},site:{regionalSettings:c=a}},platformSettings:{url:d,instance:u,appData:{gridAppId:p,veloCodeIsPresentOnCurrentPage:f,blocksAppIsPresentOnSite:h}={gridAppId:"",veloCodeIsPresentOnCurrentPage:!0,blocksAppIsPresentOnSite:!1}},bi:{metaSiteId:m,viewerName:g},devMode:y,verbose:v}=e;const _=l?(null==(t=s.find(e=>{let{languageCode:t}=e;return t===i}))?void 0:t.locale)??c:c;return{metaSiteId:m,gridAppId:p,url:d,instance:u,language:i||r,locale:_,mode:{name:o,dev:y,verbose:v,ssr:"backend"===o,csr:"backend"!==o},env:{name:n,live:"Site"===n,preview:"Preview"===n,livePreview:"Editor"===n,editor:"Preview"===n||"Editor"===n,renderer:g,veloCodeIsPresentOnCurrentPage:f,blocksAppIsPresentOnSite:h}}}_getUser(e){return{get id(){return e.currentUser.id},get loggedIn(){return e.currentUser.loggedIn},onLogin:e.onLogin}}_getLocation(e,t){let{pageId:r}=t;return{pageId:r,get pageUrl(){return e.url},get baseUrl(){return e.baseUrl},get path(){return e.path},queryParams:e.query,navigateTo:e.to,onChange:e.onChange}}_getUtils(e){let{links:t,mediaItemUtils:r}=e;return{links:t,media:{...r,getScaleToFillImageURL:mi.getScaleToFillImageURL}}}_getTimers(e){var t;return{queueMicrotask:(null==(t=e.environment)||null==(t=t.timers)?void 0:t.queueMicrotask)||queueMicrotask}}_getSeo(e){return{renderSEOTags:e.seo.renderSEOTags}}}const Ni={READ:"read",WRITE:"write",READ_WRITE:"read-write"},Di=e=>{const t=new Set;for(const r of e){const e=[r];for(;e.length;){const r=e.pop();if(r&&"object"==typeof r&&!Array.isArray(r))for(const[n,o]of Object.entries(r)){if("expressions"===n)return;if(o&&"string"==typeof o){if("action"===n&&o.startsWith(gi)||"role"===n&&o===k)return;if("fieldName"===n){t.add(o.split(".")[0]);continue}}e.push(o)}}}return t.size?[...t]:["_id"]},Ai={[mr]:"regular",[gr]:"router",[yr]:"widget"};function Fi(e){if(void 0===e)return;const t={};for(const r in e)void 0!==e[r]&&(t[r]=e[r]);return t}const xi={id:"",parentId:null,type:"regular",collectionId:Rt.collectionName,readWriteType:Ni[Rt.readWriteType],deferred:Rt.deferred,private:!1,pagination:{pageSize:Rt.pageSize,currentPage:1,type:"offset"},rendering:{nestedFieldIds:[],connections:[],componentIdsToRender:[]},dataLoading:{dataIsInvalidated:!1,referenceFieldIdsToFetch:[],filter:Rt.filter,sort:Rt.sort},routerConfig:null},Li={...xi,type:"router"},Ui={...xi,type:"widget",collectionId:"WIDGET"},Mi=e=>{let{config:{pagination:{currentPage:t}}}=e;return t},ki=e=>{let{config:{pagination:{pageSize:t}}}=e;return t},Bi=e=>e.config.pagination.type,Vi=e=>"router"===e.config.type,Gi=e=>{var t;return Vi(e)&&Boolean(null==(t=e.config.routerConfig)||null==(t=t.dynamicUrl)?void 0:t.match(/\{.+\}/))&&1===e.config.pagination.pageSize},ji={make:function(e){let t,{config:r,data:n=null}=void 0===e?{}:e;switch(null==r?void 0:r.type){case"router":t=Li;break;case"widget":t=Ui;break;default:t=xi}return{config:{...t,...Fi(r),pagination:{...t.pagination,...Fi(null==r?void 0:r.pagination)},rendering:{...t.rendering,...Fi(null==r?void 0:r.rendering)},dataLoading:{...t.dataLoading,...Fi(null==r?void 0:r.dataLoading)}},data:n}},makeVirtual:(e,t)=>{let{scopeId:r,itemId:n,scopedToItem:o=!1}=t;return{...e,config:{...e.config,id:`${e.config.id}_componentId_${r}_itemId_${n}`,parentId:e.config.id,pagination:{...e.config.pagination,currentPage:1,pageSize:o?1:e.config.pagination.pageSize},dataLoading:{...e.config.dataLoading,filter:o?{_id:{$eq:n}}:e.config.dataLoading.filter}}}},getId:e=>{let{config:{id:t}}=e;return t},isReal:e=>null===e.config.parentId,isRouter:Vi,isItemPageRouter:Gi,isWriteOnly:e=>"write"===e.config.readWriteType,isDeferred:e=>e.config.deferred,isWidget:e=>"widget"===e.config.type,getCurrentPage:Mi,getPageSize:ki,getOffset:e=>(Mi(e)-1)*ki(e),getCollectionId:e=>{let{config:{collectionId:t}}=e;return t},getFieldIdsToFetch:e=>e.config.dataLoading.fieldIdsToFetch,initCurrentPage:(e,t)=>{let r;return r=Gi(e)?1:Number(t[Vi(e)?"dynamic_page":`${e.config.id}_page`]??1),{...e,config:{...e.config,pagination:{...e.config.pagination,currentPage:r}}}},getPaginationType:Bi,isPaginationCursor:e=>"cursor"===Bi(e),isPrivate:e=>e.config.private},$i=e=>"widget"===e.config.type;class qi{constructor(){const{logger:e,dataFetcher:t}=f;this._dataFetcher=t,this._logger=e,this._dataStore=new yo,this._dataFetchingBulk={},this._bulkDataFetching=Promise.resolve()}createInitialDataRequest(e){this._dataFetchingBulk=e.reduce((e,t)=>{let{id:r,refresh:n}=t;return n||!this._dataStore.hasDataset(r)?{...e,[r]:new g}:e},{});const t=Object.entries(this._dataFetchingBulk).map(e=>{let[,{promise:t}]=e;return t});this._bulkDataFetching=this._waitForDataFetched(t).then(()=>this._dataFetchingBulk={})}async getInitialData(e){let{datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,length:i,includes:s,uniqueFieldValues:l,fieldIdsToFetch:c}=e;const d=ji.getOffset(f.datasetStore[t]);return this._dataFetchingBulk[t]&&(this._dataFetchingBulk[t].resolve({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,offset:d,length:i,includes:s,uniqueFieldValues:l,fieldIdsToFetch:c}),await this._bulkDataFetching),this._dataStore.getData({datasetId:t,collectionId:r,includes:s})||this.getData({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,offset:d,length:i,includes:s,uniqueFieldValues:l,fieldIdsToFetch:c})}async getSort(e){let{sort:t,collectionId:r}=e;return await wo({datasetConfigSort:t,getSchema:async()=>(await this.waitForSchemasLoaded(),this.getSchema(r))})}async getData(e){const{datasetId:t,collectionId:r,cursorPaging:n,offset:o,filter:a,includes:i,length:s,datasetSize:l,uniqueFieldValues:c,fieldIdsToFetch:d}=e;if($i(f.datasetStore[t]))return this._dataStore.getData({datasetId:t,collectionId:r,includes:i});const u=e=>!this.getUniqueFieldValues({collectionId:r,fieldKey:e}),p=await this.getSort(e),{items:h,totalCount:m,nextCursor:g,uniqueFieldValues:y}=await this._dataFetcher.fetchData({collectionId:r,offset:o,filter:a,sort:p,includes:i,cursor:n?null==l?void 0:l.cursor:void 0,length:s,uniqueFieldValues:c.filter(e=>u(e)),fieldIdsToFetch:d}).catch(zi("Data fetching failed",{datasetConfig:e}));return await this.waitForSchemasLoaded(),this._dataStore.updateCollectionData({collectionId:r,data:{items:h,uniqueFieldValues:y}}),{items:h,datasetSize:{total:m,loaded:((null==l?void 0:l.loaded)||0)+h.length,cursor:g},uniqueFieldValues:y}}async remove(e){let{collectionId:t,recordId:r}=e;return this._dataFetcher.remove({collectionId:t,recordId:r}).catch(zi("Record removing failed",{collectionId:t,recordId:r}))}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return this._dataFetcher.save({collectionId:t,record:r,includeReferences:n}).catch(zi("Record saving failed",{collectionId:t,record:r,includeReferences:n}))}async getSibling(e){return await this._dataFetcher.getSibling(e)}async loadSchemas(e){const t=this._dataStore.getSchemas(),r=e.filter(e=>!t[e]);this._schemasLoading=r.length?this._dataFetcher.fetchSchemas(r).catch(zi("Schema fetching failed",{collectionIds:r})):Promise.resolve({});const n=await this._schemasLoading;return this._dataStore.updateSchemas({...t,...n}),this._dataStore.getSchemas()}setSchemas(e){this._dataStore.updateSchemas(e)}getSchemas(){return this._dataStore.getSchemas()}getRecord(e){let{collectionId:t,recordId:r,includes:n}=e;return this._dataStore.getRecord({collectionId:t,recordId:r,includes:n})}getSchema(e){return this._dataStore.getSchema(e)}hasSchema(e){return Boolean(this.getSchema(e))}getReferencedSchemas(e){const t=this.getSchema(e),r=this._dataStore.getSchemas();return(e=>e?(0,l.flow)(e=>(0,l.pickBy)(e,e=>{let{referencedCollection:t}=e;return Boolean(t)}),e=>(0,l.map)(e,e=>{let{referencedCollection:t}=e;return t}),l.uniq,e=>e.filter(Boolean))(e.fields):[])(t).reduce((e,t)=>({...e,[t]:r[t]}),{})}setCollectionData(e){let{collectionId:t,data:r}=e;r&&this._dataStore.updateCollectionData({collectionId:t,data:r})}setStore(e){e&&this._dataStore.updateStore(e)}setStaticStore(e){const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollectionId:n}=e,o=this._datasetConfigs.find(e=>{let{type:t}=e;return t===gr});if(o){const{datasetId:e}=o,a={[e]:r[0]};this._dataStore.updateStore({recordsByCollectionId:t,recordInfosByDatasetId:a,uniqueFieldValuesByCollectionId:n})}}getStore(){return this._dataStore.getStore()}setUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;return this._dataStore.setUniqueFieldValues({collectionId:t,fieldKey:r,data:n})}getUniqueFieldValues(e){let{collectionId:t,fieldKey:r}=e;return this._dataStore.getUniqueFieldValues({collectionId:t,fieldKey:r})}createSimpleFilter(e,t){return this._dataFetcher.createSimpleFilter(e,t)}setDatasetConfigs(e){this._datasetConfigs=e}getUserFilterInitialData(e){return this._dataStore.getUserFilterInitialData(e)}setUserFilterInitialData(e,t){this._dataStore.setUserFilterInitialData(e,t)}async _fetchInitialData(e){try{const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollection:n}=await this._logger.log(new Le("dataset/fetchPrimaryInitialData",async()=>this._dataFetcher.fetchBulkData(await Promise.all(e.map(async e=>{const t=await this.getSort(e);return!f.platform.settings.env.live||e.sort&&0!==e.sort.length||!t||setTimeout(()=>this._logger.log(new wn({id:900,collectionId:e.collectionId}))),{...e,sort:t}})))));return{recordsByCollectionId:t,recordInfosByDatasetId:r.reduce((t,r,n)=>{let{itemIds:o=[],error:a,nextCursor:i,totalCount:s}=r;const l=e[n];return a&&this._logger.log(Wi("Initial data fetching failed for one of the datasets",{cause:a,extra:{datasetConfig:l}})),f.platform.settings.mode.ssr&&"WD_PERMISSION_DENIED"===(null==a?void 0:a.code)||(t[l.datasetId]={itemIds:o,datasetSize:{total:s,loaded:o.length,cursor:i}}),t},{}),uniqueFieldValuesByCollection:n}}catch(t){throw new n.AppError("Initial data fetching failed",{cause:t,extra:{datasetConfigs:e}})}}async waitForSchemasLoaded(){await this._schemasLoading}async _waitForDataFetched(e){if(e.length){const t=await Promise.all(e),r=await this._fetchInitialData(t);await this.waitForSchemasLoaded(),this._dataStore.updateStore(r)}}}const Wi=(e,t)=>{let{cause:r,...o}=t;return new(n.ServerValidationError.codes.includes(r.code)?n.ServerValidationError:n.ServerError)(e,{...o,cause:r,code:r.code})},zi=(e,t)=>r=>{throw Wi(e,{cause:r,extra:t})},Hi="PRIMARY";var Yi=a(2523),Ji=a.n(Yi);const Ki=function(e,t,r){return void 0===r&&(r=[]),e(t)?[{path:(0,l.clone)(r),filterExpression:t}]:(n=t,Array.isArray(n)||(0,l.isPlainObject)(n)?(0,l.flatMap)(t,(t,n)=>Ki(e,t,r.concat(n))):[]);var n},Qi=e=>t=>t.reduce((e,t)=>{let{path:r,filterExpression:n}=t;return((e,t,r)=>(0,l.set)(e,t,r))(e,r,n)},(0,l.cloneDeep)(e)),Xi=(e,t,r)=>{const n=((e,t)=>Ji()(Ve.Maybe,t.map(t=>{let{path:r,filterExpression:n}=t;return e(n).map(e=>({path:r,filterExpression:e}))})))(t,Ki(e,r));return n.map(Qi(r))},Zi=()=>()=>Ve.Maybe.fromNullable(f.platform.user).map(e=>{let{id:t,loggedIn:r}=e;return r?t:null}),es=e=>t=>{let{filterId:r}=t;return Ve.Maybe.fromNullable(e(r)).chain(e=>{let t,{masterDataset:r,fieldName:n}=e;try{t=r.api.getCurrentItem()}catch{}return Ve.Maybe.fromNullable(t).map(e=>{const t=(0,l.get)(e,n);return void 0===t?null:t})})},ts=e=>ns(e).chain(e=>{let[t,r]=e;return"$not"===t&&(0,l.isArray)(r)?rs({positive:!1,filterExpression:r[0]}):Ve.Maybe.Nothing()}).orElse(()=>rs({positive:!0,filterExpression:e})),rs=e=>{let{positive:t,filterExpression:r}=e;return ns(r).chain(e=>{let[r,n]=e;return ns(n).map(e=>{let[n,o]=e;return{field:r,condition:n,value:o,positive:t}})})},ns=e=>{if(!(0,l.isPlainObject)(e))return Ve.Maybe.Nothing();const t=(0,l.entries)(e)[0];return Ve.Maybe.fromNullable(t)},{stringArray:os,number:as}=fe.FieldType,is=(e,t)=>(0,l.get)(e,t),ss=e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return!(0,l.isEqual)(is(t,n),is(r,n))},ls=e=>null==e||"function"!=typeof e.toString?"":Array.isArray(e)?e.join(", "):e.toString(),cs=e=>/^\d{2}:\d{2}:\d{2}\.\d{3}$/.test(e),ds=e=>e instanceof Date&&!isNaN(e),us=e=>{let{time:t,date:r}=e;const[n,o]=t.split(":");return r.setHours(n),r.setMinutes(o),r.setSeconds(0),r.setMilliseconds(0),r},ps=e=>`${e.toTimeString().split(" ")[0]}.000`,fs=e=>{const t=new Date(e);return ds(t)?t:(()=>{const e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e})()},hs=e=>String(e).padStart(2,"0"),ms=e=>[e.getFullYear(),hs(e.getMonth()+1),hs(e.getDate())].join("-"),gs="datetime",ys=e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;if(o.type===gs){const e=n===fe.FieldType.date,a=((e,t)=>{switch(t){case fe.FieldType.date:return new Date(e);case fe.FieldType.time:return new Date(`1970-01-01T${e}`);default:return e}})(t,n);return ds(a)?r?r.formatDateTime(a,o.params.dateFormat,{timeZone:e?"UTC":void 0}):e&&"string"==typeof t?t:"":t}return t},{mediaGallery:vs,address:_s,date:Es}=fe.FieldType,Is=e=>{let{value:t,fieldType:r,role:n,componentIsInput:o,propPath:a,format:i,utils:{formatter:s}={}}=e;const c=[{converter:e=>{let{formatted:t}=e;return t},condition:Boolean(t&&r===_s&&n!==z)},{converter:ls,condition:Boolean(n===b&&r!==fe.FieldType.color||!o&&r!==fe.FieldType.boolean&&r!==fe.FieldType.color&&![L,x,J,X].includes(n))},{converter:e=>(e=>{let{value:t}=e;const{platform:{utils:{media:r}}}=f,n=r.parseMediaItemUri(t);if(n.error)return t;switch(n.type){case r.types.IMAGE:return r.getScaleToFillImageURL(n.mediaId,n.width,n.height,n.width,n.height,{name:n.title});case r.types.VIDEO:return`https://video.wixstatic.com/video/${n.mediaId}/file`;case r.types.AUDIO:return`https://static.wixstatic.com/mp3/${n.mediaId}`;default:return t}})({value:e}),condition:Boolean("link"===a&&n!==H)},{converter:()=>[],condition:Boolean(!t&&r===vs)},{converter:ps,condition:Boolean(n===Y&&ds(t))},{converter:e=>{const t=new Date(e);return null!==e&&ds(t)?t:""===e||null===e?void 0:e},condition:Boolean(n===B&&r===Es)}].filter(e=>{let{condition:t}=e;return t}).map(e=>{let{converter:t}=e;return t});return(0,l.flow)([e=>(e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;return o?ys({value:t,formatter:r,fieldType:n,format:o}):t})({value:e,formatter:s,fieldType:r,format:i}),...c])(t)};var Ts=function(e){var t=function(e){var t=0;if(void 0===e||0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t*=Math.sign(t),t=Math.sqrt(t),t=Math.floor(1e6*(t-Math.floor(t)))}(e);return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e,r){var n=Math.ceil(t/(r+1))%16;return("x"===e?n:3&n|8).toString(16)})},Ss=function(e){return void 0===e&&(e=""),e?e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-\.]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""};function ws(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Rs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(r),!0).forEach(function(t){Ps(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ws(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ps(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Cs=function(e,t){return e&&"object"==typeof e?"direct"===e.type?Rs(Rs({},e),{},{type:"web"}):{type:"wix",data:e}:"string"==typeof e?{type:"web",url:e,target:t,text:e}:{target:"_blank",type:"none"}},Os=function(e){void 0===e&&(e={});var t={link:e.url};return e.url&&(t.target=e.target),t},bs=function(e){return null!==/^(wix:)?(image|video)(:\/\/)/.exec(e)},Ns=function(e){return bs(e)?e.split("/")[3]:e},Ds=function(e){try{return bs(e)?e.split("/")[4].split("#").slice(0,-1).join("#"):"_.jpg"}catch(e){return"_.jpg"}},As=function(e,t){return"wix:image://v1/"+(e||Ss(t.name))+"/"+Ss(t.fileName||t.name)+"#originWidth="+t.width+"&originHeight="+t.height},Fs=function(e,t){return"wix:video://v1/"+(e||Ss(t.name))+"/"+Ss(t.fileName||t.name)+"#posterUri="+t.posters[0].url+"&posterWidth="+t.width+"&posterHeight="+t.height},xs=function(e){var t={},r=!1;try{var n=/\/\d*_\d*\//.exec(e);if(n&&n[0]&&n[0].length>0){var o=n[0].replace(/\//g,"").split("_").map(function(e){return Number(e)}),a=o[0],i=o[1];a>0&&i>0&&(r=!0,t={originWidth:a,originHeight:i})}}catch(e){r=!1}if(!r)try{var s=/wm_(.*)\//.exec(e);if(s&&s[0]&&s[0].length>0){var l=s[1];l.length>0&&(t.watermark=l)}}catch(e){r=!1}if(!r)try{e.split("#").pop().split("&").map(function(e){return e.split("=")}).forEach(function(e){t[e[0]]=isNaN(Number(e[1]))?String(e[1]):Number(e[1])})}catch(e){r=!1}return t},Ls=function(e,t){return void 0===t&&(t=0),function(e){return!!(e.src||e.type&&e.html)}(e)?function(e,t){var r,n,o,a=xs(e.src);"video"===(null==(r=e.type)?void 0:r.toLowerCase())&&(null!=(n=e.src)&&n.includes("youtube")||null!=(o=e.src)&&o.includes("vimeo"))&&(a.originWidth=1920,a.originHeight=1080),a.width=e.width||a.originWidth||a.originalWidth||a.posterWidth||1,a.height=e.height||a.originHeight||a.originalHeight||a.posterHeight||1;var i,s=e.settings&&e.settings.focalPoint,l=a.watermark,c=e.imageToken||e.token||a.token,d=(e.type||"image").toLowerCase(),u=Rs({itemId:Ss(e.slug)||(Ss(e.title||e.id)||Ts(e.src||e.html||t))+"_"+t,mediaUrl:Ns(e.src),metaData:Object.assign(Rs({type:d,alt:e.alt||"",title:e.title||"",description:e.description||"",name:Ds(e.src),fileName:Ds(e.src),link:Cs(e.link,e.target),width:a.width,height:a.height,sourceName:"private"},"customButtonText"in e&&{customButtonText:e.customButtonText}),s?{focalPoint:s}:{},l?{watermarkStr:l}:{}),orderIndex:t},c&&{token:c});if("text"===d){var p=e.style;u.metaData.height=a.height||500,u.metaData.width=a.width||500*p.layoutRatio,u.metaData.textStyle={width:u.metaData.width,height:u.metaData.height,backgroundColor:p.fillColor},u.metaData.html=u.editorHtml=e.html}if("video"===d){var f={};e.thumbnail&&(f=xs(e.thumbnail));var h=(i=Ns(e.thumbnail),null!==/^.*\.(jpeg|jpg|webp|png|jpe).*$/.exec(i)?Ns(e.thumbnail):a.posterUri);u.metaData.posters=[{url:h,width:f.width||a.width,height:f.height||a.height}],u.isExternal=0===e.src.indexOf("http"),u.isExternal||bs(e.src)?(u.metaData.source=e.src.indexOf("youtube.com")>0?"youtube":e.src.indexOf("vimeo.com")>0?"vimeo":"wix",u.metaData.videoUrl=e.src):u.metaData.qualities=[{width:a.width,height:a.height,quality:a.height+"p",formats:[bs(e.src)?"wix":e.src.split(/#|\?/)[0].split(".").pop().trim()]}]}return u}(e,t):function(e,t){return{itemId:Ts(t+"_"+(e.uri||e.alt||t)),mediaUrl:e.uri||"",metaData:{height:e.height||1,lastModified:Date.now(),link:Cs(e.link,e.target),title:e.title||"",description:e.description||"",alt:e.alt||"",sourceName:"private",tags:[],width:e.width||1},orderIndex:t}}(e,t)},Us=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=!0),t?function(e){void 0===e&&(e={});var t=e.metaData||e.metadata||{},r=Os(t.link)||{},n=Rs({type:t.type||"image",slug:e.itemId},r),o=n.type.toLowerCase();if("text"===o){var a=t.testStyle||{};Object.assign(n,{html:t.html,style:{width:a.width,height:a.height,bgColor:a.backgroundColor}})}else Object.assign(n,{title:t.title,description:t.description,alt:t.alt}),"image"===o?Object.assign(n,Rs(Rs({src:As(e.mediaUrl,t),settings:Object.assign({},t.focalPoint?{focalPoint:t.focalPoint}:{})},"imageToken"in e&&{imageToken:e.imageToken}),"token"in e&&{token:e.token})):"video"===o&&Object.assign(n,{src:Fs(e.mediaUrl,t),thumbnail:t.posters[0].url});return n}(e):(n=(r=e).metaData||r.metadata||{},o=Os(n.link)||{},Rs({uri:r.mediaUrl,description:n.description,alt:n.alt,title:n.title,height:n.height,width:n.width},o));var r,n,o};const{mediaGallery:Ms,documentArray:ks}=fe.FieldType,Bs=e=>{let{value:t,currentValue:r=[],fieldType:n}=e;switch(n){case Ms:return[...r,...t.map(e=>{let{fileUrl:t,url:r}=e;return(e=>{let{uploadedFileUrl:t}=e;const{platform:{utils:{media:r}}}=f,n=r.parseMediaItemUri(t),o=r.createMediaItemUri(n).item,a=Ls({...n,src:o});return Us(a)})({uploadedFileUrl:t||r})})];case ks:return[...r,...t.map(e=>{let{fileUrl:t,url:r}=e;return t||r})];default:return t[0].fileUrl||t[0].url}},{reference:Vs,dateTime:Gs,date:js}=fe.FieldType,$s=e=>{let{value:t,currentValue:r,fieldType:n,fieldName:o,role:a,utils:{referenceFetcher:i}={}}=e;const s=[{converter:e=>i(e,o),condition:Boolean(n===Vs)},{converter:e=>((e,t)=>{const r={},n={};if(cs(e))r.time=e,r.date=new Date;else{const t=fs(e);r.date=t,r.time=ps(t)}return cs(t)?n.time=t:n.date=fs(t),us({...r,...n})})(r,e),condition:Boolean(n===Gs&&[B,Y,V].includes(a))},{converter:ms,condition:Boolean(n===js&&a===B)},{converter:e=>Bs({value:e,currentValue:r,fieldType:n}),condition:Boolean(a===G)}].filter(e=>{let{condition:t}=e;return t}).map(e=>{let{converter:t}=e;return t});return(0,l.flow)(s)(t)},qs=(e,t)=>t().fold(()=>[],e=>Ge(e.fields).filter(t=>e.fields[t].type===fe.FieldType.boolean)).reduce((e,t)=>(void 0===e[t]&&(e[t]=!1),e),{...e}),Ws=e=>{let{expression:t,record:r,prop:o,role:a,componentIsInput:i,logger:s,getSchema:l}=e;try{const{type:e,value:s}=n.dataExpression.evaluate({expression:t,variables:qs(r,l)}),c="$text"===o?"htmlString"===e?"html":"text":o;return{value:Is({value:s,role:a,componentIsInput:i,propPath:c}),propPath:c}}catch(e){return s.log(`Failed to evaluate expression: ${e}`),{propPath:"$text"===o?"text":o,value:"",isError:!0}}},zs=e=>{let{recordStore:t}=e;return t().fold(()=>null,e=>e.isCursorPaging())},Hs=e=>{let{state:t}=e;const{size:r}=Gr(t);return r},Ys=e=>{let{state:t}=e;const{offset:r}=Gr(t);return r},Js=e=>{let{state:t}=e;const{size:r,numPagesToShow:n}=Gr(t);return r*n},Ks=e=>{let{state:t}=e;const r=tn(t);return null==r?null:r},Qs=e=>{let{state:t}=e;if(null==Ks({state:t}))return null;const{features:r}=f;if(r.newCurrentPageIndex){const{size:e,offset:r}=Gr(t);return r/e+1}const{size:n,offset:o,numPagesToShow:a}=Gr(t);return o/n+a},Xs=e=>{let{recordStore:t}=e;return t().fold(()=>null,e=>e.getDatasetSize())},Zs=e=>{let{state:t,recordStore:r}=e;const n=Xs({recordStore:r});return n?Math.ceil(n.total/Hs({state:t})):null},el=e=>{let{recordStore:t}=e;return t().fold(()=>!1,e=>{const t=e.getDatasetSize();return e.isCursorPaging()&&!(null==t||!t.cursor)})},tl=e=>{let{state:t,recordStore:r}=e;if(el({recordStore:r}))return!0;const n=Xs({recordStore:r});if(!n)return!1;return Ys({state:t})+Js({state:t})<n.total},rl=e=>{let{state:t}=e;const r=Ks({state:t});return null!=r&&r>0},nl=e=>{let{state:t,recordStore:r}=e;if(el({recordStore:r}))return!0;const n=Xs({recordStore:r});if(!n)return!1;const o=Ks({state:t});return null!=o&&o<n.total-1},ol=e=>{let{state:t}=e;const{offset:r}=Gr(t);return r>0},al=e=>{let{state:t,recordStore:r}=e;if(el({recordStore:r}))return!0;const n=Xs({recordStore:r});if(!n)return!1;const{offset:o,size:a}=Gr(t);return o+a<n.total},il=async e=>{let{index:t,recordStore:r}=e;await r().fold(()=>{},e=>e.getRecords(t,1))},{Checkbox:sl,Dropdown:ll}=We,cl=e=>e.type===sl?"checked":"value",dl=e=>void 0===e||""===e||Array.isArray(e)&&0===e.length,ul=e=>{let{component:t,connectionConfig:r,currentRecord:o,previousRecord:a,getFieldType:i,getSchema:s,formatter:l,modeIsLivePreview:c,logger:d,recordStore:u,actions:p}=e;const{role:f,isInput:h}=t,{properties:m={},totalCount:g,expressions:y={}}=r,v={};if(g&&!p.isCursorPaging()){var _;const e=null==(_=Xs({recordStore:u}))?void 0:_.total;if("number"==typeof e){const r=Is({value:e,role:f});t.setValue(r,{propPath:g.prop})}}o&&(je(y).forEach(e=>{let[r,{expression:n}]=e;const{value:a,propPath:i,isError:l}=Ws({expression:n,record:o,prop:r,role:f,componentIsInput:h,logger:d,getSchema:s});v[i]=a,c&&(dl(a)||l)||t.setValue(a,{propPath:i})}),je(m).forEach(e=>{let[r,s]=e;try{const{fieldName:e,format:n}=s,d=i(e).getOrElse(void 0),u=Is({value:is(o,e),role:f,componentIsInput:h,fieldType:d,propPath:r,format:n,utils:{formatter:l}});if(v[r]=u,(e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return(e=>!e)(t)||ss({previousRecord:t,currentRecord:r,fieldName:n})})({currentRecord:o,previousRecord:a,fieldName:e})){if(c&&dl(u))return;t.setValue(u,{propPath:r,fieldType:d,binding:s})}}catch(e){d.log(new n.AppError(`Failed setting ${r}`,{cause:e}))}}))},pl=e=>{let{getConnectedComponents:t,getFieldType:r}=e;return e=>{const n=t();if(!n)return Ve.Maybe.Nothing();const o=n.filter(e=>{let{role:t}=e;return t===O});return ts(e).map(e=>{let{field:t,condition:n,value:a,positive:i}=e;const s=((e,t)=>e.map(e=>e===as&&"string"==typeof t&&/^[+-]?(?:\d+\.?\d*|\d*\.?\d+)$/.test(t.trim())?Number(t):e===os&&0===(0,l.get)(t,"length",0)?null:t).getOrElse(t))(r(t),((e,t)=>{const{filterId:r}=e,n=t.find(e=>e.connectionConfig.filters[r]);if(!n)return;const o=cl(n);return n.getValue({propPath:o})})(a,o));if(!s&&0!==s)return{$and:[]};const c={[t]:{[n]:s}};return i?c:{$not:[c]}})}},fl="@resolver",hl="currentUser",ml=e=>(0,l.isPlainObject)(e)&&e[fl]===hl,gl=t.Jr,yl=e=>(0,l.isPlainObject)(e)&&e[fl]===gl,vl="slug",_l=e=>(0,l.isPlainObject)(e)&&e[fl]===vl,El="userInput",Il=e=>(0,l.isPlainObject)(e)&&e[fl]===El,Tl=e=>ml(e)||yl(e)||Rl(e)||_l(e),Sl=e=>{let{role:t,fieldName:r,value:n,condition:o}=e;if(!o)return t===oe?{[r]:{$gte:n[0],$lte:n[1]}}:{[r]:Array.isArray(n)?{$hasSome:n}:n};const{getFilterQuery:a}=(e=>{switch(e){case me:return{getFilterQuery:(e,t)=>({[e]:Array.isArray(t)?{$hasSome:t}:t}),requiredQueryOperators:[fe.AllowedFilterOperator.eq,fe.AllowedFilterOperator.hasSome]};case ge:return{getFilterQuery:(e,t)=>({$not:[{[e]:Array.isArray(t)?{$hasSome:t}:t}]}),requiredQueryOperators:[fe.AllowedFilterOperator.eq,fe.AllowedFilterOperator.hasSome]};case ve:return{getFilterQuery:(e,t)=>({[e]:{$hasSome:Oe(t)}}),requiredQueryOperators:[fe.AllowedFilterOperator.hasSome]};case _e:return{getFilterQuery:(e,t)=>({$not:[{[e]:{$hasSome:Oe(t)}}]}),requiredQueryOperators:[fe.AllowedFilterOperator.hasSome]};case ye:return{getFilterQuery:(e,t)=>({[e]:{$hasAll:Oe(t)}}),requiredQueryOperators:[fe.AllowedFilterOperator.hasAll]};case Ee:return{getFilterQuery:(e,t)=>({[e]:{$gte:t}}),requiredQueryOperators:[fe.AllowedFilterOperator.gte]};case Ie:return{getFilterQuery:(e,t)=>({[e]:{$lte:t}}),requiredQueryOperators:[fe.AllowedFilterOperator.lte]};case Te:return{getFilterQuery:(e,t)=>({[e]:{$gte:t[0],$lte:t[1]}}),requiredQueryOperators:[fe.AllowedFilterOperator.gte,fe.AllowedFilterOperator.lte]};case Se:return{getFilterQuery:(e,t)=>({$not:[{[e]:{$gte:t[0],$lte:t[1]}}]}),requiredQueryOperators:[fe.AllowedFilterOperator.gte,fe.AllowedFilterOperator.lte]};default:return{getFilterQuery:(e,t)=>({[e]:Array.isArray(t)?{$hasSome:t}:t}),requiredQueryOperators:[fe.AllowedFilterOperator.eq,fe.AllowedFilterOperator.hasSome]}}})(o);return a(r,n)},wl=e=>{let{valueResolvers:t,getConnectedComponents:r,getFieldType:n,getUserFilterInitialData:o,wasSetFilterCalled:a}=e;return e=>{const i=Xi(Tl,e=>ml(e)?t.currentUser():yl(e)?t.dataBinding(e):Rl(e)?t.userInput(e):_l(e)?t.slug(e):void 0,e).map(e=>{if(a())return e;const t=r().filter(e=>{let{role:t,connectionConfig:r}=e;return he.includes(t)&&r}).map(e=>{const{userInputFilter:t}=e.connectionConfig,{prop:r,fieldName:a,condition:i}=t,s=e.getValue({propPath:r}),c=Bn(a)?bn(a):a;if([be,"",!1].includes(s)||(0,l.isEqual)(s,[])||e.role===oe&&(0,l.isEqual)(s,e.getBounds()))return null;const d=(e=>{let{value:t,fieldType:r,fieldName:n,getUserFilterInitialData:o}=e;switch(r){case fe.FieldType.reference:{var a;const e=null==(a=o())?void 0:a.find(e=>e.fieldName===n&&Ne.includes(e.role));if(!e)return null;const{referencedItemIdsByOption:r}=e;return(0,l.isArray)(t)?t.flatMap(e=>r[e]):r[t]}case fe.FieldType.number:return Array.isArray(t)?t.map(Number):Number(t);default:return t}})({value:s,fieldType:n(c).getOrElse(null),fieldName:a,getUserFilterInitialData:o});return null===d?null:Sl({role:e.role,fieldName:c,value:d,condition:i})}).filter(Boolean);return 0===t.length?e:{$and:[e].filter(Boolean).concat(t)}});return i}},Rl=e=>ts(e).map(e=>{let{value:t}=e;return Il(t)}).getOrElse(!1),Pl=e=>Ki(yl,e),Cl=e=>!(0,l.isEmpty)(Ki(Il,e)),Ol=e=>Cl(e)||(e=>!(0,l.isEmpty)(Ki(ml,e)))(e)||(e=>Pl(e).length>0)(e),{Cm:bl}=e,Nl=(e,t,r,n)=>{const{readWriteType:o,filter:a,collectionName:i}=e,s=o===bl,l=r.some(e=>{let{role:t}=e;return t===C}),c=t===gr,d=ji.isDeferred(n)&&!(l||c||s),u=a&&Ol(a),p=(e=>{let{collectionId:t,datasetHasDynamicFilter:r,datasetIsDeferred:n,datasetIsRouter:o,datasetIsWriteOnly:a,dataset:i}=e;return t?r||n||o||a||$i(i)?"REGULAR":Hi:"UNCONFIGURED"})({collectionId:i,datasetHasDynamicFilter:u,datasetIsDeferred:d,datasetIsRouter:c,datasetIsWriteOnly:s,dataset:n});return{sequenceType:p,datasetIsWriteOnly:s,datasetIsMaster:l,datasetIsRouter:c,datasetIsDeferred:d,datasetHasDynamicFilter:u}},Dl={regular:mr,router:gr,widget:yr},Al={read:"READ",write:"WRITE","read-write":"READ_WRITE"},Fl=e=>{const t=(0,l.values)({DATASET:mr,ROUTER_DATASET:gr,WIDGET_DATASET:yr});return e.map(e=>{const{id:r,type:o,collectionId:a,readWriteType:i,deferred:s,private:l,routerConfig:c,pagination:{pageSize:d,type:u},rendering:{connections:p,nestedFieldIds:h,componentIdsToRender:m},dataLoading:{filter:g,sort:y,dataIsInvalidated:v,referenceFieldIdsToFetch:_}}=e.config,E=Dl[o];t.includes(E)||f.logger.log(new n.AppError(`type of controller MUST be one of ${t} but is ${E}`));const I={collectionName:a,filter:g,sort:y,includes:_,nested:h,pageSize:d,readWriteType:Al[i],cursor:"cursor"===u,deferred:s,private:l,uniqueFieldValues:[]};return{id:r,compId:r,type:E,livePreviewOptions:{shouldFetchData:v,compsIdsToReset:m},connections:p,dynamicPageData:c?{dynamicUrl:c.dynamicUrl,userDefinedFilter:c.userDefinedFilter,seoV2:c.seoEnabled}:void 0,config:{dataset:I,datasetStaticConfig:Nl(I,E,p,e),...e.config},data:e.data}})};var xl=a(6492);const Ll=Symbol("isPristine"),Ul=e=>e._id,Ml=e=>({...e,[Ll]:!1}),kl=(e,t)=>({...e,_id:t||(0,xl.v4)(),[Ll]:!0}),Bl=(e,t)=>e&&t&&e._id===t._id,Vl=e=>(0,l.omit)(e,[Ll]),Gl=e=>{let{record:t,draft:r,includes:n,nestedFieldKeys:o,fieldKey:a}=e;return(e=>{let{includes:t,nestedFieldKeys:r,fieldKey:n}=e;const o=null==t?void 0:t.includes(n),a=r.includes(n);return o||a})({includes:n,nestedFieldKeys:o,fieldKey:a})&&(e=>{let{record:t,draft:r,fieldKey:n}=e;return(0,l.isPlainObject)(t[n])&&(0,l.isPlainObject)(r[n])})({record:t,draft:r,fieldKey:a})},jl={chain:e=>t=>e.matchWith({Empty:()=>e,Results:e=>{let{items:r,datasetSize:n,offset:o}=e;return t({items:r,datasetSize:n,offset:o})}}),map:e=>t=>e.matchWith({Empty:()=>e,Results:e=>{let{items:r,datasetSize:n,offset:o}=e;const{items:a=r,datasetSize:i=n,offset:s=o}=t({items:r,datasetSize:n,offset:o});return $l.Results(a,i,s)}}),filter:e=>t=>e.matchWith({Empty:()=>e,Results:r=>{let{items:n,datasetSize:o,offset:a}=r;return t({items:n,datasetSize:o,offset:a})?e:$l.Empty()}}),orElse:e=>t=>e.matchWith({Empty:()=>t(),Results:()=>e}),get:e=>()=>e.matchWith({Empty:()=>({items:[],datasetSize:{total:0,loaded:0},offset:0}),Results:e=>e}),of:()=>ql},$l=(0,Ve.union)("QueryResults",{Empty:()=>({}),Results:function(e,t,r){return void 0===r&&(r=0),{items:e,datasetSize:t,offset:r}}},jl);function ql(e){let{items:t,datasetSize:r,offset:n}=e;return r&&Math.max(r.total,r.loaded)>0&&Array.isArray(t)?$l.Results(t,r,n):$l.Empty()}const Wl={Empty:$l.Empty,Results:$l.Results,fromWixDataQueryResults:function(e,t){return e?this.of({items:e.items,datasetSize:e.datasetSize,offset:t}):$l.Empty()},of:ql},zl=e=>t=>({...t,...e}),Hl=(e,t)=>r=>t(e(r))(r),Yl=(e,t,r)=>{const n=new Map;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];const s=t(a),l=n.get(s);if(l&&r(a,l.args))return l.result;const c=e.apply(this,a);return n.set(s,{args:a,result:c}),c}},Jl=e=>zl({records:e}),Kl=e=>t=>{var r,n,o;return{...t,datasetSize:{cursor:null==(r=t.datasetSize)?void 0:r.cursor,total:((null==(n=t.datasetSize)?void 0:n.total)||0)+e,loaded:((null==(o=t.datasetSize)?void 0:o.loaded)||0)+e}}},Ql=e=>{let{cursor:t,loaded:r,total:n}=e;return e=>({...e,datasetSize:{cursor:t,loaded:r+tc(e),total:n+tc(e)}})},Xl=e=>({...e,numSeedRecords:e.records.length}),Zl=(e,t)=>e.matchWith({Empty:()=>Ql({total:0,loaded:0}),Results:e=>{let{items:r,datasetSize:n}=e;return(0,l.flow)(Jl(new Array(t).concat(r.map(e=>Ul(e)))),Ql(n),Xl)}}),ec=e=>t=>({...t,newRecordMarkers:e(t.newRecordMarkers)}),tc=(e,t)=>e.newRecordMarkers.filter(e=>null==t||e<=t).length,rc=function(e,t,r){let{overwrite:n=!0,fixIndex:o=!0}=void 0===r?{}:r;return Hl(r=>{const a=e+(o?tc(r,e):0),i=Math.max(0,a-r.records.length),s=a+(n?t.length:0);return r.records.slice(0,a).concat(new Array(i)).concat(t.map(e=>Ul(e))).concat(r.records.slice(s))},Jl)},nc=(e,t,r)=>n=>Object.assign({},e(n),...r.map(e=>({[t(e)]:e}))),oc=(e,t,r)=>n=>({...e(n),[t]:r(e(n)[t])}),ac=(e,t)=>r=>Object.assign({},...Object.keys(e(r)).filter(e=>e!==t).map(t=>({[t]:e(r)[t]}))),ic=e=>zl({records:e}),sc=e=>zl({drafts:e}),lc=(0,l.curry)((e,t,r)=>zl({scopes:{...r.scopes,[e]:t}})(r)),cc=e=>t=>t.scopes[e],dc=e=>Hl(nc(e=>{let{records:t}=e;return t},Ul,e),ic),uc=e=>Hl(nc(e=>{let{drafts:t}=e;return t},Ul,[e]),sc),pc=e=>Hl(ac(e=>{let{drafts:t}=e;return t},Ul(e)),sc),fc=()=>sc({}),hc=e=>e.matchWith({Empty:()=>e=>e,Results:e=>{let{items:t}=e;return t.length>0?dc(t):e=>e}}),mc=(e,t)=>Hl(oc(e=>{let{drafts:t}=e;return t},e,(0,l.flow)(Ml,(e=>t=>Object.entries(e).reduce((e,t)=>{let[r,n]=t;return(0,l.set)(e,r,n)},(0,l.cloneDeep)(t)))(t))),sc),gc=(e,t,r,n)=>{const o=t.records[e],a=t.drafts[e],i=(0,l.isPlainObject)(o),s=(0,l.isPlainObject)(a);return i&&s?(e=>{let{record:t,draft:{_id:r,...n},includes:o,nestedFieldKeys:a}=e;const i=Object.keys(n).filter(e=>Gl({record:t,draft:n,includes:o,nestedFieldKeys:a,fieldKey:e})),s={...t,...n};return i.reduce((e,r)=>({...e,[r]:(0,l.merge)({},t[r],n[r])}),s)})({record:o,draft:a,includes:r,nestedFieldKeys:n}):i?{...o}:s?{...a}:null},yc=(0,l.curry)((e,t,r)=>Object.keys(r.scopes).filter(e=>t(r.scopes[e],e)).map(t=>e(r.scopes[t],t))),vc=(0,l.curry)(function(e,t,r,n,o,a,i){void 0===i&&(i=!1);const{records:s,datasetSize:l}=cc(e)(a),c=r-t,d=s.slice(t,r).reduce((e,t)=>{const r=gc(t,a,n,o);return null!=r?e.concat(Vl(r)):e},[]);return Wl.of({items:d,datasetSize:l,offset:t}).filter(function(e){let{items:t}=e;return i||t.length>=c})}),_c=(0,l.curry)((e,t)=>Hl((0,l.flow)(cc(e),t),lc(e))),Ec=(0,l.curry)((e,t)=>zl({[e]:t})),Ic=e=>t=>t[e],Tc=(0,l.curry)((e,t)=>Hl((0,l.flow)(Ic(e),t),Ec(e))),Sc=e=>e===se,wc=e=>{let[{datasetId:t}]=e;return t},Rc=(e,t)=>{let[r]=e,[n]=t;return(0,l.every)(r,(e,t)=>{return"filter"===t?(r=e,o=n[t],JSON.stringify(r)===JSON.stringify(o)):e===n[t];var r,o})},Pc=e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:a,includes:i,nestedFieldKeys:s,uniqueFieldValues:c,readWriteType:d,cursorPagingRequired:u,statusForEditor:p}=e;const{breadcrumbReporting:h}=f,m=()=>r[t],g=(e,n)=>{r[t]=e,n()};((0,l.isEmpty)(m())||n||Sc(d))&&g((e=>({[e]:{records:{},drafts:{},scopes:{}}}))(a),()=>{});const y=[],v=Yl(e=>{let{pageSize:t,sort:r,filter:n,datasetId:v,referencedCollectionName:_,fixedRecordId:E}=e;const I=null!=_?_:a,T=JSON.stringify({filter:n,sort:r}),S=Ic(I),w=Tc(I),R=(0,l.flow)(S,cc(T)),P=_c(T),C=()=>o.getSchema(I),O=()=>p.update(e=>{var t;const r=R(m());"number"==typeof(null==r||null==(t=r.datasetSize)?void 0:t.total)&&(e.datasetSize[v]=r.datasetSize.total)}),b=e=>g(e,O),N=e=>e-e%t,D=(0,l.memoize)(e=>{let{offset:t,length:a,datasetSize:s}=e;return o.getData({datasetId:v,length:a,collectionId:I,cursorPaging:V.isCursorPaging(),offset:t,filter:n,sort:r,includes:null!=_?void 0:i,uniqueFieldValues:c,datasetSize:s}).then(e=>({items:e.items,datasetSize:e.datasetSize,offset:t}))},e=>{let{offset:t,length:r,datasetSize:n}=e;return[t,r,null==n?void 0:n.cursor].join("-")}),A=e=>V.isCursorPaging()?(async e=>{const t=[];let{datasetSize:r}=R(m());for(const{offset:n,length:o}of e){const e=await D({offset:n,length:o,datasetSize:r});if(t.push(e),r=e.datasetSize,!r.cursor)break}return t})(e):Promise.all(e.map(e=>{let{offset:t,length:r}=e;return D({offset:t,length:r})})),F=(e,r,n)=>{const o=V.isCursorPaging()?0:N(r),a=(i=r,s=n,Math.ceil((N(i)+(s-N(i)))/t)*t);var i,s;const c=kn(C())||fe.DefaultMaxPageSize[V.getPaging()],d=((e,t,r)=>{const n=e.records.slice(t,r),o=n.findIndex(u),a=((e,t)=>{if(t.length>0)for(let r=t.length-1;r>=0;r-=1)if(e(t[r]))return r;return-1})(u,n),i=p(o,t),s=p(a,r),l=tc(e,i),c=i-l,d=s-l-c;return 0===d?Ve.Maybe.Nothing():Ve.Maybe.Just({offset:c,length:d});function u(e){return"string"!=typeof e}function p(t,r){return-1===t?Math.max(e.records.length,r):o+r}})(e,o,a),u=d.map(e=>{let{offset:t,length:r}=e;return r<=c?[{offset:t,length:r}]:(0,l.flatten)((0,l.times)(Math.ceil(r/c),e=>[{offset:t+e*c,length:Math.min(c,r-e*c)}]))}).getOrElse([]);return A(u)},x=(e,t,r)=>Ji()(Ve.Result,y.map(n=>Ve.Result.try(()=>n(null!=e?Vl(e):null,null!=t?Vl(t):null,r)))),L=function(e,t,r){const n=R(m()).records[r],o=gc(n,S(m()),i,s);if(null==o)return t();{const t=function(){b((0,l.flow)(...arguments)(m()))},u=e=>{const t=gc(n,S(m()),i,s);return(0,l.isEqual)(o,t)?Ve.Result.Ok([]):x(o,t,e)};for(var a=arguments.length,c=new Array(a>3?a-3:0),d=3;d<a;d++)c[d-3]=arguments[d];return e({update:t,notifyIfChanged:u},o,r,...c)}},U=(e,t)=>function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return L(e,t,r,...o)},M=(e,t)=>async function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return L(e,t,r,...o)},k=(e,t)=>h(t,Ue.with({category:"recordStore",message:e,data:{datasetId:v,scope:T}})),B=e=>{return e&&(t=Ul(e),!S(m()).records[t]);var t},V={getRecords:k("getRecords",async(e,t)=>{const{datasetSize:r}=R(m()),n=(e=>{let{from:t,length:r,datasetSize:n,cursorPaging:o}=e;if(!n)return t+r;const{total:a,loaded:i,cursor:s}=n,l=o?s?1/0:i:a;return Math.min(t+r,l)})({from:e,length:t,datasetSize:r,cursorPaging:V.isCursorPaging()}),o=vc(T,e,n,i,s),a=Sc(d)||!r||(e=>{let{loaded:t,total:r,cursor:n}=e;return!t&&!r&&!n})(r);return o(S(m()),a).orElse(async()=>{const t=await F(R(m()),e,n),r=w((0,l.flow)(...t.map(e=>{let{items:t,datasetSize:r,offset:n}=e;return Wl.fromWixDataQueryResults({items:t,datasetSize:r},n)}).map(e=>(0,l.flow)(hc(e),P(e.matchWith({Empty:()=>Ql({total:0,loaded:0}),Results:e=>{let{items:t,datasetSize:r,offset:n}=e;return(0,l.flow)(Ql(r),t.length>0?rc(n,t):e=>e)}})))))),a=m();var i,s;return b(r(m())),i=S(a),s=S(m()),Object.keys(i.records).filter(e=>(0,l.isPlainObject)(s.records[e])&&s.records[e]._updatedDate>i.records[e]._updatedDate).forEach(e=>x(i.records[e],s.records[e])),o(S(m()),!0)})}),getAllScopeRecordsSync:k("getAllScopeRecordsSync",()=>{const e=R(m());return vc(T,0,e.records.length,i,s)(S(m()),!0)}),getRecordsLimitedByMaxPageSize:(e,t)=>{const r=Math.min(t,kn(C())||t);return V.getRecords(e,r)},seed:k("seed",()=>{if(0===R(m()).numSeedRecords){const e=ji.getOffset(f.datasetStore[v]),a=ji.getFieldIdsToFetch(f.datasetStore[v]);return(E?o.getData({datasetId:v,length:t,collectionId:I,cursorPaging:void 0,offset:e,filter:n,sort:r,includes:null!=_?void 0:i,uniqueFieldValues:c,fieldIdsToFetch:a}):o.getInitialData({datasetId:v,collectionId:I,filter:n,sort:r,offset:e,includes:i,length:t,uniqueFieldValues:c,fieldIdsToFetch:a})).then(t=>{const r=Wl.fromWixDataQueryResults(t,0),n=w((0,l.flow)(hc(r),P(Zl(r,e))));b(n(m()))})}return Promise.resolve()}),getTheStore:m,getPaging:()=>(({schema:e,cursorPagingPreferred:t})=>{const r=e?.pagingMode?.includes(fe.PagingMode.Offset),n=e?.pagingMode?.includes(fe.PagingMode.Cursor);return 1===e?.pagingMode?.length&&n||r&&n&&t?fe.PagingMode.Cursor:fe.PagingMode.Offset})({schema:C(),cursorPagingPreferred:u}),isCursorPaging:()=>V.getPaging()===fe.PagingMode.Cursor,getSeedRecords:k("getSeedRecords",()=>vc(T,0,R(m()).numSeedRecords,i,s,S(m()),!0)),getDatasetSize:k("getDatasetSize",()=>R(m()).datasetSize),getRecordById:k("getRecordById",e=>Ve.Maybe.fromNullable(S(m()).records[e])),removeRecord:k("removeRecord",M(async(e,t)=>{let{update:r,notifyIfChanged:n}=e;const a=Ul(t);!B(t)&&a&&await o.remove({collectionId:I,recordId:a}),D.cache.clear();const i=yc((e,t)=>{return _c(t,(0,l.flow)((n=a,Hl(e=>e.records.filter(e=>e!==n),Jl)),Kl(-1),ec((r=((e,t)=>t.records.indexOf(e))(a,e),e=>e.filter(e=>e!==r)))));var r,n},(s=a,e=>e.records.includes(s)),S(m()));var s;return r(w((0,l.flow)((0,l.flow)(pc(t),(e=>Hl(ac(e=>{let{records:t}=e;return t},e),ic))(a)),...i))),n()},()=>Promise.resolve(Ve.Result.Error("cannot remove record: index not found")))),reset:k("reset",()=>{D.cache.clear(),b(w((0,l.flow)(lc(T,{records:[],numSeedRecords:0,newRecordMarkers:[]}),fc()))(m()))}),newRecord:k("newRecord",(e,t)=>{const r=kl(t),n=w((0,l.flow)(uc(r),P((0,l.flow)(Kl(1),zl({newRecordMarkers:[e]}),rc(e,[r],{overwrite:!1,fixIndex:!1})))));return b(n(m())),x(null,r),Vl(r)}),saveRecord:k("saveRecord",M(async(e,t,r)=>{let{update:n,notifyIfChanged:a}=e;const i=await o.save({collectionId:I,record:Vl(t),includeReferences:!0});return n(w((0,l.flow)((e=>dc([e]))(i),pc(t),P((0,l.flow)(((e,t)=>rc(e,[t],{fixIndex:!1}))(r,i),ec(e=>e.filter(e=>e!==r))))))),a(),Vl(i)},()=>Promise.reject(new Error("cannot save record: index not found")))),setFieldsValues:k("setFieldsValues",U((e,t,r,n,o)=>{let{update:a,notifyIfChanged:i}=e;return Object.keys(n).length&&a(w(mc(Ul(t),n))),i(o)},()=>Ve.Result.Error("cannot update field values: index not found"))),isPristine:k("isPristine",U((e,t)=>(e=>"boolean"!=typeof e[Ll]||e[Ll])(t),()=>!0)),hasDraft:k("hasDraft",U((e,t)=>(e=>"boolean"==typeof e[Ll])(t),()=>!1)),isNewRecord:k("isNewRecord",U((e,t)=>B(t),()=>!0)),clearDrafts:k("clearDrafts",()=>{b(w(fc())(m()))}),resetDraft:k("resetDraft",U((e,t,r,n)=>{let{update:o,notifyIfChanged:a}=e;return o(w(B(t)?((e,t)=>Hl(oc(e=>{let{drafts:t}=e;return t},Ul(e),e=>kl(t,e._id)),sc))(t,n):pc(t))),a()},()=>Ve.Result.Error("cannot reset draft: index not found"))),hasSeedData:k("hasSeedData",()=>R(m()).numSeedRecords>0),getUniqueFieldValues:k("getUniqueFieldValues",e=>o.getUniqueFieldValues({collectionId:I,fieldKey:e}))};if(S(m())||b(Ec(I,{records:{},drafts:{},scopes:{}})(m())),!S(m()).scopes[T]){const e=[];if(E){const t=o.getRecord({collectionId:I,recordId:E,includes:i})||gc(E,S(m()),i,s),r=t?[t]:[],n=r.length>0?Wl.of({items:r,offset:0,datasetSize:{loaded:r.length,total:r.length}}):Wl.Empty(),a=n.matchWith({Empty:Ve.Maybe.Nothing,Results:(0,l.flow)(Wl.of,Ve.Maybe.Just)});(0,l.some)(r,B)&&e.push(hc(n)),a.fold(()=>{e.push(lc(T,{records:[],numSeedRecords:0,newRecordMarkers:[]}))},t=>{e.push(lc(T,Zl(t,0)({records:[],numSeedRecords:0,newRecordMarkers:[]})))})}else e.push(lc(T,{records:[],numSeedRecords:0,newRecordMarkers:[]}));b(w((0,l.flow)(...e))(m()))}return V.externalApi={getRecords:async(e,t)=>(await V.getRecords(e,t)).map(e=>{let{items:t,...r}=e;return{items:(0,l.cloneDeep)(t),...r}}),getSeedRecords:()=>V.getSeedRecords().map(e=>{let{items:t,...r}=e;return{items:(0,l.cloneDeep)(t),...r}}),getRecordsLimitedByMaxPageSize:async(e,t)=>(await V.getRecordsLimitedByMaxPageSize(e,t)).map(e=>{let{items:t,...r}=e;return{items:(0,l.cloneDeep)(t),...r}})},V},wc,Rc);var _;return v.onChange=(_=y,e=>(_.push(e),()=>{const t=_.indexOf(e);t>=0&&_.splice(t,1)})),v},Cc=e=>{const t={};return{setController:(r,n)=>{let{repeaterId:o,itemId:a}=r;e.log(new Ue({category:"scopeStore",message:"adding scope",data:{componentId:o,itemId:a}})),t[o]=t[o]||{},t[o][a]=n},getController:e=>{let{repeaterId:r,itemId:n}=e;const o=t[r];return o&&o[n]},removeController:r=>{let{repeaterId:n,itemId:o}=r;e.log(new Ue({category:"scopeStore",message:"removing scope",data:{componentId:n,itemId:o}}));const a=t[n];(0,l.get)(a,o)&&(a[o].dispose(),(0,l.unset)(a,o))},getAll:()=>Object.values(t).reduce((e,t)=>e.concat(Object.values(t)),[])}},Oc=(0,Ve.union)("GoToIndexResult",{Record:(e,t)=>({index:e,record:t}),InvalidIndex:()=>({}),NoRecord:()=>({})}),bc=function(e,t){return void 0===t&&(t=!1),{type:At,index:e,suppressRefreshView:t}},Nc=(e,t)=>({type:Ct,fieldsToUpdate:e,updateSource:t}),Dc=e=>({type:qt,atIndex:e}),Ac=()=>({type:zt}),Fc=async(e,t,r,n)=>{const o=await e(n).fold(()=>Wl.Empty(),e=>e.externalApi.getRecords(t,r));return o.get()},xc=(e,t)=>Fc(e,Ys({state:t}),Js({state:t})),Lc=e=>({type:Ht,userFilterInitialData:e}),Uc={doFetch:Fc,fetchCurrentPage:xc,getAllScopeRecordsSync:e=>((e,t)=>e(t).fold(()=>Wl.Empty(),e=>e.getAllScopeRecordsSync()).get())(e),flushDraft:()=>({type:Vt}),goToRecordByIndexResult:(e,t)=>({type:Ut,error:e,payload:t}),incrementNumOfPagesToShow:()=>({type:Nt}),initWriteOnly:e=>e?bc(0):Dc(0),loadPage:e=>({type:Lt,pageNumber:e}),newRecord:Dc,newRecordResult:(e,t)=>({type:Wt,error:e,payload:t}),nextPage:()=>({type:Ft}),previousPage:()=>({type:xt}),reInitWriteOnly:()=>Dc(0),refresh:Ac,refreshCurrentRecord:()=>({type:Ot}),refreshCurrentView:()=>({type:bt}),refreshResult:(e,t)=>({type:Ut,error:e,payload:t}),remove:()=>({type:jt}),removeCurrentRecordResult:(e,t)=>({type:$t,error:e,payload:t}),revert:()=>({type:kt}),revertResult:(e,t)=>({type:Bt,error:e,payload:t}),saveRecordResult:(e,t)=>({type:Gt,error:e,payload:t}),setCurrentIndex:bc,setCurrentRecord:(e,t,r)=>({type:Pt,record:e,recordIndex:t,updateSource:r}),setDefaultRecord:e=>({type:Dt,record:e}),updateCurrentViewResult:(e,t)=>({type:Mt,error:e,payload:t}),updateFields:Nc,GoToIndexResult:Oc},Mc=e=>({type:Nr,connections:e}),kc=e=>({type:Xt,filter:e}),Bc=e=>({type:Zt,sort:e}),Vc=e=>({type:er,isDatasetReady:e});var Gc=a(4058),jc=a.n(Gc);const $c=(e,t)=>{const{middleware:r,subscribe:n,onIdle:o}=jc().createMiddleware(),a=Tt(Mr,void 0,wt(r,((e,t)=>()=>r=>n=>(e.log(new Ue({category:"redux",message:`${n.type} (dataset: ${t})`,data:(0,l.omit)(n,"type","record")})),r(n)))(e,t)));return{store:a,subscribe:n,onIdle:o}},{Pz:qc,Cm:Wc,t8:zc}=e,Hc={[qc]:"read-only",[Wc]:"write-only",[zc]:"read-write"},Yc=(e,t)=>{if(e)throw new n.DatasetError(`Operation (${t}) not allowed on a dataset with non-offset paging mode`,{code:"OPERATION_NOT_ALLOWED"})},Jc=(e,t)=>{if(r=e(),hr.isDuringSave(r.records))throw new n.DatasetError(`Operation (${t}) not allowed during save`,{code:"OPERATION_NOT_ALLOWED"});var r},Kc=function(e,t,r,o,a){void 0===t&&(t=""),void 0===a&&(a=!0),((e,t,r)=>{if(!$r(e()))throw new n.DatasetError(r===gr?`Operation (${t}) is not allowed because the field used to build this page's URL is empty`:`Operation (${t}) not allowed on an unconfigured dataset`,{code:"OPERATION_NOT_ALLOWED"})})(e,t,o),function(e,t,r){void 0===r&&(r=[]);const o=jr(e());if(!(0,l.includes)(r,o))throw new n.DatasetError(`Operation (${t}) not allowed on ${Hc[o]} dataset`,{code:"OPERATION_NOT_ALLOWED"})}(e,t,r),a||Jc(e,t)},Qc=(e,t)=>{if(!(0,l.isNumber)(t))throw new n.DatasetError(`Parameter (${e}) must be a number`,{code:"DS_INVALID_ARGUMENT"})},Xc=(e,t)=>{if(!(0,l.isInteger)(t)||t<1)throw new n.DatasetError(`Parameter (${e}) must be a positive integer number`,{code:"DS_INVALID_ARGUMENT"})},Zc=(e,t)=>{if(!(0,l.isFunction)(t))throw new n.DatasetError(`The callback passed to (${e}) must be a function`,{code:"DS_INVALID_ARGUMENT"})},ed=(e,t)=>{if(!qr(e()))throw new n.DatasetError(`The dataset didn't load yet. You need to call ${t} inside the onReady for the dataset.`,{code:"DS_NOT_LOADED"})},td=e=>{if(null==Ks({state:e()}))throw new n.DatasetError("There is no current item",{code:"DS_NO_CURRENT_ITEM"})},rd=(e,t)=>{if(e)throw new n.DatasetError(`The "${t}" function cannot be called on the dataset because the dataset was selected using a repeated item scope selector.\nRead more about repeated item scope selectors: http://wix.to/94BuAAs/$w.Repeater.html#repeated-item-scope`,{code:"OPERATION_NOT_ALLOWED"})},nd=(e,t)=>{if(e===yr)throw new n.DatasetError(`"${t}" can't be called on a Property Dataset.`,{code:"OPERATION_NOT_ALLOWED"})},od=e=>{let{datasetType:t,siblingDynamicPageUrlGetter:r}=e;const o={getNextDynamicPage:async()=>null!=r?r.getNextDynamicPageUrl():null,getPreviousDynamicPage:async()=>r?r.getPreviousDynamicPageUrl():null};return(0,l.mapValues)(o,(e,r)=>function(){return((e,t)=>{if(e!==gr)throw new n.DatasetError(`"${t}" function on the dataset is not allowed. "${t}" can only be called on a Dynamic Page Dataset.`,{code:"OPERATION_NOT_ALLOWED"})})(t,r),e(...arguments)})},{Pz:ad,Cm:id,t8:sd}=e,ld=e=>{let{store:{dispatch:t,getState:r},recordStore:o,dataProvider:a,eventListeners:{fireEvent:i,register:s},controllerStore:c,datasetId:d,datasetType:u,collectionId:p,isFixedItem:h,siblingDynamicPageUrlGetter:m,onIdle:g,dispatcher:v,onReadyAsync:_,resolveDataSourceDependency:E}=e;const{logger:I,errorReporting:T,breadcrumbReporting:S,verboseReporting:w}=f,R=()=>{f.platform.settings.env.live&&I.log(new wn({id:341,collectionId:p,datasetId:d,datasetType:u}))},P=async function(){try{await t(Uc.flushDraft());const n=(e=r(),hr.selectLastSavedRecord(e.records)||en(r()));return(0,l.cloneDeep)(n)}catch(e){throw v.dispatch("datasetSaveError"),e}var e},C=async function(e,a){void 0===e&&(e=(e=>{let{state:t}=e;const r=Ks({state:t});return null==r?0:r+1})({state:r()})),nd(u,a),ed(r,a),Kc(r,a,[id,sd],u,!1),Qc("atIndex",e),await P(),zs({recordStore:o})&&await il({index:e,recordStore:o}),(e=>{let{index:t,datasetSize:{total:r,loaded:o}}=e;if(t<0||t>Math.max(r,o))throw new n.DatasetError("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"})})({index:e,datasetSize:Xs({recordStore:o})}),await t(Uc.newRecord(e))};return e=>{const f=e?(e,t)=>T(e,n.UserError.withMessage(`An error occurred in one of ${t} callbacks`)):l.identity,v={async isIdle(){await new Promise(e=>{const t=g(()=>{t(),e()})})},onBeforeSave:e=>(nd(u,"onBeforeSave"),Zc("onBeforeSave",e),Kc(r,"onBeforeSave",[id,sd],u,!1),s("beforeSave",f(e,"beforeSave"))),onAfterSave:e=>(nd(u,"onAfterSave"),Zc("onAfterSave",e),Kc(r,"onAfterSave",[id,sd],u,!1),s("afterSave",f(e,"afterSave"))),async save(){nd(u,"save"),Kc(r,"save",[id,sd],u,!1);const e=await P();return zr(r())&&await t(Uc.reInitWriteOnly()),e},async getItems(e,t){nd(u,"getItems"),Kc(r,"getItems",[ad,sd],u,!1),Qc("fromIndex",e),Qc("numberOfItems",t);const{items:n,offset:a,datasetSize:i}=await Uc.doFetch(o,e,t);return{items:n,totalCount:zs({recordStore:o})?void 0:i.total,offset:a}},getTotalCount:()=>(Kc(r,"getTotalCount",[ad,sd],u,!1),qr(r())?(Yc(zs({recordStore:o}),"getTotalCount"),Xs({recordStore:o}).total):null),getCurrentItem:()=>{Kc(r,"getCurrentItem",[ad,id,sd],u);const e=en(r());if(!e)return null;const t=(0,l.cloneDeep)(e);if("widget"===u){const{_id:e,...r}=t;return r}return t},getCurrentItemIndex:()=>(Kc(r,"getCurrentItemIndex",[ad,sd],u),Ks({state:r()})),async setCurrentItemIndex(e){nd(u,"setCurrentItemIndex"),rd(h,"setCurrentItemIndex"),nd(u,"setCurrentItemIndex"),Kc(r,"setCurrentItemIndex",[ad,sd],u,!1),(e=>{if(!(0,l.isInteger)(e))throw new n.DatasetError(`Parameter (${e}) must be a number`,{code:"PARAMETER_NOT_ALLOWED"})})(e),await new Promise(e=>b.onReady(e)),Wr(r())||await P(),await t(Uc.setCurrentIndex(e))},setFieldValue:(e,n)=>{ed(r,"setFieldValue"),Kc(r,"setFieldValue",[id,sd],u),td(r),t(Uc.updateFields({[e]:(0,l.cloneDeep)(n)}))},setFieldValues:e=>{ed(r,"setFieldValues"),Kc(r,"setFieldValues",[id,sd],u),td(r),t(Uc.updateFields((0,l.mapValues)(e,l.cloneDeep)))},async next(){if(rd(h,"next"),nd(u,"next"),ed(r,"next"),Kc(r,"next",[ad,sd],u,!1),Wr(r())||await P(),!b.hasNext())throw new n.DatasetError("There are no more items in the dataset",{code:"NO_SUCH_ITEM"});const e=Ks({state:r()});return await t(Uc.setCurrentIndex(e+1)),b.getCurrentItem()},async previous(){if(rd(h,"previous"),nd(u,"previous"),ed(r,"previous"),Kc(r,"previous",[ad,sd],u,!1),Wr(r())||await P(),!b.hasPrevious())throw new n.DatasetError("This is the first item in the dataset",{code:"NO_SUCH_ITEM"});const e=Ks({state:r()});return await t(Uc.setCurrentIndex(e-1)),b.getCurrentItem()},hasNext:()=>(Kc(r,"hasNext",[ad,sd],u),nl({state:r(),recordStore:o})),hasPrevious:()=>(Kc(r,"hasPrevious",[ad,sd],u),rl({state:r()})),new:async e=>C(e,"new"),add:async e=>C(e,"add"),async remove(){nd(u,"remove"),ed(r,"remove"),Kc(r,"remove",[sd],u,!1);if(null==Ks({state:r()}))throw new n.DatasetError("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"});await t(Uc.remove())},revert:async()=>(nd(u,"revert"),ed(r,"revert"),Kc(r,"revert",[id,sd],u,!1),td(r),t(Uc.revert())),async refresh(){ed(r,"refresh"),Kc(r,"refresh",[ad,id,sd],u,!1),await t(Uc.refresh())},onCurrentIndexChanged:e=>(nd(u,"onCurrentIndexChanged"),Zc("onCurrentIndexChanged",e),Kc(r,"onCurrentIndexChanged",[sd,ad],u,!1),s("currentIndexChanged",f(e,"currentIndexChanged"))),onItemValuesChanged:e=>(Zc("onItemValuesChanged",e),Kc(r,"onItemValuesChanged",[sd,id],u,!1),s("itemValuesChanged",f(e,"itemValuesChanged"))),onError:e=>(Zc("onError",e),Kc(r,"onError",[sd,ad,id],u,!1),s("datasetError",f(e,"datasetError"))),onReady:e=>(Zc("onReady",e),Kc(r,"onReady",[ad,id,sd],u,!1),qr(r())?(Promise.resolve(f(e)()),l.noop):s("datasetReady",f(e,"datasetReady"))),onReadyAsync:_,async setSort(e){rd(h,"setSort"),nd(u,"setSort"),Kc(r,"setSort",[ad,sd],u,!1),(e=>{if(!e||!(0,l.isFunction)(e._build))throw new n.DatasetError("The given sort object is invalid",{code:"DS_INVALID_ARGUMENT"})})(e),await new Promise(e=>b.onReady(e)),Wr(r())||await P();const o=T(()=>e._build(),n.UserError.withMessage("Sort building failed"));await t(Bc((0,l.cloneDeep)(o()))),R()},async setFilter(o){rd(h,"setFilter"),nd(u,"setFilter"),Kc(r,"setFilter",[ad,sd],u,!1),(e=>{const t=e&&(e._build||e.build);if(!(0,l.isFunction)(t))throw new n.DatasetError("The given filter object is invalid",{code:"DS_INVALID_ARGUMENT"})})(o),await new Promise(e=>b.onReady(e)),Wr(r())||await P();const a=T(()=>o._build&&o._build()||o.build&&o.build(),n.UserError.withMessage("Filter building failed"));await t(kc((0,l.cloneDeep)(a()))),e&&R()},loadMore:async()=>{rd(h,"loadMore"),nd(u,"loadMore"),ed(r,"loadMore"),Kc(r,"loadMore",[ad,sd],u,!1),await t(Uc.incrementNumOfPagesToShow())},async nextPage(){if(rd(h,"nextPage"),nd(u,"nextPage"),ed(r,"nextPage"),Kc(r,"nextPage",[ad,sd],u,!1),Wr(r())||await P(),!b.hasNextPage())throw new n.DatasetError("There are no more pages in the dataset",{code:"NO_SUCH_PAGE"});await t(Uc.nextPage());const{items:e}=await Uc.fetchCurrentPage(o,r());return e},async previousPage(){if(rd(h,"previousPage"),nd(u,"previousPage"),ed(r,"previousPage"),Kc(r,"previousPage",[ad,sd],u,!1),Wr(r())||await P(),!b.hasPreviousPage())throw new n.DatasetError("This is the first page in the dataset",{code:"NO_SUCH_PAGE"});await t(Uc.previousPage());const{items:e}=await Uc.fetchCurrentPage(o,r());return e},hasNextPage:()=>(Kc(r,"hasNextPage",[ad,sd],u),al({state:r(),recordStore:o})),hasPreviousPage:()=>(Kc(r,"hasPreviousPage",[ad,sd],u),ol({state:r()})),getTotalPageCount:()=>(Kc(r,"getTotalPageCount",[ad,sd],u),qr(r())?(Yc(zs({recordStore:o}),"getTotalPageCount"),Zs({state:r(),recordStore:o})):null),getCurrentPageIndex:()=>(Kc(r,"getCurrentPageIndex",[ad,sd],u),Qs({state:r()})),async loadPage(e){Kc(r,"loadPage",[ad,sd],u,!1),rd(h,"loadPage"),nd(u,"loadPage"),ed(r,"loadPage"),Yc(zs({recordStore:o}),"loadPage"),((e,t)=>{if(Xc("pageNumber",e),e>t)throw new n.DatasetError(`Page ${e} does not exist`,{code:"NO_SUCH_PAGE"})})(e,b.getTotalPageCount()),Wr(r())||await P(),await t(Uc.loadPage(e));const{items:a}=await Uc.fetchCurrentPage(o,r());return a},inScope:(e,t)=>{Kc(r,"inScope",[ad,id,sd],u,!1);const n=c.getController({repeaterId:e,itemId:t});return n?n.staticExports:b},getPageSize:()=>(Kc(r,"getPageSize",[ad,sd],u),Hs({state:r()})),async setPageSize(e){nd(u,"setPageSize"),Kc(r,"setPageSize",[ad,sd],u,!1),Xc("size",e),await new Promise(e=>b.onReady(e)),Wr(r())||await P(),await t(Qt({size:e}))}};e||(v.initDataSource=function(e){let{getData:r,onDataChanged:n,getSchema:o}=e;const i=r();a.setSchemas({[p]:o()}),a.setStore({recordsByCollectionId:{[p]:i.reduce((e,t)=>(e[t._id]=t,e),{})},recordInfosByDatasetId:{[d]:{itemIds:i.map(e=>{let{_id:t}=e;return t}),datasetSize:{total:i.length,loaded:i.length}}}}),n(async(e,r)=>{a.setCollectionData({collectionId:p,data:{items:r}}),await t(Uc.refresh())}),E()});const O=od({datasetType:u,siblingDynamicPageUrlGetter:m}),b=Object.assign(v,O),N={};for(const e in b)N[e]=(0,l.flow)(t=>S(t,Ue.with({category:"datasetAPI",message:`method: ${e} - datasetId:${d}`})),t=>w(t,e),t=>{return y(t,(r=e,e=>{throw e instanceof n.UserError?I.log(new n.UserError(`datasetApi '${r}' operation failed`,{cause:e})):e instanceof n.ServerError?I.log(e):I.log(new n.AppError(`datasetApi '${r}' operation failed`,{cause:e})),i("datasetError",r,e instanceof n.ServerValidationError?e.cause.message:e.cause||e),e.cause||e}));var r})(b[e]);return N}},cd=function(e){void 0===e&&(e=l.noop);let t=!1,r={};const n=e=>r[e]?r[e]:r[e]=[],o=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Promise.all(n(e).map(e=>e(...r)))};return{register:(e,r)=>{if(t)return l.noop;const o=(e=>y(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Promise.resolve(e(t,...n))},e=>Promise.reject(e)))(r);return n(e).push(o),()=>{(0,l.remove)(n(e),e=>e===o)}},executeHooks:o,fireEvent:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return f.logger.log(new Me(Me.types.DS_API.TRIGGERED,{eventName:t,eventArgs:n})),e(t,...n),o(t,...n)},dispose:()=>{t=!0,r={}}}};function dd(e){return e.role===$}function ud(e,t,r,n){e.log(new Ue({category:"components",message:`${r} loadMoreButton state changed to ${n?"visible":"hidden"} (dataset: ${t})`}))}function pd(e,t,r,n){e.log(new Ue({category:"components",message:`${r} loadMoreButton state changed to ${n?"enabled":"disabled"} (dataset: ${t})`}))}const fd=e=>(0,l.uniqBy)(e.filter(e=>{let{enabled:t}=e;return t}),e=>{let{id:t}=e;return t}),hd=[U,M,O,K,...he],md=e=>fd(e).filter(e=>{let{role:t,isInput:r}=e;return r&&!hd.includes(t)}),gd=(e,t,r,n)=>{e.enabled!=t&&(t?e.enable():e.disable(),r.log(new Ue({category:"components",message:`${e.id} changed to ${t?"enabled":"disabled"} (dataset: ${n})`})))},yd=[D,"imageButtonRole","stylableButtonRole"],vd=(e,t)=>fd(e).filter(e=>{let{role:t}=e;return(0,l.includes)(yd,t)}).filter(e=>{var r;let{connectionConfig:n}=e;return(0,l.includes)(t,null==n||null==(r=n.events)||null==(r=r.onClick)?void 0:r.action)}),_d={next:"previous",previous:"next",nextPage:"previousPage",previousPage:"nextPage"},Ed=(e,t,r,n,o)=>{if(e.enabled!==t){if(t)e.enable();else{var a;e.disable();const t=null==(a=e.connectionConfig)||null==(a=a.events)||null==(a=a.onClick)?void 0:a.action,r=f.lastAction.get();if((null==r?void 0:r.datasetId)===n&&(null==r?void 0:r.action)===t&&_d[t]){const e=(i=_d[t],o.find(e=>{var t;return(null==(t=e.connectionConfig)||null==(t=t.events)||null==(t=t.onClick)?void 0:t.action)===i}));e&&(e.focus(),f.lastAction.clear())}}var i;r.log(new Ue({category:"components",message:`${e.id} changed to ${t?"enabled":"disabled"} (dataset: ${n})`}))}},Id=[e=>{let{store:{getState:t},logger:r,recordStore:n,datasetId:o,components:a}=e;const i=a.filter(dd);if(0!==i.length)return()=>{const e=t(),a=Qs({state:e}),s=tl({state:e,recordStore:n}),l=1===a&&!s;for(const{id:e,loadMoreButton:t}of i)if(l)t.visible&&(t.hide(),ud(r,o,e,!1));else{if(t.hidden&&(t.show(),ud(r,o,e,!0)),t.enabled===s)continue;s?t.enable():t.disable(),pd(r,o,e,s)}}},e=>{let{store:{getState:t},logger:r,datasetId:n,components:o}=e;const a=md(o);if(0!==a.length)return()=>{const e=Hr(t());a.forEach(t=>{gd(t,e,r,n)})}},e=>{let{store:{getState:t},logger:r,recordStore:n,datasetId:o,components:a}=e;const i={new:()=>!Wr(t()),save:()=>Hr(t()),revert:()=>Hr(t()),remove:()=>Hr(t()),next:()=>nl({state:t(),recordStore:n}),previous:()=>rl({state:t()}),nextPage:()=>al({state:t(),recordStore:n}),previousPage:()=>ol({state:t()}),nextDynamicPage:()=>ln(t()).hasUrl(),previousDynamicPage:()=>cn(t()).hasUrl(),loadMore:()=>tl({state:t(),recordStore:n})},s=vd(a,Object.keys(i));if(0!==s.length)return()=>{s.forEach(e=>{var t;const n=null==(t=e.connectionConfig)||null==(t=t.events)||null==(t=t.onClick)?void 0:t.action;if(!n||!i[n])return;const a=i[n]();Ed(e,a,r,o,s)})}}],Td=e=>{const{subscribe:t,getState:r}=e.store,n=Id.map(t=>t(e)).filter(e=>!!e);return 0===n.length?l.noop:t(()=>{qr(r())&&n.forEach(e=>e())})},Sd={SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",FULL_DATE:"FULL_DATE",SHORT_DATE_TIME:"SHORT_DATE_TIME",LONG_DATE_TIME:"LONG_DATE_TIME",FULL_DATE_TIME:"FULL_DATE_TIME",MEDIUM_TIME_12:"MEDIUM_TIME_12",MEDIUM_TIME_24:"MEDIUM_TIME_24",LONG_TIME_12:"LONG_TIME_12",LONG_TIME_24:"LONG_TIME_24",HOUR_ONLY:"HOUR_ONLY",MINUTE_ONLY:"MINUTE_ONLY",YEAR_ONLY:"YEAR_ONLY",MONTH_ONLY:"MONTH_ONLY",SHORT_MONTH_ONLY:"SHORT_MONTH_ONLY",DAY_ONLY:"DAY_ONLY"},wd=(new Set([Sd.SHORT_DATE_TIME,Sd.LONG_DATE_TIME,Sd.FULL_DATE_TIME,Sd.MEDIUM_TIME_12,Sd.MEDIUM_TIME_24,Sd.LONG_TIME_12,Sd.LONG_TIME_24,Sd.HOUR_ONLY,Sd.MINUTE_ONLY]),{[Sd.SHORT_DATE]:{day:"numeric",month:"numeric",year:"2-digit"},[Sd.MEDIUM_DATE]:{day:"numeric",month:"short",year:"numeric"},[Sd.LONG_DATE]:{day:"numeric",month:"long",year:"numeric"},[Sd.FULL_DATE]:{day:"numeric",month:"long",year:"numeric",weekday:"long"},[Sd.SHORT_DATE_TIME]:{day:"numeric",month:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"},[Sd.LONG_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},[Sd.FULL_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",weekday:"long",timeZoneName:"short"},[Sd.MEDIUM_TIME_12]:{minute:"numeric",hour:"numeric",hour12:!0},[Sd.MEDIUM_TIME_24]:{minute:"numeric",hour:"numeric",hour12:!1},[Sd.LONG_TIME_12]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!0},[Sd.LONG_TIME_24]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!1},[Sd.HOUR_ONLY]:{hour:"numeric"},[Sd.MINUTE_ONLY]:{minute:"numeric"},[Sd.YEAR_ONLY]:{year:"numeric"},[Sd.MONTH_ONLY]:{month:"long"},[Sd.SHORT_MONTH_ONLY]:{month:"short"},[Sd.DAY_ONLY]:{weekday:"long"}}),Rd=e=>(0,l.isEqual)(!1,e);function Pd(e,t){return(0,l.mapValues)(t,(t,r)=>e(r).map(e=>function(e,t){switch(e){case"number":return Number(t);case"boolean":if("string"==typeof t)return"true"===t.toLowerCase()||"1"===t.toLowerCase();break;case"text":if(null!=t&&"function"==typeof t.toString)return t.toString()}return t}(e,t)).getOrElse(t))}const Cd=function(e,t,r,o,a,i,s,c,d){const{logger:u,errorReporting:p,breadcrumbReporting:h}=f,m=(e,t)=>h(t,Ue.with({category:"effects",message:e,data:{datasetId:a}}));function g(e,r){d({phase:"updateComponents"}),t.onCurrentRecordModified(r,e)}function y(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return p(s,n.AppError.withMessage(`Dataset ${e} event execution failed`))(e,...r)}function v(){return c.dispatch("dataLoadSuccess"),Promise.all(t.onRecordsLoaded())}const _=e=>{throw new n.DatasetError(e,{code:"DS_OPERATION_FAILED"})};return{goToRecordByIndex:(t,r,n)=>({run:m("goToRecordByIndex",async function(){let o;zs({recordStore:e})&&await il({index:r,recordStore:e});try{o=(e=>{let{recordStore:t,index:r}=e;const{total:n,loaded:o}=t().fold(e=>{throw e},e=>e.getDatasetSize());return Math.max(Math.min(r,Math.max(n,o)-1),0)})({recordStore:e,index:r})}catch(e){_(e)}if(t!==o||n){const t=await(a=o,e().fold(_,e=>e.getRecords(a,1)));return t.matchWith({Empty:()=>Uc.GoToIndexResult.NoRecord(),Results:e=>{let{items:t}=e;return Uc.GoToIndexResult.Record(o,t[0])}})}return Uc.GoToIndexResult.InvalidIndex();var a}),isQueued:!0,resultActionCreator:Uc.goToRecordByIndexResult}),setFieldsInCurrentRecord:(t,n,o)=>({run:m("setFieldsInCurrentRecord",function(){const a=Pd(r,t);return e().fold(_,e=>e.setFieldsValues(n,a,o).fold(e=>{throw e},()=>{}))}),isQueued:!1}),revertChanges:(t,r)=>({run:m("revertChanges",function(){e().chain(e=>e.resetDraft(t,r)),g()}),isQueued:!1,resultActionCreator:Uc.revertResult}),saveRecord:(t,r)=>({run:m("saveRecord",async function(){return await(u.log(new Me(Me.types.DS_API.TRIGGERED,{eventName:"beforeSave"})),o("beforeSave").then(e=>e.some(Rd)).catch(e=>({error:e})).then(e=>{if(e)throw new n.DatasetError(`Operation cancelled by user code. ${(0,l.isBoolean)(e)?"":e.error}`,{code:"DS_OPERATION_CANCELLED"})})),e().fold(()=>!1,async e=>{if(e.hasDraft(t)){!function(e){const t=i.filter(t=>!t.isValid(e));if(t.forEach(e=>e.updateValidityIndication()),t.length)throw new n.DatasetError("Some of the elements validation failed",{code:"DS_VALIDATION_ERROR"})}(r);const o=await e.saveRecord(t);return y("afterSave",r,o),c.dispatch("afterSave",r,o),o}})}),isQueued:!0,resultActionCreator:Uc.saveRecordResult}),removeCurrentRecord:t=>({run:m("removeCurrentRecord",()=>function(t){return e().fold(_,e=>e.removeRecord(t))}(t)),isQueued:!0,resultActionCreator:Uc.removeCurrentRecordResult}),newRecord:(t,r)=>({run:m("newRecord",()=>function(t,r){return e().fold(_,e=>e.newRecord(t,r))}(t,r)),isQueued:!0,resultActionCreator:Uc.newRecordResult}),fireEvent:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{run:m("fireEvent",()=>y(e,...r)),isQueued:!1}},notifyIndexChange:e=>({run:m("notifyIndexChange",()=>{d({phase:"notifyIndexChange"}),t.onCurrentIndexChanged(),y("currentIndexChanged",e)}),isQueued:!1}),notifyRecordSetLoaded:()=>({run:m("notifyRecordSetLoaded",v),isQueued:!0}),updateCurrentView:e=>({run:m("updateCurrentView",()=>(d({phase:"updateCurrentView"}),Promise.all(t.onCurrentViewChanged()))),isQueued:!0,resultActionCreator:Uc.updateCurrentViewResult}),refresh:(t,r,n)=>({run:m("refresh",async function(){return e().fold(_,async e=>(e.reset(),n?Uc.GoToIndexResult.Record(0,e.newRecord(0,r)):e.getRecords(0,1).then(e=>e.matchWith({Empty:()=>Uc.GoToIndexResult.NoRecord(),Results:e=>{let{items:t}=e;return Uc.GoToIndexResult.Record(0,t[0])}}))))}),isQueued:!0,resultActionCreator:Uc.refreshResult}),updateComponents:(e,t)=>({run:m("updateComponents",()=>{g(e,t)}),isQueued:!1})}},Od=e=>Hs({state:e}),bd=e=>ln(e).shouldLoadUrl(),Nd=e=>cn(e).shouldLoadUrl(),Dd=e=>{let{getNextDynamicPageUrl:t,getPreviousDynamicPageUrl:r}=e;const n={run:t,isQueued:!0,resultActionCreator:(e,t)=>({type:Or,error:e,payload:t})},o={run:r,isQueued:!0,resultActionCreator:(e,t)=>({type:br,error:e,payload:t})},a=e=>{let{hasChangedToTrue:t}=e;const r=[];return t(bd)&&r.push(n),t(Nd)&&r.push(o),r};return e=>(0,l.flatten)([a].map(t=>t(e)))},Ad=/[^{}]+(?=\})/g,Fd=/[^\dA-Za-z]/g,xd=async e=>{let{dataProvider:t,dynamicPagesData:{dynamicPageData:r,datasetConfig:{dataset:{sort:n,collectionName:o}},items:a}}=e;const i=await t.getSort({sort:n,collectionId:o})||[],{dynamicUrl:s,userDefinedFilter:c}=r,d=(0,Rn.aU)(a)[0],{fieldName:u,fieldDefinition:p}=Vd({dynamicUrl:s,schema:t.getSchema(o)}),f=s&&d?p&&(!(m=p).queryOperators||[fe.AllowedFilterOperator.gt,fe.AllowedFilterOperator.lt].every(e=>m.queryOperators.includes(e)))?[u]:(h=s,h=(e=>e.replace(/(\/{2,})/g,"/").replace(/^\//,""))(h),{fields:h.match(Ad)||[],nonFields:h.replace(Ad,"").split(Fd).filter(e=>!!e)}).fields:[];var h,m;const g=Ld(i),y=(0,l.difference)(f,g),v=Ud([...i,...Md(y)]),_=[...g,...y];return{dynamicUrl:s,userDefinedFilter:c,dynamicUrlPatternFieldsValues:kd(d,_,f),sort:v,sortFields:_,patternFields:f}},Ld=e=>(0,l.flatten)(e.map(e=>Object.keys(e).map(e=>e))),Ud=e=>e.reduce((e,t)=>Object.assign(e,t),{}),Md=e=>e.map(e=>({[e]:"asc"})),kd=(e,t,r)=>{const n=r.concat(t);return r.length?(0,l.pick)(e,n):null},Bd=async e=>{let{dataProvider:t,collectionName:r,directionTowardSibling:n,dynamicPagesData:o}=e;const{dynamicUrl:a,userDefinedFilter:i,dynamicUrlPatternFieldsValues:s,sort:l,sortFields:c,patternFields:d}=o?await xd({dynamicPagesData:o,dataProvider:t}):{};if(null==a||!d.length)return null;const u=await t.getSibling({collectionName:r,sort:l,sortFields:c,directionTowardSibling:n,fieldValues:s,filter:i}),{fieldName:p}=Vd({dynamicUrl:a,schema:t.getSchema(r)});return u&&p?u[p]:void 0},Vd=e=>{let{schema:t,dynamicUrl:r}=e;const[n,o]=Object.entries(t.fields).find(e=>{let[t,n]=e;return n.type===fe.FieldType.pageLink&&n.calculator.config.pattern===r})||[];return{fieldName:n,fieldDefinition:o}},Gd=(e,t)=>{try{return jd(e(t))}catch(e){return $d(e)}},jd=e=>({value:e,then:t=>Gd(t,e),catch:()=>jd(e)}),$d=e=>({error:e,then:()=>$d(e),catch:t=>Gd(t,e)}),qd={resolve:jd,reject:$d},Wd=e=>{let{recordStore:t,offset:r}=e;const{logger:n}=f;return t().fold(()=>Promise.resolve(Ve.Maybe.Nothing()),e=>e.hasSeedData()?(e=>e.getSeedRecords().matchWith({Empty:()=>qd.resolve(Ve.Maybe.Nothing()),Results:e=>{let{items:t}=e;return qd.resolve(Ve.Maybe.Just(t[0]))}}))(e):n.log(new Le("dataset/pageReady/getData",()=>(e=>e.seed().then(()=>e.getRecords(r,1).then(e=>e.chain(e=>{let{items:t}=e;return Ve.Maybe.Just(t[0])}))).catch(e=>(n.logError(e,"Fetch initial data failed"),Ve.Maybe.Nothing())))(e))))},zd=e=>{let{shouldFetchInitialData:t,recordStore:r,store:n,filter:o,sort:a,datasetIsDeferred:i,modeIsSSR:s,queueMicrotask:l,datasetIsReal:c,collectionId:d,filterResolver:u,dependencyManager:p,getSchemas:h,schemasLoading:m,getUserFilterInitialData:y,datasetId:v}=e;const _=()=>{const e=(i=n.getState(),Cr.getUserFilterConnectionProps(i.config));var i;const s=ji.getOffset(f.datasetStore[v]),l=t?Wd({recordStore:r,offset:s}):Promise.resolve();if(!(c&&(null==e?void 0:e.length)>0))return l.then(e=>Promise.resolve([e]));const p=u(o).map(async t=>{const r=y();if(r)return n.dispatch(Lc(r)),r;await m;const o=h(),i=o[d];if(i){const r=await wo({datasetConfigSort:a,getSchema:()=>i});!f.platform.settings.env.live||a&&0!==a.length||!r||self.setTimeout(()=>f.logger.log(new wn({id:901,collectionId:d})));try{const a=await f.dataFetcher.fetchUserFilterInitialData({filter:t,sort:r,userFilterConnectionProps:e,schema:i,schemas:o});return n.dispatch(Lc(a)),a}catch(e){f.logger.logError(e,"Failed to fetch user filter initial data for dataset",{datasetId:v})}}}).getOrElse(null);return Promise.all([l,p])},E=p.getDependencyResolutionPromise(o),I=i&&((e,t)=>{const{promise:r,resolve:n}=new g;return e||t(n),r})(s,l),{waitingForUserInput:T,resolveUserInputDependency:S}=Cl(o)&&(()=>{const{promise:e,resolve:t}=new g;return{waitingForUserInput:e,resolveUserInputDependency:t}})(),{waitingForDataSource:w,resolveDataSourceDependency:R}=$i(f.datasetStore[v])&&(()=>{const{promise:e,resolve:t}=new g;return{waitingForDataSource:e,resolveDataSourceDependency:t}})(),P=[E,I,T,w].filter(e=>Boolean(e));return{fetchingInitialData:P.length?Promise.all(P).then(_):_(),resolveUserInputDependency:()=>S&&S(),resolveDataSourceDependency:()=>{R&&R()}}},Hd=e=>{let{value:t,fieldName:r,record:n,getFieldType:o}=e;const a=(e=>{let{value:t,currentValue:r,fieldType:n}=e;return n===fe.FieldType.date&&ds(t)?ms(t):cs(r)&&ds(t)?us({time:r,date:t}):ds(r)&&cs(t)?us({time:t,date:r}):t})({value:t,currentValue:(0,l.get)(n,r),fieldType:o(r).getOrElse(null)});(0,l.set)(n,r,a)},Yd=(e,t)=>{const r=["value","checked"];return e.reduce((e,n)=>{var o;const a=(null==(o=n.connectionConfig)?void 0:o.properties)||{};return r.forEach(r=>{(0,l.has)(a,r)&&Hd({value:n.getValue({propPath:r}),fieldName:a[r].fieldName,record:e,getFieldType:t})}),e},{})},Jd=(e,t,r)=>{var n;return t===r||(null==(n=e[t])?void 0:n.some(t=>Jd(e,t,r)))},Kd=e=>{let{components:t,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o}=e;const a=t.filter(e=>(e=>{let{component:t,updatedCompIds:r,datasetIsReal:n,connectionsGraph:o}=e;if(r.length&&n){const{id:e}=t;return r.some(t=>Jd(o,e,t)||Jd(o,t,e))}return!0})({component:e,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o}));return a.some(e=>{let{role:t}=e;return t===O})?t:a},Qd=e=>e.split("_componentId_")[0],Xd=(e,t)=>{const{logger:r}=f;return(o,a,i)=>{const s=((e,t)=>(0,l.isNull)(e)&&(0,l.isNull)(t))(o,a);if(s)return void r.log(new n.AppError("onChangeHandler invoked with illegal arguments",{extra:{arguments:{before:o,after:a,componentIdToExclude:i}}}));if((e=>(0,l.isNull)(e))(o))return void t(Uc.refreshCurrentView()).catch(()=>{});const c=en(e());if(((e,t)=>(0,l.isNull)(t))(0,a))return Bl(o,c)&&t(Uc.refreshCurrentRecord()).catch(()=>{}),void t(Uc.refreshCurrentView()).catch(()=>{});if(((e,t)=>Bl(e,t))(o,c)){const r=Ks({state:e()});t(Uc.setCurrentRecord(a,r,i)).catch(()=>{})}}},Zd=e=>{let{detailsDatasetApis:t,masterDatasetApi:r,controllerConfig:o,unsubscribeHandlers:a}=e;const{logger:i}=f;t.forEach(e=>{const t=()=>{a.push(eu({masterDatasetApi:r,masterDatasetConfig:o,detailsDatasetApi:e}))};try{a.push(r.onReady(t))}catch(e){i.log(new ke(new n.DatasetError("The dataset cannot filter by the dynamic dataset because the field used to build this page's URL is empty",{code:"DS_EMPTY_URL_FIELD",cause:e}),"error"))}})},eu=e=>{let{masterDatasetConfig:t,masterDatasetApi:r,detailsDatasetApi:n}=e;const o=rr(t.dataset);let a,i;return o!==se&&(a=r.onCurrentIndexChanged(()=>n.onReady(()=>n.refresh()))),o!==ie&&(i=r.onItemValuesChanged(()=>n.refresh())),()=>[a,i].forEach(e=>null==e?void 0:e())},tu=e=>({id:e.id,role:e.role,isValidConnection:()=>!0,bind:()=>{},clear:()=>e.clear(),hide:()=>e.hide(),show:t=>e.show(t),resetUserFilter:()=>{},onRecordsLoaded:async()=>{},onCurrentViewChanged:async()=>{},onCurrentIndexChanged:async()=>{},onCurrentRecordModified:async()=>{}}),ru=e=>!!e&&Object.values(e).some(e=>!(0,l.isEmpty)(e)),nu=(e,t,r)=>{const{logger:o,platform:{location:a,utils:i,executeTpaAction:s},features:c}=f,{getSchema:d,getState:u,getFieldType:p,wixFormatter:h,modeIsLivePreview:m,datasetId:g}=r,y=n=>{ul({currentRecord:en(u()),previousRecord:n,component:e,connectionConfig:t,formatter:h,modeIsLivePreview:m,getFieldType:p,getSchema:d,logger:o,recordStore:r.recordStore,actions:r.actions})},v=e=>e.matchWith({Empty(){},Loading(){},Loaded(e){let{url:t}=e;a.navigateTo(t)}}),_=t=>{const{datasetApi:c,getState:d,actions:u}=r;(0,l.forEach)(t,(t,r)=>{e.on(r,async()=>{if(!t)return;const{action:e,postAction:r}=t;try{if(f.lastAction.set({action:e,datasetId:g}),e.startsWith(gi)){const t=c.getCurrentItem();return void await s({currentItem:t,action:e})}if("nextDynamicPage"===e)return v(ln(d()));if("previousDynamicPage"===e)return v(cn(d()));if("applyUserInputFilters"===e)return u.refresh();if("resetUserFilter"===e)return u.resetUserInputFilters();const t=await Promise.resolve(c[e]());if(r&&r.navigate){const e=((e,t)=>e.fieldName?is(t,e.fieldName):e.linkObject?i.links.toUrl(e.linkObject):void 0)(r.navigate,t);a.navigateTo(e)}}catch(t){t instanceof n.DataBindingError||o.log(new n.AppError(`${e} operation failed:`,{cause:t}))}})})};return{...tu(e),isValidConnection:()=>ru(t),bind(){const{events:n,behaviors:o}=t;n&&_(n),o&&(t=>{const{dispatcher:n,eventListeners:{register:o}}=r,a=e.getValue({propPath:"html"}),i=`<div aria-hidden="true">${a}</div>`;c.accessibilityBindings&&(e.setValue(i,{propPath:"html"}),e.setValue("polite",{propPath:"accessibility.ariaLive"}));const s={state:{type:"untriggered"}},l=()=>{if(e.show(),c.accessibilityBindings&&"untriggered"===s.state.type){const t=setTimeout(()=>{"pendingTriggering"===s.state.type&&(e.setValue(`${i}<div style="height:0;width:0;overflow:hidden">${a}</div>`,{propPath:"html"}),s.state={type:"triggered"})},150);s.state={type:"pendingTriggering",timerId:t}}},d=()=>{e.hide(),c.accessibilityBindings&&"untriggered"!==s.state.type&&("pendingTriggering"===s.state.type?clearTimeout(s.state.timerId):e.setValue(i,{propPath:"html"}),s.state={type:"untriggered"})};o("beforeSave",d),o("itemValuesChanged",d),t.forEach(e=>{switch(e.type){case"saveSuccessFeedback":o("afterSave",l);break;case"saveFailureFeedback":n.subscribe("datasetSaveError",l)}})})(o)},clear(){const{getFieldType:n}=r,{properties:o}=t;(0,l.forEach)(o,(t,r)=>{const o=n(t.fieldName).getOrElse(void 0);e.clear({propPath:r,fieldType:o,binding:t})})},async onRecordsLoaded(){const{behaviors:t}=e.connectionConfig;y(),!m&&t&&t.forEach(()=>{e.hide()})},async onCurrentViewChanged(){y()},async onCurrentIndexChanged(){y()},async onCurrentRecordModified(e){y(e)}}};const ou=(e,t)=>{return r=e,n=t,Object.defineProperties({},{...Object.getOwnPropertyDescriptors(r),...Object.getOwnPropertyDescriptors(n)});var r,n},au=e=>{const t={getValue:()=>e.data,setValue(t){e.data=t},clear(){e.data=[]},onItemReady(t){e.onItemReady(t)},onItemRemoved(t){e.onItemRemoved(t)}};return ou(du(e),t)},iu=e=>{const{loadMoreButton:t}=e,r={loadMoreButton:{get hidden(){return"hidden"in t&&Boolean(t.hidden)},get visible(){return!r.loadMoreButton.hidden},hide(){r.loadMoreButton.hidden||null==t.hide||t.hide()},show(){r.loadMoreButton.visible||null==t.show||t.show()},get disabled(){return"disabled"in t&&Boolean(t.disabled)},get enabled(){return!r.loadMoreButton.disabled},disable(){r.loadMoreButton.disabled||null==t.disable||t.disable()},enable(){r.loadMoreButton.enabled||null==t.enable||t.enable()},onClick(e){null==t.onClick||t.onClick(e)}}};return ou(au(e),r)},su=e=>"onChange"in e&&("value"in e||"checked"in e),lu=(e,t)=>{const r=t.split("."),n=r.slice(0,-1),[o]=r.slice(-1);return{obj:n.length>0?(0,l.get)(e,n):e,prop:o}},cu=e=>{if(!e||!e.parent)return;const{parent:t}=e;return t.type===We.Repeater?au(t):t.role===$?iu(t):cu(t)},du=e=>{const{connectionConfig:t,uniqueId:r,type:n,role:o,id:a}=e,i=!!e.hidden,s={id:r,connectionConfig:t,nickname:a,type:n,role:o,isInput:su(e),parentRepeater:cu(e),getValue(t){let{propPath:r}=void 0===t?{}:t;if(r){const{obj:t,prop:n}=lu(e,r);return t[n]}},setValue(t,r){let{propPath:n,fieldType:o,binding:a}=void 0===r?{}:r;if(n){const{obj:r,prop:i}=lu(e,n);r[i]="reference"===o&&(e=>(0,l.isObject)(e)&&(0,l.has)(e,"_id"))(t)?t._id:t,void 0!==a&&(e=>e===fe.FieldType.url||e===fe.FieldType.pageLink)(o)&&(a.linkTarget&&(r.target=a.linkTarget),void 0!==a.linkRel&&(r.rel=a.linkRel))}},setOptions(t){"options"in e&&(e.options=t)},hide(){e.hidden||null==e.hide||e.hide()},show(t){let{ignoreInitiallyHidden:r}=void 0===t?{ignoreInitiallyHidden:!1}:t;!e.hidden||r&&i||null==e.show||e.show()},clear(e){let{fieldType:t,propPath:r,binding:n}=void 0===e?{}:e;const o=t===fe.FieldType.mediaGallery?[]:void 0;s.setValue(o,{fieldType:t,propPath:r,binding:n})},get enabled(){return!("enabled"in e)||e.enabled},enable(){"enable"in e&&!s.enabled&&e.enable()},disable(){"disable"in e&&s.enabled&&e.disable()},focus(){"focus"in e&&"function"==typeof e.focus&&e.focus()},isValid:()=>!("validity"in e)||"object"!=typeof e.validity||e.validity.valid,updateValidityIndication(){"updateValidityIndication"in e&&e.updateValidityIndication()},resetValidityIndication(){"resetValidityIndication"in e&&e.resetValidityIndication()},onChange(e){s.on("onChange",e)},on(t,r){var n;null==(n=e[t])||n.call(e,r)}};return"placeholder"in e&&Object.defineProperty(s,"placeholder",{get:()=>e.placeholder}),s},uu=e=>{switch(e.role){case b:return(e=>{const t=du(e),r={setValue(r,n){let{fieldType:o,propPath:a="text",binding:i}=void 0===n?{}:n;if(o===fe.FieldType.url){const t=(null==i?void 0:i.linkTarget)||"_blank";e.text=`<a href=${r} target="${t}"${null!=i&&i.linkRel?` rel="${null==i?void 0:i.linkRel}"`:""} style="text-decoration: underline">${r}</a>`;const{html:n}=e;return e.text="",void(e.html=(0,l.unescape)(n))}t.setValue(r,{fieldType:o,propPath:a,binding:i})},clear(e){let{fieldType:r,propPath:n,binding:o}=void 0===e?{}:e;const a=null!=n&&n.includes("style")?void 0:"";t.setValue(a,{fieldType:r,propPath:n,binding:o})}};return ou(t,r)})(e);case j:case P:return au(e);case $:return iu(e);case k:return(e=>{const t={get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},setValue(t){e.rows=t},getValue:()=>e.rows,set rows(e){t.setValue(e)},get rows(){return e.rows},get columns(){return e.columns},clear(){e.rows=[],e.dataFetcher=void 0},set dataFetcher(t){e.dataFetcher=t},refresh:()=>e.refresh(),onCellSelect:t=>e.onCellSelect(t),onRowSelect:t=>e.onRowSelect(t)};return ou(du(e),t)})(e);case G:return(e=>{const t={isValid(t){const{connectionConfig:r,validity:n}=e;if(n.valid)return!0;if((0,l.some)((0,l.values)((0,l.omit)(n,["valid","valueMissing"])),e=>e))return!1;const o=(0,l.get)(r,"properties.value.fieldName")||"";return!(0,l.isEmpty)(is(t,o))},set fileType(t){e.fileType=t},get fileType(){return e.fileType},getValue:()=>e.value,clear(){e.reset()},uploadFiles:async()=>e.uploadFiles()};return ou(du(e),t)})(e);case Q:return(e=>{const t=du(e),r={setValue(r,n){r?t.setValue(r,n):e.clear()}};return ou(t,r)})(e);case F:return(e=>{e.clickAction&&(e.clickAction=e.clickAction);const t={setValue(t){e.items=t},getValue:()=>e.items,clear(){e.items=[]},set currentIndex(t){try{e.galleryCapabilities.hasCurrentItem&&(e.currentIndex=t)}catch{}},get currentIndex(){return e.currentIndex},get clickAction(){return e.clickAction},onCurrentItemChanged(t){e.galleryCapabilities.hasCurrentItem&&e.onCurrentItemChanged(e=>{let{item:r,itemIndex:n}=e;return t(r,n)})}};return ou(du(e),t)})(e);case W:return(e=>{const t={get currentPage(){return e.currentPage},set currentPage(t){e.currentPage=t},get totalPages(){return e.totalPages},set totalPages(t){e.totalPages=t},get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},get navigationType(){return e.navigationType},set navigationType(t){e.navigationType=t},onNextClicked(t){e.onNextClicked(t)},onPreviousClicked(t){e.onPreviousClicked(t)}};return ou(du(e),t)})(e);case H:return(e=>{const t={setValue(t){e.location=t},getValue:()=>e.location,clear(){e.markers=[]},set location(t){e.location=t},get location(){return e.location},set markers(t){e.markers=t},get markers(){return e.markers},setCenter(t){e.setCenter(t)}};return ou(du(e),t)})(e);case oe:return(e=>{const t={setValue(t){e.value=t},getValue:()=>e.value,clear(){e.value=[]},setBounds(t,r){e.min=t,e.max=r},getBounds:()=>[e.min,e.max]};return ou(du(e),t)})(e);default:return du(e)}},pu=e=>t=>{const r=[],n=[];(0,l.uniq)(t.map(e=>{let{role:t}=e;return t})).forEach(t=>{if(t===C){return void(e("@"+t)||[]).forEach(e=>e&&n.push(e))}if(t===q){const t=e("@"+q)||[],[n]=Array.isArray(t)?t:[t],o=e("Document");if(o&&n){const e=new Proxy(o,{get:(e,t)=>"connectionConfig"===t?n.connectionConfig:"role"===t?q:e[t]});r.push(e)}return}(e("@"+t)||[]).forEach(e=>{e&&r.push(e)})});return{components:r.map(e=>uu(e)),detailsDatasetApis:n,originalComponents:r}},fu=(e,t,r)=>{const{errorReporting:o}=f,{controllerFactory:a,controllerStore:i}=r,s=[],l=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},o=a.createScopedDataset({datasetScope:n,fixedItem:r});i.setController(n,o);const l=pu(t.scoped),c=o.pageReady(l);s.push(c)},c=t=>{const r={repeaterId:e.id,itemId:t._id};i.removeController(r)},d=async()=>{const{actions:t,getState:n,modeIsLivePreview:o}=r,{items:a}=await t.fetchCurrentItems(n());o&&0===a.length||(e.setValue(a),await Promise.all(s),s.splice(0))};return{...tu(e),bind(){e.onItemReady(o(l,n.AppError.withMessage("Repeater adapter onItemReady failed"))),e.onItemRemoved(o(c,n.AppError.withMessage("Repeater adapter onItemRemoved failed")))},onRecordsLoaded:async()=>d(),async onCurrentViewChanged(){d()},async onCurrentIndexChanged(){},async onCurrentRecordModified(){const{getState:t}=r,n=en(t()),o=e.getValue();if(o&&o.length>0){const t=o.map(e=>e._id===n._id?n:e);e.setValue(t)}}}},hu=(e,t,r)=>{const{logger:o,errorReporting:a}=f,{getState:i,getSchema:s,getFieldType:l,actions:c,modeIsLivePreview:d}=r,u=n=>{ul({currentRecord:en(i()),previousRecord:n,component:e,connectionConfig:t,modeIsLivePreview:d,getFieldType:l,getSchema:s,logger:o,recordStore:r.recordStore,actions:r.actions})},p=()=>{const t=c.isCurrentRecordPristine(i()),r=c.isCurrentRecordNew(i());t&&r&&e.resetValidityIndication()};return{...tu(e),isValidConnection:()=>ru(t),bind(){(()=>{const{id:r,role:o}=e,{properties:s}=t;e.onChange(a(e=>{const t=s.checked?"checked":"value",n=s[t].fieldName,a=en(i()),d=$s({value:e.target[t],currentValue:is(a,n),fieldType:l(n).getOrElse(void 0),fieldName:n,utils:{referenceFetcher:(e,t)=>c.fetchRecordById(e,t).getOrElse(e)},role:o});c.setFieldInCurrentRecordAndSynchronize(n,d,r)},n.AppError.withMessage("Input adapter onChange - setting value to record failed")))})(),t.filters&&e.onChange(a(c.refresh,n.AppError.withMessage("Input adapter onChange - sync actions failed")))},async onRecordsLoaded(){u(),p()},async onCurrentViewChanged(){u(),p()},async onCurrentIndexChanged(){u(),p()},async onCurrentRecordModified(e){u(e),p()}}},mu={start:0,end:0},gu=(e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}},yu=e=>(0,l.get)(e,"properties.value.fieldName")||"",vu=(e,t,r)=>{const{errorReporting:o}=f,{actions:a,recordStore:i,getState:s}=r,l=t.userInputFilter.fieldName;e.onChange(o(async()=>{const t=un(s()),n=(o=s(),hr.selectIsApplyUserInputFiltersActionBindingPresent(o.records));var o;if(t||n)return;await a.refresh();const c=i().fold(()=>{},e=>e.getDatasetSize().total),d=kr(s());(e=>{let{state:t,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a,schema:i}=e;const{logger:s,platform:{settings:{env:{editor:l}}}}=f,c=jr(t),d=kr(t);if(!d)return;const u=i.getOrElse({displayName:d}).displayName;s.log(new wn({id:l?366:371,collectionId:d,collectionName:u,datasetMode:c,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a}))})({filteredBy:l,numberOfResults:c,state:r.getState(),componentType:e.type,fieldType:r.getFieldType(l).getOrElse(void 0),schema:r.getSchema(d)})},n.AppError.withMessage("Filter input adapter onChange failed")))},{NOT_EQUALS:_u,EXCLUDES_ANY:Eu}=ue,Iu=(e,t,r)=>{const{i18n:n}=f,{getState:o}=r,a=t=>{const r=Array.isArray(e.getValue({propPath:t}))?[]:be;e.setValue(r,{propPath:t})},i=e=>[_u,Eu].includes(e)?n.t("USER_INPUT_FILTER_OPTION_NONE"):n.t("USER_INPUT_FILTER_OPTION_RESET_ALL");return{...tu(e),isValidConnection:()=>vr(t),bind(){vu(e,t,r);const{userInputFilter:{prop:n,fieldName:s,condition:l}}=t,c=(e=>{var t;return null==(t=yn(o()))?void 0:t.find(t=>t.fieldName===e&&Ne.includes(t.role))})(s);c&&(e.setOptions((e=>{let{component:t,prop:r,userFilterInitialData:n,condition:o}=e;return[!Array.isArray(t.getValue({propPath:r}))&&{value:be,label:i(o)},...n.options.map(e=>({value:String(e),label:String(e)}))].filter(Boolean)})({component:e,prop:n,userFilterInitialData:c,condition:l})),(e=>"placeholder"in e)(e)||a(n))},resetUserFilter(){const{userInputFilter:{prop:r}}=t;e.getValue({propPath:r})&&a(r)}}},{richText:Tu}=fe.FieldType,Su={$text:e=>e===Tu?"html":"text"},wu=e=>{let{propName:t,getFieldType:r}=e;return t in Su?Su[t](r()):t},Ru=e=>e.startsWith("$"),Pu=new Map([[j,fu],[$,(e,t,r)=>{const{datasetApi:n}=r,o=fu(e,0,r);return{...o,bind(){o.bind(),e.loadMoreButton.onClick(()=>{n.loadMore()})}}}],[P,(e,t,r)=>{const{errorReporting:o}=f,{controllerFactory:a,controllerStore:i}=r,s=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},o=a.createScopedDetailsDataset({datasetScope:n});i.setController(n,o);const s=pu(t.scoped);o.pageReady(s)},l=t=>{const r={repeaterId:e.id,itemId:t._id};i.removeController(r)};return{...tu(e),bind(){e.onItemReady(o(s,n.AppError.withMessage("Details repeater adapter onItemReady failed"))),e.onItemRemoved(o(l,n.AppError.withMessage("Details repeater adapter onItemRemoved failed")))}}}],[O,(e,t,r)=>{const{errorReporting:o}=f,{actions:a}=r;return{...tu(e),isValidConnection:()=>ru(t),bind(){e.onChange(o(a.refresh,n.AppError.withMessage("Filter input adapter onChange failed")))},resetUserFilter(){const t=cl(e);e.setValue((e=>{switch(e.type){case sl:return!1;case ll:return"";default:return null}})(e),{propPath:t})}}}],[Z,Iu],[re,Iu],[te,Iu],[ne,Iu],[ee,(e,t,r)=>{const n=()=>{const{userInputFilter:{prop:r}}=t;e.setValue(null,{propPath:r})};return{...tu(e),isValidConnection:()=>vr(t),bind(){vu(e,t,r),n()},resetUserFilter(){n()}}}],[oe,(e,t,r)=>{const{getState:n}=r,o=t=>{var r;const o=null==(r=yn(n()))?void 0:r.find(r=>r.fieldName===t&&r.role===e.role);if(!o)return null;const{min:a,max:i}=o;return void 0===a||void 0===i?null:{min:a,max:i}},a=r=>{let{firstRender:n,min:o,max:a}=r;const{userInputFilter:{prop:i}}=t;n&&e.setBounds(o,a),e.setValue([o,a],{propPath:i})};return{...tu(e),isValidConnection:()=>vr(t),bind(){const n=o(t.userInputFilter.fieldName);n&&(vu(e,t,r),a({firstRender:!0,...n}))},resetUserFilter(){const e=o(t.userInputFilter.fieldName);e&&a({firstRender:!1,...e})}}}],[k,(e,t,r)=>{const{errorReporting:o}=f,{datasetApi:a,getState:i,modeIsLivePreview:s,actions:c}=r;let d=mu;const u=e=>d=e,p=()=>u(mu),h=e=>{let{fetchRows:t,logGridValue:r,disableNavigation:n=!1}=e;return async(e,o)=>{const{items:a,datasetSize:i}=await t(e,o-e);return r(a),{pageRows:a,totalRowsCount:n?a.length:i.total}}},m=t=>{let{fetchRows:r,logGridValue:n}=t;return async t=>{let{direction:o,limit:a}=t,{start:i,end:s}=d;"previous"===o?(s=i,i-=a):(i=s,s+=a);const{items:l,datasetSize:c}=await r(i,s-i);return u({start:i,end:s}),e.nextEnabled=!!c.cursor||s<c.loaded,e.previousEnabled=i>0,n(l),{pageRows:l,totalRowsCount:c.total||void 0}}},g=t=>{const r=[],n=e.columns;(0,l.forEach)(t,e=>{const t={};(0,l.forEach)(n,r=>{t[r.label]=(0,l.get)(e,r.dataPath)}),r.push(t)})};return{...tu(e),bind(){c.getInitialData().chain(t=>{let{items:r}=t;e.rows=r});const t=en(i());if(s&&!t)return;const r=c.isCursorPaging();e.dataFetcher=r?{type:"directional",value:m({fetchRows:c.fetch,logGridValue:g,component:e})}:{type:"pages",value:h({fetchRows:c.fetch,logGridValue:g})},e.onCellSelect(o(e=>{let{cellRowIndex:t}=e;a.setCurrentItemIndex(t)},n.AppError.withMessage("Grid adapter onCellSelect failed"))),e.onRowSelect(o(e=>{let{rowIndex:t}=e;a.setCurrentItemIndex(t)},n.AppError.withMessage("Grid adapter onRowSelect failed"))),(()=>{const t={};e.columns.forEach(e=>{let{label:r,dataPath:n,linkPath:o}=e;(n||o)&&(t[r]=Object.assign(n?{dataPath:n}:{},o?{linkPath:o}:{}))})})()},async onCurrentRecordModified(){e.refresh()},async onRecordsLoaded(){p(),e.refresh()},async onCurrentViewChanged(){p(),e.refresh()}}}],[U,(e,t,r)=>{const{logger:n}=f,{actions:o,getFieldType:a,getSchema:i}=r,s=async()=>{var r;const{role:s}=e,c=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{if("field"===t.type&&a(t.fieldName).map(e=>"reference"===e).getOrElse(!1)){const{fieldName:r}=t;return i().chain(t=>{const n=Un(r,t);return i(n).map(Mn).map(async t=>{const{items:n}=await o.fetchAll(r),a=n.map(r=>gu(r,{valueSource:{type:"field",fieldName:"_id"},labelField:t,dataTransformer:e}));return(0,l.orderBy)(a,[e=>e.label.toLowerCase()])})}).getOrElse(Promise.resolve([]))}{const{items:r}=await o.fetchAll(),n=r.map(r=>gu(r,{valueSource:t,dataTransformer:e}));return(0,l.uniqBy)(n,"value")}})((e,t)=>"expression"===t.type?Ws({expression:t.expression,record:e,prop:"value",role:s,logger:n,getSchema:i}).value:Is({value:is(e,t.fieldName),role:s}),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.value.expression}:{type:"field",fieldName:t.properties.value.fieldName}));e.setOptions(c)};return{...tu(e),isValidConnection:()=>ru(t),clear(){e.setOptions([])},async onRecordsLoaded(){s()},async onCurrentRecordModified(){s()}}}],[M,(e,t,r)=>{const{logger:n}=f,{actions:o,getSchema:a}=r,i=async()=>{var r;const{role:i}=e,s=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{const{items:r}=await o.fetchAll(),n=r.map(r=>((e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}})(r,{valueSource:t,dataTransformer:e}));return(0,l.uniqBy)(n,"value")})((e,t)=>"expression"===t.type?Ws({expression:t.expression,record:e,prop:"options",role:i,logger:n,getSchema:a}).value:Is({value:is(e,t.fieldName),role:i}),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.options.expression}:{type:"field",fieldName:t.properties.options.fieldName}));e.setOptions(s)};return{...tu(e),isValidConnection:()=>ru(t),clear(){e.setOptions([])},async onRecordsLoaded(){i()},async onCurrentRecordModified(){i()}}}],[K,(e,t,r)=>{const{logger:n}=f,{actions:o,modeIsLivePreview:a,getSchema:i}=r,s=async()=>{const{role:r}=e,{items:s}=await o.fetchAll(),l=s.reduce((e,o)=>{var a;if(null!=(a=t.expressions)&&a.options){const{value:a}=Ws({expression:t.expressions.options.expression,record:o,prop:"options",role:r,logger:n,getSchema:i});return e.push({value:a,label:a}),e}const{properties:{options:{fieldName:s}}}=t,l=Is({value:is(o,s),role:r});return l&&e.push({value:l,label:l}),e},[]);a&&0===l.length||e.setOptions(l)};return{...tu(e),isValidConnection:()=>ru(t),clear(){e.setOptions([])},async onRecordsLoaded(){s()},async onCurrentRecordModified(){s()}}}],[G,(e,t,r)=>{const{logger:o,errorReporting:a}=f,{actions:i,datasetApi:s,getState:c,getFieldType:d}=r,u={},p=function(r){void 0===r&&(r=!1);const n=en(c()),o=yu(t),a=i.isCurrentRecordNew(c()),s=(0,l.isEmpty)(is(n,o));(i.isCurrentRecordPristine(c())||r)&&e.clear(),!s||a&&!r||e.updateValidityIndication()};return{...tu(e),isValidConnection:()=>ru(t),bind(){if(Wr(c()))return;const{id:r,role:l}=e,p=yu(t),f=d(p).getOrElse(void 0);e.onChange(a(()=>{u[r]=!0},n.AppError.withMessage("Upload button adapter onChange failed"))),s.onBeforeSave(()=>{if(u[r]&&e.getValue().length)return e.uploadFiles().then(e=>{u[r]=!1;const t=en(c()),n=$s({value:e,currentValue:is(t,p),fieldType:f,fieldName:p,role:l});i.setFieldInCurrentRecordAndSynchronize(p,n,r)}).catch(t=>{const r=e.getValue(),a=Array.isArray(r)&&1===r.length?r[0].name:"unknown";throw o.log(new n.UserError(`The ${a} file failed to upload. Please try again later.`,{cause:t})),t})}),d(p).map(t=>{switch(t){case"image":e.fileType="Image";break;case"document":e.fileType="Document"}})},async onCurrentRecordModified(r){const{id:n}=e,o=yu(t),a=en(c()),i=ss({previousRecord:r,currentRecord:a,fieldName:o});i&&(u[n]=!1),p(i)},async onRecordsLoaded(){p()},async onCurrentViewChanged(){p()},async onCurrentIndexChanged(){p()}}}],[F,(e,t,r)=>{const{logger:o,errorReporting:a}=f,{actions:i,getState:s,getFieldType:c,getSchema:d,modeIsLivePreview:u,wixFormatter:p}=r,h=(e,t,r,n)=>{(0,l.forEach)(r.expressions,(r,a)=>{let{expression:i}=r;const{value:s}=Ws({expression:i,record:t,prop:a,role:n,logger:o,getSchema:d});e[a]=s}),(0,l.forEach)(r.properties,(r,o)=>{let{fieldName:a,format:i}=r;const s=Is({value:is(t,a),role:n,fieldType:c(a).getOrElse(void 0),propPath:o,format:i,utils:{formatter:p}});e[o]=s})},m=()=>{e.currentIndex=Ks({state:s()})},g=async()=>{const{role:r}=e,{items:n}=await i.fetchCurrentItems(s());try{const o=n.map(e=>{const n={};return h(n,e,t,r),n}),a=o.every(e=>{let{src:t}=e;return!t});if(u&&a)return;e.setValue(o)}catch(e){if("URIError"!==e.name)throw e}m()};return{...tu(e),isValidConnection:()=>ru(t),bind(){e.onCurrentItemChanged(a(()=>{i.setCurrentIndex(e.currentIndex)},n.AppError.withMessage("Gallery adapter onItemReady failed")))},async onCurrentRecordModified(){const{role:r}=e,n=en(s()),o=Ks({state:s()}),a=e.getValue()||[],i=a[o];i&&h(i,n,t,r),e.setValue(a),m()},async onRecordsLoaded(){g()},async onCurrentViewChanged(){g()},async onCurrentIndexChanged(){m()}}}],[W,(e,t,r)=>{const{errorReporting:o}=f,{actions:a,getState:i}=r,s=()=>{a.isCursorPaging()?(()=>{const t=Qs({state:i()});e.nextEnabled=a.hasNextPage(i()),e.previousEnabled=t>1})():(()=>{const t=Qs({state:i()}),r=a.getTotalPageCount(i());e.currentPage=t,r<1?e.disable():(e.enable(),e.totalPages=r)})()};return{...tu(e),bind(){const t=a.isCursorPaging(),r=e=>{let{delta:r,index:n}=e;const o=Qs({state:i()}),s=r?o+r:n,c=Hs({state:i()}),d=t?s:(0,l.clamp)(s,1,a.getTotalPageCount(i()));a.setCurrentIndex(((e,t)=>t*(e-1))(d,c))};t?(e.navigationType="arrowsOnly",e.onNextClicked(o(()=>r({delta:1}),n.AppError.withMessage("Pagination adapter onNextClicked failed"))),e.onPreviousClicked(o(()=>r({delta:-1}),n.AppError.withMessage("Pagination adapter onPreviousClicked failed")))):e.onChange(o(e=>r({index:e.target.currentPage}),n.AppError.withMessage("Pagination adapter onChange failed")))},async onRecordsLoaded(){s()},async onCurrentViewChanged(){s()}}}],[H,(e,t,r)=>{const{logger:o}=f,{actions:a,getState:i,getFieldType:s,wixFormatter:c}=r,d=(e,t,r)=>{let{expressions:o={},properties:a={}}=t;const i=e=>{let{propPath:t,marker:n,value:o,fieldType:a,format:i}=e;if("address"===t)return Object.assign(n,{address:(null==o?void 0:o.formatted)??"",location:(null==o?void 0:o.location)??{latitude:0,longitude:0}});if("link"===t&&(0,l.isEmpty)(o))return n;const s=Is({value:o,role:r,fieldType:a,propPath:t,format:i,utils:{formatter:c}});return Object.assign(n,{[t]:s})};let d={};return d=(0,l.reduce)(o,(t,r,o)=>{let{expression:a}=r;const{value:s}=n.dataExpression.evaluate({expression:a,variables:e});return i({propPath:o,marker:t,value:s})},d),d=(0,l.reduce)(a,(t,r,n)=>{let{fieldName:o,format:a}=r;const l=is(e,o);return i({propPath:n,marker:t,format:a,value:l,fieldType:s(o).getOrElse(void 0)})},d),d},u=async()=>{const{role:r}=e;try{const{items:n}=await a.fetchCurrentItems(i());e.markers=n.map(e=>d(e,t,r))}catch(e){o.log(new n.AppError("Failed setting markers",{cause:e}))}};return{...tu(e),isValidConnection:()=>ru(t),async onRecordsLoaded(){u()},async onCurrentViewChanged(){u()},async onCurrentIndexChanged(){const t=Ks({state:i()});e.setCenter((0,l.get)(e,["markers",t,"location"]))},async onCurrentRecordModified(){const{role:r}=e,n=en(i()),o=Ks({state:i()});e.markers[o]=d(n,t,r),e.setCenter((0,l.get)(e,["markers",o,"location"]))}}}]]),Cu=e=>{let{components:t,context:r}=e;const n=(e=>{let{recordStore:t,dispatch:n}=e;const a={fetchRecordById:(e,r)=>t(r).fold(()=>Ve.Maybe.Nothing(),t=>t.getRecordById(e)),fetchAll:e=>(async(e,t,r,n)=>{const o=await e(n).fold(()=>Wl.Empty(),e=>e.externalApi.getRecordsLimitedByMaxPageSize(t,r));return o.get()})(t,0,1e3,e),fetchCurrentItems:e=>xc(t,e).catch(()=>Wl.Empty().get()),fetchOne:()=>Fc(t,0,1),fetch:(e,r,n)=>Fc(t,e,r,n),getTotalPageCount:e=>Zs({state:e,recordStore:t}),getInitialData:()=>t().fold(()=>Wl.Empty(),e=>e.externalApi.getSeedRecords()),setCurrentIndex:(e,t)=>n(bc(e,t)),setFieldInCurrentRecordAndSynchronize:(e,t,r)=>{n(Nc({[e]:(0,l.cloneDeep)(t)},r))},refresh:()=>n(Ac()),resetUserInputFilters:()=>{const e=o.filter(e=>{let{role:t}=e;return t===O||he.includes(t)}),t=un(r.getState());e.length&&(e.forEach(e=>e.resetUserFilter()),t||a.refresh())},isCurrentRecordNew:e=>t().fold(()=>!1,t=>t.isNewRecord(Ks({state:e}))),isCurrentRecordPristine:e=>t().fold(()=>!1,t=>t.isPristine(Ks({state:e}))),isCursorPaging:()=>zs({recordStore:t}),hasNextPage:e=>al({state:e,recordStore:t}),getUniqueFieldValues:e=>t().fold(()=>!1,t=>t.getUniqueFieldValues(e))};return a})(r),o=t.map(e=>((e,t,r)=>(Pu.get(e.role)||(e.isInput?hu:nu))(e,t,r))(e,((e,t)=>{if(!e)return e;const{properties:r,totalCount:n}=e;return{...e,...r?{properties:(0,l.mapKeys)(r,(e,r)=>Ru(r)?wu({propName:r,getFieldType:()=>t(e.fieldName).getOrElse(null)}):r)}:{},...n?{totalCount:{prop:Ru(n.prop)?wu({propName:n.prop,getFieldType:()=>null}):n.prop}}:{}}})(e.connectionConfig,r.getFieldType),{...r,actions:n})).filter(e=>e.isValidConnection());return{bindAll:async()=>Promise.all(o.map(e=>(e.bind(),e.onRecordsLoaded()))),hideAll:()=>o.map(e=>e.hide()),showAll:()=>o.map(e=>e.show({ignoreInitiallyHidden:!0})),clearAll:()=>o.map(e=>e.clear()),onRecordsLoaded:()=>o.map(e=>e.onRecordsLoaded()),onCurrentViewChanged:()=>o.map(e=>e.onCurrentViewChanged()),onCurrentIndexChanged:()=>o.map(e=>e.onCurrentIndexChanged()),onCurrentRecordModified:(e,t)=>o.filter(e=>{let{id:r}=e;return!t||t!==r}).map(t=>t.onCurrentRecordModified(e))}},Ou=e=>{let{datasetId:t,masterIds:r,connectionsGraph:n}=e;const o=e=>n[t].includes(e.id)?"PRIMARY":r.some(t=>n[t].includes(e.id))?"DETAILS":"OTHER";return{isInsidePrimaryOrDetailsRepeater:e=>{let{parentRepeater:t}=e;return!!(r=t)&&["PRIMARY","DETAILS"].includes(o(r));var r},getDetailsRepeaters:e=>{const t=[];return e.forEach(e=>{let{parentRepeater:r}=e;r&&"DETAILS"===o(r)&&t.push(new Proxy(r,{get:(e,t)=>"role"===t?P:e[t]}))}),(0,l.uniqBy)(t,"uniqueId")}}},bu=[fe.FieldType.text,fe.FieldType.number,fe.FieldType.image,fe.FieldType.video,fe.FieldType.mediaGallery,fe.FieldType.richContent],Nu={[fe.FieldType.text]:"text",[fe.FieldType.number]:"number",[fe.FieldType.image]:"image",[fe.FieldType.video]:"video",[fe.FieldType.mediaGallery]:"gallery",[fe.FieldType.richContent]:"rich-content"},Du=e=>{let{recordStore:t,state:r,schema:n,connections:o,isDpItemDataset:a}=e;if(!a&&!o.length)return{collectionData:void 0};const i=en(r);if(!i)return{collectionData:void 0};const{id:s,displayName:l,displayField:c,fields:d}=n,u=a&&c?i[c]:void 0,p=a?1:(e=>{let{recordStore:t}=e;const r=Xs({recordStore:t});return r?r.total:null})({recordStore:t})??void 0;return{title:u,collectionData:{id:s,name:l||s,totalCount:p,fields:Au({connections:o,fields:d,currentRecord:i}),primary:a}}},Au=e=>{let{connections:t,fields:r,currentRecord:n}=e;const o=t.reduce(xu,{});return Object.entries(r).filter(e=>{let[t,r]=e;return!r.pii&&!r.isDeleted&&bu.includes(r.type)}).map(e=>{var t;let[r,a]=e;return{key:r,type:Nu[a.type],label:a.displayName,connected:!(null==(t=o[r])||!t.length),value:Fu({key:r,field:a,currentRecord:n,connections:o[r]||[]})}})},Fu=e=>{let{key:t,field:r,currentRecord:n,connections:o}=e;const{type:a}=r,i=n[t];switch(a){case fe.FieldType.image:return(e=>"string"==typeof e&&""!==e)(i)?Lu({src:i},o):void 0;case fe.FieldType.video:return(e=>"string"==typeof e&&""!==e)(i)?Uu({src:i},o):void 0;case fe.FieldType.mediaGallery:return(e=>Array.isArray(e)&&e.every(e=>{if("object"==typeof e&&null!==e&&"type"in e&&"string"==typeof e.type&&"src"in e&&"string"==typeof e.src)switch(e.type){case"image":return Vu(e.src);case"video":return Gu(e.src)}return!1}))(i)?Mu(i,o):[];case fe.FieldType.text:return(e=>"string"==typeof e)(i)?i:void 0;case fe.FieldType.number:return(e=>"number"==typeof e)(i)?i:void 0;case fe.FieldType.richContent:return(e=>"object"==typeof e&&null!==e&&"nodes"in e&&Array.isArray(e.nodes))(i)?i:void 0;default:throw new Error(`Unsupported field type: ${a}`)}},xu=(e,t)=>{var r;const n=(null==t||null==(r=t.config)?void 0:r.properties)||{};return Object.values(n).map(e=>{let{fieldName:t}=e;return t}).forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)}),e},Lu=(e,t)=>{let{src:r}=e;const n=t.some(e=>{var t,r,n;let{role:o,config:a}=e;return o===x&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||o===F&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||o===N&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)});return{url:r,...ku(r),connectedToSrc:n}},Uu=(e,t)=>{let{src:r,title:n,description:o}=e;const a=t.some(e=>{var t,r,n;let{role:o,config:a}=e;return o===x&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||"videoPlayerRole"===o&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||"videoRole"===o&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)});if(!Gu(r))return{thumbnailUrl:void 0,title:n,description:o,uploadDate:void 0,connectedToSrc:a};const[i,s]=r.match(/posterUri=(\w+)/)||[],[l,c]=r.match(/posterWidth=(\d+)/)||[],[d,u]=r.match(/posterHeight=(\d+)/)||[];return{thumbnailUrl:Bu({uri:s,width:Number(c),height:Number(u)}),title:n,description:o,uploadDate:void 0,connectedToSrc:a}},Mu=function(e,t){return void 0===e&&(e=[]),e.map(e=>"image"===e.type?Lu(e,t):Uu(e,t),t)},ku=e=>{if(!Vu(e))return{height:void 0,width:void 0};const[t,r]=e.match(/originHeight=(\d+)/)||[],[n,o]=e.match(/originWidth=(\d+)/)||[];return{height:r?Number(r):void 0,width:o?Number(o):void 0}},Bu=e=>{let{uri:t,width:r,height:n,filename:o="image.ext"}=e;return`wix:image://v1/${t}/${o}#originWidth=${r}&originHeight=${n}`},Vu=e=>e.startsWith("wix:image://"),Gu=e=>e.startsWith("wix:video://"),ju=e=>{let{compId:t="",role:r="textRole",config:n={}}=e;return{compId:t,role:r,config:n}},$u=function(e,t,r){void 0===t&&(t=void 0),void 0===r&&(r=void 0);const{compId:o,role:a,config:{properties:i={},expressions:s={},behaviors:l=[],totalCount:c}}=e,d=Ku(l),u=t??n.Connection.makeDescriptor({behaviors:d});for(const[e,t]of Object.entries({...i,...s})){const n=e.split(".");if(n.length>1){const o=n[0],i=n.slice(1).join("."),s=ju({role:a,config:{properties:{[i]:t}}});u.properties={...u.properties,[o]:$u(s,u.properties[o],r??e)}}else"$text"===e?u.dynamicProperties.text=zu(t):"link"===e?(u.extraData=Ju(t),u.dynamicProperties.link=Hu(t)):(u.extraData=Ju(t),u.properties[e]=qu(a,r??e,t))}return c&&(u.dynamicProperties.totalCount=Yu(c)),o?n.Connection.make({compId:o,...u}):u},qu=(e,t,r)=>{let{fieldName:n,expression:o,format:a}=r;return{fieldName:n,expression:o,format:a,...Wu(e,t)}},Wu=(e,t)=>{var r;const n=null==(r=Xu[e])?void 0:r[t];return(Zu[n]??Zu.default)()},zu=e=>{let{fieldName:t,format:r,expression:n,...o}=e;return{fieldName:t,format:r,expression:n,propName:"text",typeMapping:{richtext:"html",url:"_hack_link"},extraData:Ju(o)}},Hu=e=>{let{fieldName:t}=e;return{fieldName:t,propName:"link"}},Yu=e=>{let{prop:t}=e;return{propName:"$text"===t?"text":t}},Ju=e=>{let{linkRel:t,linkTarget:r}=e;const n=[];return void 0!==t&&n.push(["rel",t]),void 0!==r&&n.push(["target",r]),n.length>0?Object.fromEntries(n):{}},Ku=e=>{let[t]=e;return t?{onSubmit:{type:Qu[t.type],show:"show",hide:"hide"}}:{}},Qu={saveSuccessFeedback:"success",saveFailureFeedback:"failure"},Xu={[b]:{$text:fe.FieldType.text,"style.color":fe.FieldType.color},[N]:{src:fe.FieldType.image,alt:fe.FieldType.text,tooltip:fe.FieldType.text,link:fe.FieldType.url},[D]:{label:fe.FieldType.text,link:fe.FieldType.url,"accessibility.ariaLabel":fe.FieldType.text,"style.color":fe.FieldType.color,"style.iconColor":fe.FieldType.color,"style.borderColor":fe.FieldType.color,"style.backgroundColor":fe.FieldType.color,"style.hover.color":fe.FieldType.color,"style.hover.iconColor":fe.FieldType.color,"style.hover.borderColor":fe.FieldType.color,"style.hover.backgroundColor":fe.FieldType.color,"style.disabled.color":fe.FieldType.color,"style.disabled.iconColor":fe.FieldType.color,"style.disabled.borderColor":fe.FieldType.color,"style.disabled.backgroundColor":fe.FieldType.color},[A]:{checked:fe.FieldType.boolean},[z]:{value:fe.FieldType.address}},Zu={[fe.FieldType.text]:()=>({dataType:"text"}),[fe.FieldType.image]:()=>({dataType:"text"}),[fe.FieldType.boolean]:()=>({dataType:"boolean"}),[fe.FieldType.address]:()=>({dataType:"schema",schema:{}}),[fe.FieldType.color]:()=>({dataType:"unknown"}),[fe.FieldType.url]:()=>({dataType:"text"}),default:()=>({dataType:"unknown"})},ep=e=>{const t=np(e);return{id:e.uniqueId,setData:t=>{const{connectionConfig:{properties:r={}}}=e,n=[];for(const e of Object.keys(r))if(e.includes(".")){const t=e.split(".").slice(0,-1);for(const e of t)n.includes(e)||n.push(e)}const o=tp({component:e,data:t,propsWithNesting:n});if(o.length>0){const{errors:e,props:t}=o.reduce((e,t)=>{let[r,n]=t;return{errors:[...e.errors,n],props:[...e.props,r]}},{errors:[],props:[]});throw new AggregateError(e,`Failed to set properties: ${t.join(", ")}`)}},bind:()=>{},execute:function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];e[r](...o),op(t,e,r)}}},tp=e=>{let{component:t,data:r,propsWithNesting:n,propErrors:o=[],parentProp:a=""}=e;for(const[e,i]of Object.entries(r)){const r=a?`${a}.${e}`:e;if(n.includes(e))tp({propsWithNesting:n,propErrors:o,data:i,component:t[e],parentProp:r});else if("_hack_link"===e)rp(t,i);else try{t[e]="color"===e?i||void 0:i}catch(e){o.push([r,e])}}return o},rp=(e,t)=>{e.text=t;const{html:r}=e;e.text="",e.html=(0,l.unescape)(r)},np=e=>{var t;if(f.features.accessibilityBindings&&(null==(t=e.connectionConfig.behaviors)?void 0:t.length)>0){const t=e.html,r=`<div aria-hidden="true">${t}</div>`;e.html=r,e.accessibility.ariaLive="polite";return{originalHtml:t,originalHtmlHiddenFromAccessibilityTree:r,announcement:{state:{type:"untriggered"}}}}},op=(e,t,r)=>{if(e){const{originalHtml:n,originalHtmlHiddenFromAccessibilityTree:o,announcement:a}=e;if("show"===r){if("untriggered"===a.state.type){const e=setTimeout(()=>{t.html=`${o}<div style="height:0;width:0;overflow:hidden">${n}</div>`,a.state={type:"triggered"}},150);a.state={type:"pendingTriggering",timerId:e}}}else"hide"===r&&("pendingTriggering"===a.state.type?(clearTimeout(a.state.timerId),a.state={type:"untriggered"}):t.html=o)}},ap=(e,t)=>r=>{let{shouldCollectSeoData:o,controllerConfig:a,datasetType:i,connections:s,connectionsGraph:c,isScoped:d,datasetScope:u,dataProvider:p,dependencyManager:h,seoManager:g,firePlatformEvent:v,dynamicPagesData:_,datasetId:E,fixedRecordId:I,recordStoreService:T,updatedCompIds:S,markControllerAsRendered:w,markDatasetDataFetched:R,renderingRegularControllers:P,modeIsLivePreview:C,modeIsSSR:O,schemasLoading:b,listenersByEvent:N,dataset:A}=r;const F=ji.getCollectionId(A),x=s.filter(e=>!(e=>{let{role:t}=e;return he.includes(t)})(e)||e.config),L=!!I,{logger:U,platform:{user:M,settings:{locale:B,env:{live:V}},utils:{media:j},timers:{queueMicrotask:$},location:{pageUrl:q,onChange:z}},features:H}=f,{setConnectedComponents:Y,getConnectedComponents:J}=(()=>{let e;return{setConnectedComponents:t=>e=t,getConnectedComponents:()=>e}})(),K=[],{store:X,subscribe:Z,onIdle:ee}=$c(U,E),te=cd(v),{fireEvent:re,register:ne}=te;K.push(te.dispose);const oe=new m({datasetId:Qd(E),scopedDatasetId:d?E:void 0,getState:X.getState,getSchema:function(e){return void 0===e&&(e=F),p.getSchema(e)}}),ae=oe.subscribe(N);K.push(...ae),X.dispatch(Kt({controllerConfig:a,connections:x,isScoped:d,datasetType:i,pageOffset:ji.getOffset(A)}));const{datasetIsVirtual:ie,datasetIsReal:se,datasetIsDeferred:le,datasetIsWriteOnly:ce,datasetIsRouter:de,dynamicPageNavComponentsShouldBeLinked:ue}=(pe=X.getState(),{datasetIsRouter:Yr(pe),datasetIsMaster:Jr(pe),datasetIsVirtual:Kr(pe),datasetIsReal:Qr(pe),datasetIsDeferred:Xr(pe),datasetIsWriteOnly:zr(pe),datasetCollectionName:kr(pe),dynamicPageNavComponentsShouldBeLinked:Zr(pe)});var pe;const fe=Br(X.getState()),me=Vr(X.getState()),ge=function(e){return void 0===e&&(e=F),Ve.Maybe.fromNullable(p.getSchema(e))},ye=e=>{const t=ge(F),r=p.getReferencedSchemas(F);return t.chain(t=>Ve.Maybe.fromNullable(Ln(t,r)(e)))},ve=((e,t,r)=>({dataBinding:es(e),currentUser:Zi(),userInput:pl({getConnectedComponents:t,getFieldType:r}),slug:()=>Ve.Maybe.fromNullable(f.platform.location.path).map(e=>e[e.length-1])}))(e=>h.getDependencyById(e,u),J,ye),_e=wl({valueResolvers:ve,getConnectedComponents:()=>qr(X.getState())?J():[],getFieldType:ye,getUserFilterInitialData:()=>yn(X.getState()),wasSetFilterCalled:(0,l.flow)(()=>X.getState(),un)}),Ee=(e=>{let{recordStoreService:t,getFilter:r,getSort:n,getPageSize:o,datasetId:a,filterResolver:i,getSchema:s,fixedRecordId:l}=e;return e=>{const c=o();return t.chain(t=>{if(e)return Ve.Result.fromMaybe(s().map(t=>Un(e,t)),`cannot resolve referenced collection name for field ${e}`).map(e=>t({pageSize:c,sort:null,filter:null,datasetId:a,referencedCollectionName:e,fixedRecordId:l}));{const e=r();return Ve.Result.fromMaybe(i(e).map(e=>t({pageSize:c,sort:n(),filter:e,datasetId:a,referencedCollectionName:null,fixedRecordId:l})),"could not resolve dynamic filter")}})}})({recordStoreService:T,getFilter:(0,l.flow)(()=>X.getState(),Br),getSort:(0,l.flow)(()=>X.getState(),Vr),getPageSize:()=>Hs({state:X.getState()}),datasetId:E,filterResolver:_e,getSchema:ge,fixedRecordId:I}),Ie=ue?(e=>{let{dataProvider:t,dynamicPagesData:r,collectionName:n}=e;return{getNextDynamicPageUrl:()=>Bd({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"asc"}),getPreviousDynamicPageUrl:()=>Bd({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"desc"})}})({dataProvider:p,dynamicPagesData:_,collectionName:F}):null;let Te,Se;ue&&(Z(Dd(Ie)),X.dispatch(Mc(x)));const we=new Promise((e,t)=>{Te=e,Se=t}),Re=d?void 0:()=>we;d||ne("datasetReady",Te),K.push(T.map(e=>e.onChange(Xd(X.getState,X.dispatch))).getOrElse(()=>{}));const{fetchingInitialData:Pe,resolveUserInputDependency:Ce,resolveDataSourceDependency:Oe}=zd({dependencyManager:h,shouldFetchInitialData:a&&!ce,recordStore:Ee,store:X,filter:fe,sort:me,datasetIsDeferred:le,modeIsSSR:O,queueMicrotask:$,datasetIsReal:se,collectionId:F,filterResolver:_e,getSchemas:()=>p.getSchemas(),schemasLoading:b,getUserFilterInitialData:()=>p.getUserFilterInitialData(E),datasetId:E}),be=[Pe];x.some(e=>{var t;return Object.keys((null==e||null==(t=e.config)?void 0:t.expressions)||{}).length>0})&&se&&be.push(n.dataExpression.initialize());const Ne=ld({store:X,recordStore:Ee,dataProvider:p,eventListeners:te,controllerStore:t,datasetId:E,datasetType:i,collectionId:F,isFixedItem:L,siblingDynamicPageUrlGetter:Ie,onIdle:ee,dispatcher:oe,onReadyAsync:Re,resolveDataSourceDependency:Oe}),De=Ne(!1);Pe.then(()=>{R();const e=Ee().fold(()=>{},e=>e.getSeedRecords().matchWith({Empty:()=>{},Results:e=>{let{items:t}=e;return t[0]}}));e&&X.dispatch(Uc.setCurrentRecord(e,ji.getOffset(A)))});d&&!L&&h.getDependenciesByFilter(fe,u).forEach(e=>{let{masterDataset:{api:t}}=e;Zd({detailsDatasetApis:[De],store:X,masterDatasetApi:t,controllerConfig:a,unsubscribeHandlers:K})});o&&se&&!le&&Promise.all([Pe,b]).then(()=>{let e={};try{e=Du({isDpItemDataset:de,recordStore:Ee,state:X.getState(),schema:p.getSchema(F),connections:x})}catch(e){U.log(new n.AppError(`Failed to extract seo data for dataset ${E}`,{cause:e}))}g.submitSeoData(e)});const Ae=async function(r){M.onLogin(()=>{(()=>{const e=Ks({state:X.getState()}),t=Ee().fold(()=>!1,t=>t.isPristine(e));return t&&!ce})()&&De.refresh()});const o=(e=>!(0,l.isEmpty)(Ki(_l,e)))(fe);o&&z(De.refresh);const{components:s,detailsDatasetApis:d,originalComponents:u}=r(x),m=Kd({updatedCompIds:S,datasetIsReal:se,connectionsGraph:c,components:s});Y(m);const y=((e,t)=>{let{datasetId:r,connectionsGraph:n,datasetIsReal:o,getDependencies:a}=t;if(!o)return e;const{isInsidePrimaryOrDetailsRepeater:i,getDetailsRepeaters:s}=Ou({datasetId:r,connectionsGraph:n,masterIds:a().map(e=>e.masterDatasetId)}),l=e.filter(e=>!i(e));return l.push(...s(e)),l})(m,{datasetId:E,datasetIsReal:se,connectionsGraph:c,getDependencies:()=>h.getDependenciesByFilter(fe)}),v=y.filter(e=>!pp(e,{features:H,datasetIsDeferred:le,modeIsLivePreview:C,controllerConfig:a}));if(Zd({detailsDatasetApis:d,masterDatasetApi:De,dependencyManager:h,controllerConfig:a,unsubscribeHandlers:K}),se&&await b,Ce(),$i(A)&&await Pe,!$r(X.getState())||!p.hasSchema(a.dataset.collectionName))return Pe.then(()=>{w(),h.resolveDependants(E),X.dispatch(Vc(!0)),re("datasetReady")}),Promise.resolve();const _=B?(({locale:e,timeZone:t}={})=>{if(!e)throw new Error('A "locale" parameter is required for wixFormatting');return{formatDateTime(r,n,{locale:o,timeZone:a}={}){const i={...wd[n],timeZone:a||t};return new Intl.DateTimeFormat(o||e,i).format(r)},dateFormats:Sd}})({locale:B}):null,I=Cu({components:v,context:{connections:x,recordStore:Ee,dispatch:X.dispatch,getState:X.getState,datasetApi:De,eventListeners:te,dispatcher:oe,getFieldType:ye,getSchema:ge,controllerFactory:e,controllerStore:t,modeIsLivePreview:C,wixFormatter:_,datasetId:E}}),{formatter:T,dataStore:R,errorReporter:N,mediaUtils:L}=ip({wixFormatter:_,getSchema:ge,recordStore:Ee,logger:U,dataProvider:p,wixMedia:j}),$=up(y,u,{features:H,datasetIsDeferred:le,modeIsLivePreview:C,controllerConfig:a}),{components:q,connections:J}=lp($),ee={livePreview:{enabled:C,updatedComponentIds:S,dataIsInvalidated:!1}},ae=(0,n.RenderDataToComponents)({config:ee,formatter:T,dataStore:R,errorReporter:N,dataExpression:n.dataExpression,mediaUtils:L}),de=(0,n.BindDataToComponents)({config:ee,datasetEvents:n.datasetEvents,errorReporter:N});async function ue(e){let{phase:t}=e;try{await ae({dataset:cp({datasetId:E,controllerConfig:a,recordStore:Ee,store:X}),connections:J,components:q})}catch(e){throw U.log(n.CoreError.of(`CVCI - renderDataToComponents failed - phase ${t}`,{cause:e})),e}}dp({register:ne,dispatcher:oe,datasetEvents:n.datasetEvents,dataset:cp({datasetId:E,controllerConfig:a,recordStore:Ee,store:X})}),Z(((e,t,r,n,o,a,i,s,c)=>{const d=Cd(e,t,r,n,o,a,i,s,c),u=e=>{let{from:t,to:r,hasChanged:n,hasChangedToFalse:o,hasChangedToTrue:a,hasChangedToMatch:i}=e;const s=tn(r),l=tn(t),c=nn(r),u=pn(r),p=[];return(i(nn,e=>e>=0&&e!==s)||a(pn))&&p.push(d.goToRecordByIndex(l,c,u)),(n(tn)&&l>=0||o(dn)&&0===s)&&p.push(d.notifyIndexChange(s)),p},p=e=>{let{from:t,to:r,hasChanged:n,hasChangedToMatch:o,hasChangedToTrue:a}=e;const i=tn(r),s=en(r),c=en(t),u=[];Bl(c,s)?(0,l.isEqual)(c,s)||(u.push(d.updateComponents(an(r),c)),u.push(d.fireEvent("itemValuesChanged",(0,l.cloneDeep)(c),(0,l.cloneDeep)(s)))):null==c||null==s||n(tn)||u.push(d.updateComponents());const p=on(r);return o(on,e=>null!=e)&&u.push(d.setFieldsInCurrentRecord(p,i,an(r))),a(mn)&&u.push(d.revertChanges(i,rn(r))),a(hn)&&u.push(d.removeCurrentRecord(i)),u},f=e=>{let{to:t,hasChanged:r,hasChangedToFalse:n,hasChangedToTrue:o}=e;const a=[];return r(Od)&&a.push(d.refresh(tn(t),rn(t),zr(t))),r(Gr)&&a.push(d.notifyRecordSetLoaded()),o(dn)&&a.push(d.refresh(tn(t),rn(t),zr(t))),n(dn)&&a.push(d.notifyRecordSetLoaded()),o(fn)&&a.push(d.updateCurrentView()),a},h=e=>{let{to:t,hasChangedToTrue:r}=e;const n=tn(t),o=en(t);if(r(gn))return d.saveRecord(n,o)},m=e=>{let{to:t,hasChangedToNotNull:r}=e;const n=[];return r(sn)&&n.push(d.newRecord(sn(t),rn(t))),n};return e=>(0,l.flatten)([u,p,f,h,m].map(t=>t(e)))})(Ee,I,ye,te.executeHooks,E,v,re,oe,ue)),K.push(Td({store:X,logger:U,recordStore:Ee,datasetId:E,components:v}));const pe=Yd(v.filter(e=>{let{role:t}=e;return![G,Q].includes(t)}),ye);X.dispatch(Uc.setDefaultRecord(pe)),ce&&await X.dispatch(Uc.initWriteOnly(ie)),le&&(I.hideAll(),O&&I.clearAll());const he=Promise.all(be).then(async()=>{if(le&&await P,!O)try{((e,t,r,n,o,a)=>{if(n)return;const i=kr(e);if(!i)return;const s=a.fold(()=>i,e=>e.displayName),l=jr(e),c=!!en(e),{logger:d,platform:{settings:{env:{editor:u}}}}=f;c&&[vn,_n].includes(l)&&t.find(e=>{let{role:t,config:r}=e;return Be(t,r)})&&d.log(new wn({id:u?153:152,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:l})),ut(jr(e),t)&&d.log(new wn({id:u?157:156,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:l}))})(X.getState(),x,i,ie,E,ge(F))}catch(e){U.log(new n.AppError("Failed to report dataset active BI",{cause:e}))}!function(){try{de({dataset:cp({datasetId:E,controllerConfig:a,recordStore:Ee,store:X}),connections:J,components:q})}catch(e){throw U.log(n.CoreError.of("CVCI - bindDataToComponents failed",{cause:e})),e}}(),oe.dispatch("dataInitialLoadSuccess"),ue({phase:"pageReady"}),await I.bindAll(),se&&await(e=>Promise.all(e.getAll().map(e=>new Promise(t=>{e.staticExports.onReady(t)}))))(t),le&&I.showAll(),h.resolveDependants(E),X.dispatch(Vc(!0)),V&&function(e,t){void 0===t&&(t=[]);return ji.isReal(e)&&!ji.isDeferred(e)&&!ji.isWriteOnly(e)&&!ji.isPaginationCursor(e)&&function(e){return e.some(e=>{var t;return(null==e?void 0:e.role)===W||(null==e?void 0:e.role)===k||(null==e?void 0:e.role)===D&&["loadMore","next","nextPage","previous","previousPage"].includes(null==e||null==(t=e.config)||null==(t=t.events)||null==(t=t.onClick)?void 0:t.action)})}(t)}(A,x)&&await g.renderDatasetSeoTags({totalPages:ji.isItemPageRouter(A)?1:De.getTotalPageCount(X.getState()),currentPage:De.getCurrentPageIndex(X.getState()),queryParam:ji.isRouter(A)?"dynamic_page":`${E}_page`}),re("datasetReady")});return le?(w(),Promise.resolve()):(he.then(w),he)},Fe=Ne(!0);return{pageReady:y(ie?Ae:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return U.log(new Le("dataset/pageReady",()=>Ae(...t)))},e=>(Se(e),U.logError(e,"Dataset pageReady callback failed",{datasetId:E}))),staticExports:Fe,dispose:()=>{K.forEach(e=>e())},api:De,userFilterInitialDataPromise:Pe.then(e=>{let[t,r]=e;return r})}};const ip=e=>{let{wixFormatter:t,getSchema:r,recordStore:o,logger:a,dataProvider:i,wixMedia:s}=e;const l={report:e=>a.log(e)};return{formatter:{...t,formatDateTime:(e,r,n)=>(null==t?void 0:t.formatDateTime(new Date(e),r,n))??e},dataStore:{readSchema:e=>r(e).chain(e=>e?Ve.Maybe.Just(n.Schema.make(e)):Ve.Maybe.Nothing()).getOrElse(null),readSchemas:e=>Object.entries(i.getSchemas()).reduce((t,r)=>{let[o,a]=r;return e.includes(o)?[...t,n.Schema.make(a)]:t},[]),readRecords:()=>Uc.getAllScopeRecordsSync(o).items.map(sp)},mediaUtils:n.MediaUtils.of(s),errorReporter:l}},sp=e=>{const t=Object.entries(e).map(e=>{let[t,r]=e;return[t,r&&r.constructor===Object?sp(r):r instanceof Date?r.toISOString():r]});return Object.fromEntries(t)},lp=e=>({components:e.map(ep),connections:e.map(e=>{let{role:t,uniqueId:r,connectionConfig:n}=e;return $u({role:t,compId:r,config:n})})}),cp=e=>{var t;let{datasetId:r,controllerConfig:o,recordStore:a,store:i}=e;return n.Dataset.make({id:r,collectionId:o.dataset.collectionName,mode:o.dataset.readWriteType,pagination:n.Dataset.makePagination({type:zs({recordStore:a})?"cursor":"offset",offset:(Qs({state:i.getState()})-1)*o.dataset.pageSize,pageSize:o.dataset.pageSize,total:(null==(t=Xs({recordStore:a}))?void 0:t.total)??0}),currentRecordIndex:tn(i.getState())})},dp=e=>{let{register:t,dispatcher:r,datasetEvents:n,dataset:o}=e;t("datasetReady",()=>n.emit(o,"ready")),t("datasetError",()=>n.emit(o,"error")),t("beforeSave",()=>n.emit(o,"recordSaveAttempt")),t("afterSave",(e,t)=>n.emit(o,"recordSaveSuccess",{nextRecord:t,prevRecord:e})),t("currentIndexChanged",e=>n.emit(o,"currentRecordSwitch",{nextIndex:e})),t("itemValuesChanged",(e,t)=>n.emit(o,"recordChange",{nextRecord:t,prevRecord:e})),r.subscribe("datasetSaveError",()=>n.emit(o,"recordSaveFailure")),r.subscribe("dataInitialLoadSuccess",()=>n.emit(o,"dataInitialLoadSuccess")),r.subscribe("dataLoadSuccess",()=>n.emit(o,"dataLoadSuccess"))},up=(e,t,r)=>{let{features:n,datasetIsDeferred:o,modeIsLivePreview:a,controllerConfig:i}=r;const s=e.map(e=>{let{id:t}=e;return t});return t.filter(e=>s.includes(e.uniqueId)&&Boolean(e.connectionConfig)&&pp(e,{features:n,datasetIsDeferred:o,modeIsLivePreview:a,controllerConfig:i}))},pp=(e,t)=>{var r;let{features:n,datasetIsDeferred:o,modeIsLivePreview:a,controllerConfig:i}=t;const{role:s,connectionConfig:l}=e;return n.enableNewCore&&!o&&(n.newCoreLivePreview||!a)&&(n.newCoreReferences||!(null!=(r=i.dataset.includes)&&r.length))&&fp(s,{features:n})&&(n.newCoreFormatters||!mp(l))&&(n.newCoreExpressions||!gp(l))&&!hp(l)},fp=(e,t)=>{let{features:r}=t;return["textRole",r.newCoreImageStaticBinding&&"imageRole",r.newCoreSiteButtonStaticBinding&&"siteButtonRole"].filter(Boolean).includes(e)},hp=e=>Object.keys((null==e?void 0:e.events)||{}).length>0,mp=e=>Object.values((null==e?void 0:e.properties)??{}).some(e=>Boolean(null==e?void 0:e.format)),gp=e=>Object.entries((null==e?void 0:e.expressions)||{}).length>0,yp=(e,t)=>{const r=Cc(e),n={createRealDataset:()=>o({...t,isScoped:!1}),createScopedDetailsDataset:e=>{let{datasetScope:r}=e;const n=f.datasetStore[t.datasetId],a=ji.makeVirtual(n,{scopeId:r.repeaterId,itemId:r.itemId});return h({datasetStore:{...f.datasetStore,[a.config.id]:a}}),o({...t,isScoped:!0,firePlatformEvent:l.noop,datasetId:a.config.id,datasetScope:r,dataset:a})},createScopedDataset:e=>{let{datasetScope:r,fixedItem:n}=e;const{dataProvider:a,controllerConfig:i,dynamicPagesData:s}=t,c=(0,l.cloneDeep)(i),d={items:[n]};c.dataset.filter=a.createSimpleFilter("_id",n._id);const{collectionName:u}=i.dataset;a.setCollectionData({collectionId:u,data:d});const p=f.datasetStore[t.datasetId],m=ji.makeVirtual(p,{scopeId:r.repeaterId,itemId:n._id,scopedToItem:!0});return h({datasetStore:{...f.datasetStore,[m.config.id]:m}}),o({...t,isScoped:!0,controllerConfig:c,firePlatformEvent:l.noop,dynamicPagesData:s,datasetId:m.config.id,fixedRecordId:r.itemId,dataset:m})}},o=ap(n,r);return n},vp=e=>Pl(e).map(e=>{let{filterExpression:{filterId:t}}=e;return t});var _p=a(1406);const Ep=e=>{let{seo:t,pageUrl:r}=e;const{logger:o}=f;let a;const i=(e=>{const t=new URL(e);return t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),t.href})(r),s={title:void 0,pageUrl:i,collections:[]};return{submitSeoData:e=>{let{title:t,collectionData:r}=e;a||(t&&(s.title=t),r&&s.collections.push(r))},renderSeoTagsOnce:()=>(a||(a=t.renderSEOTags({itemType:_p.ITEM_TYPES.WIX_DATA_PAGE_ITEM,itemData:s}).catch(e=>{o.log(new n.AppError("Failed to render seo tags",{cause:e}))})),a),renderDatasetSeoTags:e=>{let{totalPages:r,currentPage:a,queryParam:i}=e;return t.renderSEOTags({itemType:"PAGINATED_COMPONENT",itemData:{pagination:{totalPages:`${r}`,currentPage:`${a}`,queryParam:i}}}).catch(e=>{o.log(new n.AppError("Failed to render dataset seo tags",{cause:e}))})}}};class Ip{constructor(){this._datasetConfigs=new Map}get datasetConfigs(){return this._datasetConfigs}}function Tp(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Sp(e,t,r){return e.set(wp(e,t),r),r}function wp(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Rp=new WeakMap;class Pp{constructor(){Tp(this,Rp,void 0)}set(e){let{action:t,datasetId:r}=e;Sp(Rp,this,{action:t,datasetId:r})}get(){return t=this,(e=Rp).get(wp(e,t));var e,t}clear(){Sp(Rp,this,void 0)}}class Cp{constructor(e){let{platform:t,dataFetcher:r,warmupCache:n,staticCache:o,features:a,listenersByEvent:i,logger:s,i18n:l,global:c}=e;const d=new En(s,c);h({platform:t,features:a,dataFetcher:r,i18n:l,appState:new Ip,logger:d,errorReporting:In(d),breadcrumbReporting:Tn(d),verboseReporting:Sn(d),datasetStore:{},lastAction:new Pp}),this._listenersByEvent=i,this._dataProvider=new qi,this._warmupCache=n,this._staticCache=o,this._features=a,this._logger=d,this._recordStoreCache={}}initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;try{return this._logger.log(new Le("databinding/createControllers",()=>this._initializeDatasets({datasetConfigs:t,firePlatformEvent:r})))}catch(e){return this._logger.logError(e,"Datasets initialisation failed"),[]}}_initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;const{platform:{postMessage:n,settings:{mode:{name:o,csr:a,ssr:i,verbose:s},env:{livePreview:c,live:d}},seo:u,location:p}}=f,m=t.reduce((e,t)=>{const r=ji.initCurrentPage(t,p.queryParams);return e[ji.getId(t)]=r,e},f.datasetStore);h({datasetStore:m});const y=Fl(t.map(e=>m[ji.getId(e)])),v=this._updateDatasetConfigsState(y),_=this._features.warmupData,E=[],I=[],T=[],{resolve:S,promise:w}=new g,R=Op(y),P=this._staticCache.getSchemas(),O=P?R.regularDatasetCollectionIds.reduce((e,t)=>(e[t]&&delete e[t],e),P):{},b={..._&&a&&this._warmupCache.getSchemas()||{},...O,...bp(t)};this._dataProvider.setSchemas(b);const N=this._logger.log(new Le("databinding/loadSchemas",()=>this._dataProvider.loadSchemas(R.allDatasetCollectionIds).then(()=>_&&i&&this._warmupCache.setSchemas(this._dataProvider.getSchemas()))));this._dataProvider.setDatasetConfigs(y.map(e=>{let{config:{dataset:{collectionName:t}},compId:r,type:n}=e;return{collectionId:t,datasetId:r,type:n}}));const D=a&&_&&this._warmupCache.getDataStore();D&&this._dataProvider.setStore(Ap(D));const A=this._staticCache.getDataStore();A&&this._dataProvider.setStaticStore(Ap(A)),this._dataProvider.createInitialDataRequest(this._getInitialDataRequestConfigs(y,v));const F=y.reduce((e,t)=>{let{compId:r,connections:n}=t;return e[r]=n.map(e=>{let{compId:t}=e;return t}),e},{}),x=(e=>{let{datasetConfigs:t}=e;const r={},n={},o=(e,t)=>{const o=n[e];if(!o)return;const a=r[o.masterDatasetId];return a?{...o,masterDataset:t?{...a,api:a.api.inScope(t.repeaterId,t.itemId)}:a}:o};return t.forEach(e=>{let{id:t,connections:r}=e;r.forEach(e=>{let{role:r,config:o}=e;r===C&&Object.entries(o.filters).forEach(e=>{let r,[o,{fieldName:a}]=e;n[o]={id:o,fieldName:a,masterDatasetId:t,isResolved:!1,promise:new Promise(e=>r=e),resolve:()=>{n[o].isResolved=!0,r()}}})})}),{resolveDependants:e=>Object.values(n).forEach(t=>{let{id:r,masterDatasetId:o}=t;e===o&&n[r].resolve()}),getDependencyResolutionPromise:e=>{const t=vp(e).flatMap(e=>n[e]&&!n[e].isResolved?[n[e].promise]:[]);return t.length>0?Promise.all(t):void 0},getDependencyById:o,getDependenciesByFilter:(e,t)=>vp(e).flatMap(e=>o(e,t)||[]),registerDataset:e=>{let{id:t,api:n,config:o}=e;r[t]={id:t,api:n,config:o}}}})({datasetConfigs:y}),L=y.some(e=>{let{type:t,dynamicPageData:r}=e;return t===gr&&!(null==(n=null==r?void 0:r.dynamicUrl)||!n.match(/\{.+\}/));var n}),U=L&&y.some(e=>{let{type:t,dynamicPageData:r}=e;return t===gr&&(null==r?void 0:r.seoV2)}),M=d&&L&&U,k=Ep({seo:u,pageUrl:p.pageUrl}),B=(e=>{let{global:t,postMessage:r,enabled:n}=e;const o={datasetSize:{}};return t._dataBindingViewerStatusForEditorInterval&&t.clearInterval(t._dataBindingViewerStatusForEditorInterval),n&&(t._dataBindingViewerStatusForEditorInterval=t.setInterval(()=>{r({app:"dataBinding",type:"viewerStatusForEditor",message:JSON.stringify(o)})},1e3)),{update:e=>{n&&e(o)}}})({global:self,postMessage:n,enabled:s}),V=y.map(e=>{const{type:t,config:n,connections:s,compId:d,livePreviewOptions:{shouldFetchData:u,compsIdsToReset:p=[]}={},dynamicPageData:f}=e,{datasetIsRouter:h,datasetIsDeferred:m}=n.datasetStaticConfig;this._logger.log(new Ue({category:"createControllers",message:"warmup data contents",data:{datasetId:d,datasetType:t,mode:o,warmupData:Boolean(D)}}));const y=(e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,controllerConfig:a,statusForEditor:i}=e;return Ve.Result.fromNullable(a,"missing controller configuration").chain(e=>{let{dataset:t}=e;return Ve.Result.fromNullable(t,"controller configuration is missing dataset object")}).chain(e=>{let{collectionName:t}=e;return Ve.Result.fromNullable(t,"dataset is not connected to a collection")}).map(e=>{const s=(0,l.get)(a,["dataset","includes"]),c=(0,l.get)(a,["dataset","nested"]),d=(0,l.get)(a,["dataset","cursor"]),u=(0,l.get)(a,["dataset","readWriteType"]),p=(0,l.get)(a,["dataset","uniqueFieldValues"]);return Pc({statusForEditor:i,primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:e,includes:s,nestedFieldKeys:c,uniqueFieldValues:p,readWriteType:u,cursorPagingRequired:d})})})({primaryDatasetId:d,recordStoreCache:this._recordStoreCache,refreshStoreCache:u,dataProvider:this._dataProvider,controllerConfig:n,statusForEditor:B}),{promise:v,resolve:S}=new g;m||(E.push(v),h||I.push(v));const{promise:R,resolve:P}=new g;T.push(R);const C=a&&_&&this._warmupCache.getUserFilterInitialData(d);C&&this._dataProvider.setUserFilterInitialData(d,C);const O=yp(this._logger,{shouldCollectSeoData:M,seoManager:k,dependencyManager:x,controllerConfig:n,datasetType:t,connections:s,connectionsGraph:F,recordStoreService:y,dataProvider:this._dataProvider,firePlatformEvent:r(d),dynamicPagesData:h&&f?{dynamicPageData:f,items:this._staticCache.getItems(),datasetConfig:n}:void 0,datasetId:d,schemasLoading:N,listenersByEvent:this._listenersByEvent,updatedCompIds:p,markControllerAsRendered:P,markDatasetDataFetched:S,renderingRegularControllers:w,modeIsLivePreview:c,modeIsSSR:i,dataset:e}).createRealDataset();return x.registerDataset({id:d,api:O.api,config:n}),i&&_&&O.userFilterInitialDataPromise.then(e=>{this._warmupCache.setUserFilterInitialData(d,e)}),O});i&&_&&I.length&&Promise.all(I).then(()=>{this._warmupCache.setDataStore(Dp(this._dataProvider.getStore()))}),Promise.all(T).then(S);const G=()=>Promise.all([...E,N]).then(k.renderSeoTagsOnce);return M?V.map(e=>({...e,pageReady:function(){return e.pageReady(...arguments).then(G)}})):V}_updateDatasetConfigsState(e){const{appState:t}=f;return e.reduce((e,r)=>{let{compId:n,config:{dataset:o}}=r;const a=t.datasetConfigs.get(n);return a&&!(0,l.isEqual)(a,o)&&e.push(n),t.datasetConfigs.set(n,o),e},[])}_getInitialDataRequestConfigs(e,t){return e.reduce((e,r)=>{let{compId:n,config:{datasetStaticConfig:{sequenceType:o}},livePreviewOptions:{shouldFetchData:a}={}}=r;return o===Hi?[...e,{id:n,refresh:a||t.includes(n)}]:e},[])}}const Op=e=>{const[{config:{dataset:{collectionName:t}}}={config:{dataset:{}}}]=e.filter(e=>{let{type:t}=e;return t===gr}),r=e.reduce((e,r)=>{let{type:n,config:{dataset:{collectionName:o}}}=r;return n!==yr&&o&&o!==t&&e.add(o),e},new Set),n=[...r],o=[...r];return t&&o.push(t),{allDatasetCollectionIds:o,regularDatasetCollectionIds:n}},bp=e=>e.reduce((e,t)=>(ji.isWidget(t)&&(e[ji.getCollectionId(t)]={}),e),{}),Np=e=>t=>{if(t)return{...t,recordsByCollectionId:Object.entries(t.recordsByCollectionId).reduce((t,r)=>{let[n,o]=r;return t[n]=e(o),t},{})}},Dp=Np(Rn.pY),Ap=Np(Rn.aU),{text:Fp,boolean:xp,number:Lp,dateTime:Up,date:Mp,richText:kp,url:Bp,reference:Vp,stringArray:Gp}=fe.FieldType,jp=[Fp,kp,xp,Up,Mp,Vp,Lp,Bp,Gp],$p=(e,t)=>t===fe.FieldType.text?ls(e):e,qp=e=>{let{datasetId:t,record:r,schema:n,getSchema:o}=e;const a={"form-id":{value:t,keyName:""}},i=(0,l.pickBy)(n.fields,(e,t)=>((e,t)=>{const{type:r,systemField:n}=e,o=jp.includes(r),a=!!n,i=["_id","_owner","_createdDate","_updatedDate"].includes(t);return o&&(!a||i)})(e,t)&&!function(e){return!!e.isDeleted}(e));return(0,l.forEach)(i,(e,n)=>{const i=function(e){let{record:t,fieldData:r,fieldName:n,getSchema:o}=e;if(r.type===fe.FieldType.reference){const e=o(r.referencedCollection);if(!e||!e.displayField)return;const a=is(t[n],e.displayField);return{value:$p(a,r.type),type:e.fields[e.displayField].type}}const a=is(t,n);return{value:$p(a,r.type),type:r.type}}({record:r,fieldData:e,fieldName:n,getSchema:o});if(!i)return;const{value:s,type:l}=i,{displayName:c,index:d}=e,u=((e,t)=>`${e}.${t}`)(t,n);a[`field:${u}`]={value:s,keyName:c,index:d,valueType:l}}),a};const Wp=e=>{let{automationsClientCreator:t,pageId:r}=e;const n=t().reportFormEventToAutomationCreator();return{afterSave:async(e,t,o)=>{let{datasetId:a,getSchema:i,getState:s}=e;const l=s(),c=i();if(!Boolean(l.records.isForm)||!c)return;const{eventUTCTime:d,detailedEventPayload:u,collectionId:p,submitterId:f}=(e=>{let{datasetId:t,getSchema:r,record:n,schema:o}=e;return{eventUTCTime:is(n,"_updatedDate"),detailedEventPayload:qp({datasetId:t,record:n,schema:o,getSchema:r}),collectionId:o.id,submitterId:n._owner}})({datasetId:a,record:o,schema:c,getSchema:i});await n({eventUTCTime:d,detailedEventPayload:u},p,r,f)}}};a(7511);a(1361);const zp="WD_UNKNOWN_ERROR";function Hp(e,t,r){const n=new(t&&t!==zp?Yp:Error)(e);return t&&(n.code=t),r&&(n.details=r),n}class Yp extends Error{constructor(e){super(e),this.name="Error",this.errorGroup="User",Error.captureStackTrace&&Error.captureStackTrace(this,Yp)}}Error;const Jp=e=>`WDE0025: The ${e} collection does not exist. You cannot work with a collection using the Data API before it is created in the Editor.`;function Kp(e){return Hp(Jp(e),"WD_SCHEMA_DOES_NOT_EXIST",t);var t}var Qp,Xp=(Qp=function(e,t){return Qp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Qp(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Qp(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});var Zp,ef,tf,rf,nf,of,af,sf,lf,cf,df,uf,pf,ff,hf,mf,gf,yf,vf,_f=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.setPrototypeOf(n,r.prototype),n.name=r.name,Error.captureStackTrace?Error.captureStackTrace(n,r):n.stack=new Error(t).stack,n}return Xp(t,e),t}(Error),Ef=function(e){function t(r){var n=e.call(this,r,t)||this;return n.reason=r,n.message=r,n}return Xp(t,e),t}(_f),If=function(e){function t(r,n,o,a){var i=e.call(this,o,t)||this;return i.status=r,i.responseText=n,i.requestId=a,i}return Xp(t,e),t}(_f);function Tf(e){return Object.keys(e).reduce(function(t,r){return void 0!==e[r]&&(t[r]=e[r]),t},{})}function Sf(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],a=e[o];void 0!==a&&(t[a]=o)}return t}function wf(e,t){return null==e?void 0:t(e)}!function(e){e.NATIVE="NATIVE",e.WIX_APP="WIX_APP",e.BLOCKS_APP="BLOCKS_APP",e.EXTERNAL="EXTERNAL"}(Zp||(Zp={})),function(e){e.ASC="ASC",e.DESC="DESC"}(ef||(ef={})),function(e){e.AGGREGATE="AGGREGATE",e.BULK_INSERT="BULK_INSERT",e.BULK_REMOVE="BULK_REMOVE",e.BULK_SAVE="BULK_SAVE",e.BULK_UPDATE="BULK_UPDATE",e.COUNT="COUNT",e.DISTINCT="DISTINCT",e.FIND="FIND",e.GET="GET",e.INSERT="INSERT",e.INSERT_REFERENCE="INSERT_REFERENCE",e.IS_REFERENCED="IS_REFERENCED",e.QUERY_REFERENCED="QUERY_REFERENCED",e.REMOVE="REMOVE",e.REMOVE_REFERENCE="REMOVE_REFERENCE",e.REPLACE_REFERENCES="REPLACE_REFERENCES",e.SAVE="SAVE",e.TRUNCATE="TRUNCATE",e.UPDATE="UPDATE",e.PATCH="PATCH",e.BULK_PATCH="BULK_PATCH"}(tf||(tf={})),function(e){e.UPDATE="UPDATE",e.REMOVE="REMOVE"}(rf||(rf={})),function(e){e.UNKNOWN_FIELD_TYPE="UNKNOWN_FIELD_TYPE",e.TEXT="TEXT",e.NUMBER="NUMBER",e.DATE="DATE",e.DATETIME="DATETIME",e.IMAGE="IMAGE",e.BOOLEAN="BOOLEAN",e.DOCUMENT="DOCUMENT",e.URL="URL",e.RICH_TEXT="RICH_TEXT",e.VIDEO="VIDEO",e.ANY="ANY",e.ARRAY_STRING="ARRAY_STRING",e.ARRAY_DOCUMENT="ARRAY_DOCUMENT",e.AUDIO="AUDIO",e.TIME="TIME",e.LANGUAGE="LANGUAGE",e.RICH_CONTENT="RICH_CONTENT",e.MEDIA_GALLERY="MEDIA_GALLERY",e.ADDRESS="ADDRESS",e.PAGE_LINK="PAGE_LINK",e.REFERENCE="REFERENCE",e.MULTI_REFERENCE="MULTI_REFERENCE",e.OBJECT="OBJECT",e.ARRAY="ARRAY",e.LEGACY_TIME="LEGACY_TIME",e.LEGACY_BOOK="LEGACY_BOOK",e.LEGACY_EXTERNAL_URL="LEGACY_EXTERNAL_URL",e.LEGACY_BROKEN_REFERENCE="LEGACY_BROKEN_REFERENCE",e.LEGACY_IMAGE="LEGACY_IMAGE",e.LEGACY_COLOR="LEGACY_COLOR",e.LEGACY_EXTERNAL_VIDEO="LEGACY_EXTERNAL_VIDEO"}(nf||(nf={})),function(e){e.EQ="EQ",e.LT="LT",e.GT="GT",e.NE="NE",e.LTE="LTE",e.GTE="GTE",e.STARTS_WITH="STARTS_WITH",e.ENDS_WITH="ENDS_WITH",e.CONTAINS="CONTAINS",e.HAS_SOME="HAS_SOME",e.HAS_ALL="HAS_ALL",e.EXISTS="EXISTS",e.URLIZED="URLIZED"}(of||(of={})),function(e){e.UNKNOWN="UNKNOWN",e.CMS="CMS"}(af||(af={})),function(e){e.UNKNOWN_ROLE="UNKNOWN_ROLE",e.ADMIN="ADMIN",e.SITE_MEMBER_AUTHOR="SITE_MEMBER_AUTHOR",e.SITE_MEMBER="SITE_MEMBER",e.ANYONE="ANYONE"}(sf||(sf={})),function(e){e.UNKNOWN_PUBLISH_PLUGIN_STATUS="UNKNOWN_PUBLISH_PLUGIN_STATUS",e.PUBLISHED="PUBLISHED",e.DRAFT="DRAFT"}(lf||(lf={})),function(e){e.UNKNOWN_URLIZED_PLUGIN_FORMAT="UNKNOWN_URLIZED_PLUGIN_FORMAT",e.ORIGINAL="ORIGINAL",e.PLAIN="PLAIN"}(cf||(cf={})),function(e){e.UNKNOWN_PLUGIN_TYPE="UNKNOWN_PLUGIN_TYPE",e.PUBLISH="PUBLISH",e.SINGLE_ITEM="SINGLE_ITEM",e.URLIZED="URLIZED",e.GRIDAPPLESS="GRIDAPPLESS",e.MULTILINGUAL="MULTILINGUAL",e.SHARED="SHARED",e.EDITABLE_PAGE_LINK="EDITABLE_PAGE_LINK",e.CMS="CMS",e.CATALOG="CATALOG"}(df||(df={})),function(e){e.OFFSET="OFFSET",e.CURSOR="CURSOR"}(uf||(uf={})),function(e){e.UNDEFINED="UNDEFINED",e.ANYONE="ANYONE",e.SITE_MEMBER="SITE_MEMBER",e.SITE_MEMBER_AUTHOR="SITE_MEMBER_AUTHOR",e.CMS_EDITOR="CMS_EDITOR",e.PRIVILEGED="PRIVILEGED"}(pf||(pf={})),function(e){e.UNKNOWN_SEGMENT="UNKNOWN_SEGMENT",e.PUBLIC="PUBLIC",e.DEV="DEV"}(ff||(ff={})),function(e){e.ASC="ASC",e.DESC="DESC"}(hf||(hf={})),function(e){e.ASC="ASC",e.DESC="DESC"}(mf||(mf={})),function(e){e.UNKNOWN="UNKNOWN",e.BUILDING="BUILDING",e.ACTIVE="ACTIVE",e.DROPPING="DROPPING",e.DROPPED="DROPPED",e.FAILED="FAILED",e.INVALID="INVALID"}(gf||(gf={})),function(e){e.UNKNOWN_INDEX_SOURCE="UNKNOWN_INDEX_SOURCE",e.SYSTEM="SYSTEM",e.USER="USER",e.AUTO="AUTO"}(yf||(yf={})),function(e){e.UNKNOWN="UNKNOWN",e.ANONYMOUS_VISITOR="ANONYMOUS_VISITOR",e.MEMBER="MEMBER",e.WIX_USER="WIX_USER",e.APP="APP"}(vf||(vf={}));var Rf,Pf=function(){return Pf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pf.apply(this,arguments)},Cf={ADMIN:fe.PermissionRole.admin,SITE_MEMBER_AUTHOR:fe.PermissionRole.siteMemberAuthor,SITE_MEMBER:fe.PermissionRole.siteMember,ANYONE:fe.PermissionRole.anyone,UNKNOWN_ROLE:void 0},Of=Sf(Cf),bf={TEXT:fe.FieldType.text,NUMBER:fe.FieldType.number,DATE:fe.FieldType.date,DATETIME:fe.FieldType.dateTime,IMAGE:fe.FieldType.image,BOOLEAN:fe.FieldType.boolean,DOCUMENT:fe.FieldType.document,URL:fe.FieldType.url,RICH_TEXT:fe.FieldType.richText,VIDEO:fe.FieldType.video,ANY:fe.FieldType.any,ARRAY_STRING:fe.FieldType.stringArray,ARRAY_DOCUMENT:fe.FieldType.documentArray,AUDIO:fe.FieldType.audio,TIME:fe.FieldType.time,LANGUAGE:fe.FieldType.language,RICH_CONTENT:fe.FieldType.richContent,MEDIA_GALLERY:fe.FieldType.mediaGallery,ADDRESS:fe.FieldType.address,PAGE_LINK:fe.FieldType.pageLink,REFERENCE:fe.FieldType.reference,MULTI_REFERENCE:fe.FieldType.multiReference,OBJECT:fe.FieldType.object,ARRAY:fe.FieldType.array,LEGACY_TIME:fe.FieldType.time,LEGACY_BOOK:fe.FieldType.legacyBook,LEGACY_EXTERNAL_URL:fe.FieldType.legacyExternalUrl,LEGACY_BROKEN_REFERENCE:fe.FieldType.legacyBrokenRef,LEGACY_IMAGE:fe.FieldType.legacyImage,LEGACY_COLOR:fe.FieldType.color,LEGACY_EXTERNAL_VIDEO:fe.FieldType.legacyExternalVideo,UNKNOWN_FIELD_TYPE:void 0},Nf=Pf(Pf({},Sf(bf)),((Rf={})[fe.FieldType.time]=nf.TIME,Rf)),Df=[{v1Type:fe.MULTILINGUAL_PLUGIN_ID,v2Type:df.MULTILINGUAL,toV2:function(e){return{multilingualOptions:{translatableFieldKeys:e.translatable}}},toV1:function(e){var t,r;return{translatable:null!==(r=null===(t=e.multilingualOptions)||void 0===t?void 0:t.translatableFieldKeys)&&void 0!==r?r:[]}}},{v1Type:fe.PUBLISHING_PLUGIN_ID,v2Type:df.PUBLISH,toV2:function(e){return{publishOptions:{defaultStatus:e.defaultStatus}}},toV1:function(e){var t;return{defaultStatus:null===(t=e.publishOptions)||void 0===t?void 0:t.defaultStatus}}},{v1Type:fe.SINGLES_PLUGIN_ID,v2Type:df.SINGLE_ITEM,toV2:function(e){return{singleItemOptions:{singleItemId:e.singleItemId}}},toV1:function(e){var t,r;return{singleItemId:null!==(r=null===(t=e.singleItemOptions)||void 0===t?void 0:t.singleItemId)&&void 0!==r?r:"SINGLE_ITEM_ID"}}},{v1Type:fe.URLIZED_PLUGIN_ID,v2Type:df.URLIZED,toV2:function(e){return{urlizedOptions:{format:e.format.toUpperCase()}}},toV1:function(e){var t;return{format:(null===(t=e.urlizedOptions)||void 0===t?void 0:t.format)===cf.ORIGINAL?fe.UrlizedFormat.ORIGINAL:fe.UrlizedFormat.PLAIN}}},{v1Type:fe.SHARED_PLUGIN_ID,v2Type:df.SHARED,toV2:function(e){return{}},toV1:function(e){return{}}},{v1Type:fe.PAGE_LINK_PLUGIN_ID,v2Type:df.EDITABLE_PAGE_LINK,toV2:function(e){return{editablePageLinkOptions:{isPersisted:e.isPersisted,isMutable:e.isUpdatable}}},toV1:function(e){var t,r,n,o;return{isPersisted:null!==(r=null===(t=e.editablePageLinkOptions)||void 0===t?void 0:t.isPersisted)&&void 0!==r&&r,isUpdatable:null!==(o=null===(n=e.editablePageLinkOptions)||void 0===n?void 0:n.isMutable)&&void 0!==o&&o}}},{v1Type:fe.CMS_PLUGIN_ID,v2Type:df.CMS,toV1:function(e){var t,r;return Pf(Pf({},null!==(t=e.cmsOptions)&&void 0!==t?t:{}),{siteSort:wf(null===(r=e.cmsOptions)||void 0===r?void 0:r.siteSort,function(e){var t;return{sort:(null!==(t=e.sort)&&void 0!==t?t:[]).map(function(e){var t;return{fieldName:e.fieldKey,direction:null===(t=e.direction)||void 0===t?void 0:t.toLowerCase()}})}})})},toV2:function(e){return{cmsOptions:Pf(Pf({},e),{siteSort:wf(e.siteSort,function(e){return{sort:e.sort.map(function(e){var t;return{fieldKey:e.fieldName,direction:null===(t=e.direction)||void 0===t?void 0:t.toUpperCase()}})}})})}}}];var Af=[{v1Type:fe.CMS_FIELD_PLUGIN_ID,v2Type:af.CMS,toV1:function(e){var t,r;return{internal:null!==(r=null===(t=e.cmsOptions)||void 0===t?void 0:t.internal)&&void 0!==r&&r}},toV2:function(e){return{cmsOptions:{internal:e.internal}}}}];function Ff(e){for(var t={},r=function(e){var r=Af.find(function(t){return t.v2Type===e.type});void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++){r(o[n])}return t}function xf(e){for(var t=[],r=function(e,r){var n=Af.find(function(t){return t.v1Type===e});void 0!==n?t.push(Pf({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}function Lf(e){var t;return Tf({id:e.id,displayName:e.displayName,displayField:e.displayField,fields:Vf(e),permissions:Bf(e),revision:null===(t=e.version)||void 0===t?void 0:t.toString(),plugins:$f(e)})}var Uf,Mf,kf={displayName:"displayName",namespace:null,displayNamespace:"displayNamespace",isDeleted:null,id:null,ownerAppId:"ownerAppId",allowedOperations:"capabilities",collectionOperations:"capabilities",permissions:"permissions",dataPermissions:"dataPermissions",allowedPermissions:"allowedDataPermissions",defaultSort:"defaultDisplayOrder",displayField:"displayField",fields:"fields",maxPageSize:"maxPageSize",storage:"collectionType",plugins:"plugins",version:"revision",ttl:null,pagingMode:"pagingModes",capabilities:"capabilities"};function Bf(e){if(e.permissions)return{insert:Of[e.permissions.insert],update:Of[e.permissions.update],remove:Of[e.permissions.remove],read:Of[e.permissions.read]}}function Vf(e){return Object.entries(e.fields||{}).filter(function(e){e[0];return!e[1].isDeleted}).sort(function(e,t){var r,n,o=null!==(r=e[1].index)&&void 0!==r?r:0,a=null!==(n=t[1].index)&&void 0!==n?n:0;return o>a?1:o<a||null!=o&&null==a?-1:null==o&&null!=a?1:0}).map(function(e){return Gf(e[0],e[1])})}function Gf(e,t){function r(e){return Object.values(e).some(function(e){return void 0!==e})?e:void 0}return Tf({key:e,displayName:t.displayName,type:Nf[t.type],typeMetadata:jf(t),encrypted:t.pii,description:t.description,plugin:t.plugin,stringLengthRange:r({minLength:t.minStrLength,maxLength:t.maxStrLength}),arraySizeRange:r({minSize:t.minArraySize,maxSize:t.maxArraySize}),readOnly:t.readOnly,numberRange:r({min:t.minValue,max:t.maxValue}),immutable:t.immutable,required:t.required,plugins:wf(t.plugins,xf)})}function jf(e){switch(e.type){case"pagelink":return function(e){return null==e.calculator||null==e.calculator.config?void 0:{pageLink:{linkedRouterPage:e.linkedRouterPage,calculator:Tf({fieldsPattern:Tf({pattern:e.calculator.config.pattern,lowercase:e.calculator.config.lowercase}),urlizedOnlyPattern:Tf({pattern:e.calculator.config.pattern})})}}}(e);case"reference":return function(e){return{reference:{referencedCollectionId:e.referencedCollection}}}(e);case"multi-reference":return function(e){return{multiReference:{referencedCollectionId:e.referencedCollection,referencingFieldKey:e.referencingFieldKey,referencingDisplayName:e.referencingDisplayName}}}(e);case"object":return function(e){return null==e.fields?void 0:{object:{fields:Object.entries(e.fields).map(function(e){return function(e,t){return Tf({key:e,displayName:t.displayName,type:Nf[t.type],typeMetadata:jf(t)})}(e[0],e[1])})}}}(e);case"array":return function(e){return null==e.elementType?void 0:{array:Tf({elementType:Nf[e.elementType.type],typeMetadata:jf(e.elementType)})}}(e)}}function $f(e){var t;return function(e){for(var t=[],r=function(e,r){var n=Df.find(function(t){return t.v1Type===e});void 0!==n?t.push(Pf({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}(null!==(t=e.plugins)&&void 0!==t?t:{})}var qf=((Uf={})[uf.OFFSET]=fe.PagingMode.Offset,Uf[uf.CURSOR]=fe.PagingMode.Cursor,Uf),Wf=((Mf={})[Zp.NATIVE]=fe.Storage.docstore,Mf[Zp.WIX_APP]=fe.Storage.driver,Mf[Zp.BLOCKS_APP]=fe.Storage.staticAppSchema,Mf[Zp.EXTERNAL]=fe.Storage.external,Mf),zf={IS_REFERENCED:fe.DataOperation.isReferenced,INSERT:fe.DataOperation.insert,SAVE:fe.DataOperation.save,BULK_INSERT:fe.DataOperation.bulkInsert,BULK_UPDATE:fe.DataOperation.bulkUpdate,UPDATE:fe.DataOperation.update,TRUNCATE:fe.DataOperation.truncate,REMOVE:fe.DataOperation.remove,REMOVE_REFERENCE:fe.DataOperation.removeReference,COUNT:fe.DataOperation.count,FIND:fe.DataOperation.find,REPLACE_REFERENCES:fe.DataOperation.replaceReferences,BULK_REMOVE:fe.DataOperation.bulkRemove,INSERT_REFERENCE:fe.DataOperation.insertReference,GET:fe.DataOperation.get,BULK_SAVE:fe.DataOperation.bulkSave,QUERY_REFERENCED:fe.DataOperation.queryReferenced,DISTINCT:fe.DataOperation.distinct,AGGREGATE:fe.DataOperation.aggregate,PATCH:fe.DataOperation.patch,BULK_PATCH:fe.DataOperation.bulkPatch},Hf={UPDATE:fe.CollectionOperation.UPDATE,REMOVE:fe.CollectionOperation.REMOVE},Yf={EQ:fe.AllowedFilterOperator.eq,LT:fe.AllowedFilterOperator.lt,GT:fe.AllowedFilterOperator.gt,NE:fe.AllowedFilterOperator.ne,LTE:fe.AllowedFilterOperator.lte,GTE:fe.AllowedFilterOperator.gte,STARTS_WITH:fe.AllowedFilterOperator.startsWith,ENDS_WITH:fe.AllowedFilterOperator.endsWith,CONTAINS:fe.AllowedFilterOperator.contains,HAS_SOME:fe.AllowedFilterOperator.hasSome,HAS_ALL:fe.AllowedFilterOperator.hasAll,EXISTS:fe.AllowedFilterOperator.exists,URLIZED:fe.AllowedFilterOperator.urlized};function Jf(e){var t,r,n,o=e;return Tf({id:o.id,isDeleted:!1,namespace:dh(o.id),storage:Wf[o.collectionType],ownerAppId:o.ownerAppId||null,displayNamespace:o.displayNamespace||null,displayField:o.displayField,allowedOperations:eh(o),collectionOperations:th(o),fields:oh(o),displayName:null!==(t=o.displayName)&&void 0!==t?t:o.id,permissions:Qf(o),dataPermissions:Xf(o),allowedPermissions:Zf(o),maxPageSize:null!==(r=o.maxPageSize)&&void 0!==r?r:void 0,defaultSort:rh(o.defaultDisplayOrder),version:Kf(o.revision),plugins:nh(o.plugins),pagingMode:null===(n=o.pagingModes)||void 0===n?void 0:n.map(function(e){return qf[e]}),translatable:!1,ttl:null,capabilities:ph(o)})}function Kf(e){var t=parseInt(null!=e?e:"0",10);return isNaN(t)?0:t}function Qf(e){if(e.permissions){var t=e.permissions;return{read:Cf[t.read],insert:Cf[t.insert],remove:Cf[t.remove],update:Cf[t.update]}}}function Xf(e){if(e.dataPermissions){var t=function(e){switch(e){case pf.ANYONE:return fe.AccessLevel.ANYONE;case pf.SITE_MEMBER:return fe.AccessLevel.SITE_MEMBER;case pf.SITE_MEMBER_AUTHOR:return fe.AccessLevel.SITE_MEMBER_AUTHOR;case pf.CMS_EDITOR:return fe.AccessLevel.CMS_EDITOR;default:return fe.AccessLevel.PRIVILEGED}},r=e.dataPermissions;return{itemRead:t(r.itemRead),itemInsert:t(r.itemInsert),itemUpdate:t(r.itemUpdate),itemRemove:t(r.itemRemove)}}}function Zf(e){var t,r,n,o;if(e.allowedDataPermissions){var a=e.allowedDataPermissions;return{itemInsert:null!==(t=a.itemInsert)&&void 0!==t&&t,itemRead:null!==(r=a.itemRead)&&void 0!==r&&r,itemUpdate:null!==(n=a.itemUpdate)&&void 0!==n&&n,itemRemove:null!==(o=a.itemRemove)&&void 0!==o&&o}}}function eh(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.dataOperations;return null==r?void 0:r.map(function(e){return zf[e]})}function th(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.collectionOperations;return null==r?void 0:r.map(function(e){return Hf[e]})}function rh(e){return e?{direction:e.direction===ef.DESC?fe.Direction.desc:fe.Direction.asc,fieldName:e.fieldKey}:null}function nh(e){if(e)return function(e){for(var t={},r=function(e){var r=Df.find(function(t){return t.v2Type===e.type});void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++)r(o[n]);return t}(e)}function oh(e){return e.fields?e.fields.reduce(function(e,t,r){var n;return Object.assign({},e,((n={})[t.key]=function(e,t){var r,n,o,a,i,s,l,c,d,u,p,f,h,m,g,y,v,_,E,I,T,S,w,R,P,C,O,b=e;return Tf({displayName:null!==(r=b.displayName)&&void 0!==r?r:b.key,systemField:null!==(n=b.systemField)&&void 0!==n&&n,sortable:null===(o=null==b?void 0:b.capabilities)||void 0===o?void 0:o.sortable,isDeleted:!1,index:t,queryOperators:lh(b),plugin:null!==(a=null==b?void 0:b.plugin)&&void 0!==a?a:void 0,calculator:ch(b),pii:!!b.encrypted||void 0,linkedRouterPage:null!==(l=null===(s=null===(i=null==b?void 0:b.typeMetadata)||void 0===i?void 0:i.pageLink)||void 0===s?void 0:s.linkedRouterPage)&&void 0!==l?l:void 0,description:null!==(c=b.description)&&void 0!==c?c:void 0,readOnly:null!==(d=b.readOnly)&&void 0!==d?d:void 0,immutable:null!==(u=b.immutable)&&void 0!==u?u:void 0,required:null!==(p=b.required)&&void 0!==p?p:void 0,minValue:null!==(h=null===(f=null==b?void 0:b.numberRange)||void 0===f?void 0:f.min)&&void 0!==h?h:void 0,maxValue:null!==(g=null===(m=null==b?void 0:b.numberRange)||void 0===m?void 0:m.max)&&void 0!==g?g:void 0,minStrLength:null!==(v=null===(y=null==b?void 0:b.stringLengthRange)||void 0===y?void 0:y.minLength)&&void 0!==v?v:void 0,maxStrLength:null!==(E=null===(_=null==b?void 0:b.stringLengthRange)||void 0===_?void 0:_.maxLength)&&void 0!==E?E:void 0,minArraySize:null!==(T=null===(I=null==b?void 0:b.arraySizeRange)||void 0===I?void 0:I.minSize)&&void 0!==T?T:void 0,maxArraySize:null!==(w=null===(S=null==b?void 0:b.arraySizeRange)||void 0===S?void 0:S.maxSize)&&void 0!==w?w:void 0,type:bf[b.type],referencedCollection:uh(b.typeMetadata),referencingFieldKey:null===(P=null===(R=b.typeMetadata)||void 0===R?void 0:R.multiReference)||void 0===P?void 0:P.referencingFieldKey,referencingDisplayName:null===(O=null===(C=b.typeMetadata)||void 0===C?void 0:C.multiReference)||void 0===O?void 0:O.referencingDisplayName,fields:ih(b.typeMetadata),elementType:sh(b.typeMetadata),plugins:wf(b.plugins,Ff)})}(t,r),n))},{}):{}}function ah(e,t){return{type:bf[e],fields:ih(t),elementType:sh(t)}}function ih(e){var t,r=null==e?void 0:e.object;if(r)return null===(t=r.fields)||void 0===t?void 0:t.reduce(function(e,t){var r;return Object.assign(e,((r={})[t.key]=function(e){var t;return Tf(Object.assign({displayName:e.displayName,sortable:null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.sortable,queryOperators:lh(e)},ah(e.type,e.typeMetadata)))}(t),r))},{})}function sh(e){var t=null==e?void 0:e.array;if(t)return Tf(ah(t.elementType,t.typeMetadata))}function lh(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.queryOperators;return r?r.length>=Object.keys(Yf).length?void 0:r.map(function(e){return Yf[e]}):[]}function ch(e){var t,r,n,o,a,i,s,l,c,d,u=null===(t=e.typeMetadata)||void 0===t?void 0:t.pageLink;return u?{config:{lowercase:null!==(o=null===(n=null===(r=u.calculator)||void 0===r?void 0:r.fieldsPattern)||void 0===n?void 0:n.lowercase)&&void 0!==o&&o,pattern:null!==(d=null!==(s=null===(i=null===(a=u.calculator)||void 0===a?void 0:a.fieldsPattern)||void 0===i?void 0:i.pattern)&&void 0!==s?s:null===(c=null===(l=u.calculator)||void 0===l?void 0:l.urlizedOnlyPattern)||void 0===c?void 0:c.pattern)&&void 0!==d?d:"unknown"}}:void 0}function dh(e){if(!e)return null;var t=e.lastIndexOf("/");return-1===t?null:e.substring(0,t)}function uh(e){var t,r,n;return null!==(r=null===(t=null==e?void 0:e.multiReference)||void 0===t?void 0:t.referencedCollectionId)&&void 0!==r?r:null===(n=null==e?void 0:e.reference)||void 0===n?void 0:n.referencedCollectionId}function ph(e){var t,r,n=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.indexQuotaLimits;if(n)return{indexing:{regular:n.regular1Field+n.regular3Field,regular1Field:n.regular1Field,compound:n.regular3Field,unique:n.unique1Field,total:n.total}};var o=null===(r=null==e?void 0:e.capabilities)||void 0===r?void 0:r.indexLimits;return o?{indexing:{regular:o.regular,unique:o.unique,total:o.total}}:void 0}var fh=function(){return fh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},fh.apply(this,arguments)},hh=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}l((n=n.apply(e,t||[])).next())})},mh=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},gh=function(){function e(e){this.transport=e}return e.prototype.get=function(e,t){var r,n,o;return hh(this,void 0,void 0,function(){var a;return mh(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,vh(this.transport.get({dataCollectionId:e,consistentRead:null==t?void 0:t.consistentRead,includeAllowedDataPermissions:null==t?void 0:t.includeAllowedPermissions,fields:Th(null==t?void 0:t.fields)}))];case 1:return[2,Jf(i.sent().collection)];case 2:if(a=i.sent(),"WDE0025"===(null===(o=null===(n=null===(r=null==a?void 0:a.responseText)||void 0===r?void 0:r.details)||void 0===n?void 0:n.applicationError)||void 0===o?void 0:o.code))throw Kp(e);throw a;case 3:return[2]}})})},e.prototype.bulkGet=function(e,t){return void 0===t&&(t={referencedCollectionsDepth:0}),hh(this,void 0,void 0,function(){var r=this;return mh(this,function(n){switch(n.label){case 0:return[4,Ih(e,100,function(e){return hh(r,void 0,void 0,function(){var r,n,o,a,i;return mh(this,function(s){switch(s.label){case 0:return r={dataCollectionIds:e,includeReferencedCollections:(null!==(i=t.referencedCollectionsDepth)&&void 0!==i?i:0)>0,showDeletedCollections:t.includeDeletedCollections,consistentRead:null==t?void 0:t.consistentRead,includeAllowedDataPermissions:null==t?void 0:t.includeAllowedPermissions,fields:Th(null==t?void 0:t.fields)},[4,vh(this.transport.getBulk(r))];case 1:return n=s.sent(),o=(n.activeCollections||[]).map(Jf),(a=(n.deletedCollections||[]).map(Jf)).forEach(function(e){return e.isDeleted=!0}),[2,o.concat(a)]}})})})];case 1:return[2,_h(n.sent())]}})})},e.prototype.listCollections=function(e){var t,r,n,o;return hh(this,void 0,void 0,function(){var a,i,s,l,c,d;return mh(this,function(u){switch(u.label){case 0:a=[],i={offset:0},u.label=1;case 1:return[4,vh(this.transport.list({paging:i,consistentRead:null==e?void 0:e.consistentRead,includeAllowedDataPermissions:null==e?void 0:e.includeAllowedPermissions,fields:Th(null==e?void 0:e.fields)}))];case 2:return s=u.sent(),a=a.concat(null!==(t=s.collections)&&void 0!==t?t:[]),l=s.pagingMetadata,c=(null!==(r=null==l?void 0:l.offset)&&void 0!==r?r:0)+(null!==(n=null==l?void 0:l.count)&&void 0!==n?n:0),d=null!==(o=null==l?void 0:l.total)&&void 0!==o?o:0,c<d?(i.offset=c,[3,1]):[2,a];case 3:return[2]}})})},e.prototype.list=function(e){return hh(this,void 0,void 0,function(){return mh(this,function(t){switch(t.label){case 0:return[4,this.listCollections(e)];case 1:return[2,_h(t.sent().map(Jf))]}})})},e.prototype.save=function(e,t){var r;return hh(this,void 0,void 0,function(){var n,o,a;return mh(this,function(i){switch(i.label){case 0:return(n=Lf(t)).id=e||n.id,o=null===(r=n.id)||void 0===r?void 0:r.startsWith("Forms/"),a=void 0!==t.version&&t.version>0,[4,vh(o||a?this.transport.update({collection:n}):this.transport.create({collection:n}))];case 1:return[2,[Jf(i.sent().collection)]]}})})},e.prototype.create=function(e,t){return hh(this,void 0,void 0,function(){var r;return mh(this,function(n){switch(n.label){case 0:return(r=Lf(t)).id=e||r.id,[4,vh(this.transport.create({collection:r}))];case 1:return[2,[Jf(n.sent().collection)]]}})})},e.prototype.update=function(e,t){return hh(this,void 0,void 0,function(){var r;return mh(this,function(n){switch(n.label){case 0:return(r=Lf(t)).id=e||r.id,[4,vh(this.transport.update({collection:r}))];case 1:return[2,[Jf(n.sent().collection)]]}})})},e.prototype.remove=function(e){return hh(this,void 0,void 0,function(){return mh(this,function(t){switch(t.label){case 0:return[4,vh(this.transport.delete({dataCollectionId:e}))];case 1:return t.sent(),[2,[{id:e,isDeleted:!0}]]}})})},e.prototype.restore=function(e){return hh(this,void 0,void 0,function(){return mh(this,function(t){switch(t.label){case 0:return[4,vh(this.transport.restore({dataCollectionId:e}))];case 1:return[2,Jf(t.sent().dataCollection)]}})})},e.prototype.createField=function(e,t,r){return hh(this,void 0,void 0,function(){return mh(this,function(n){switch(n.label){case 0:return[4,vh(this.transport.createField({dataCollectionId:e,field:Gf(t,r)}))];case 1:return[2,Jf(n.sent().dataCollection)]}})})},e.prototype.updateField=function(e,t,r){return hh(this,void 0,void 0,function(){return mh(this,function(n){switch(n.label){case 0:return[4,vh(this.transport.updateField({dataCollectionId:e,field:Gf(t,r)}))];case 1:return[2,Jf(n.sent().dataCollection)]}})})},e.prototype.deleteField=function(e,t){return hh(this,void 0,void 0,function(){return mh(this,function(r){switch(r.label){case 0:return[4,vh(this.transport.deleteField({dataCollectionId:e,fieldKey:t}))];case 1:return[2,Jf(r.sent().dataCollection)]}})})},e}();const yh=gh;function vh(e){return e.catch(function(e){if(!e.response)return Promise.reject(new Ef(Eh(e)));var t=e.response,r=t.headers&&t.headers["x-wix-request-id"];return Promise.reject(new If(t.status,t.data,Eh(t.data),r))})}function _h(e){return e.reduce(function(e,t){var r;return fh(fh({},e),((r={})[t.id]=t,r))},{})}function Eh(e){return"object"==typeof e&&e.message?e.message:"string"==typeof e?e:JSON.stringify(e)}function Ih(e,t,r){return hh(this,void 0,void 0,function(){var n,o;return mh(this,function(a){switch(a.label){case 0:for(n=[],o=0;o<e.length;o+=t)n.push(r(e.slice(o,o+t)));return[4,Promise.all(n)];case 1:return[2,a.sent().reduce(function(e,t){return e.concat(t)},[])]}})})}function Th(e){return null==e?void 0:e.map(function(e){return kf[e]}).filter(function(e){return null!==e})}const Sh=e=>e.split("#");const wh=/{(.*)}/,Rh=new RegExp(`\\.(${["wix.com","editorx.com"].join("|")})$`),Ph=new RegExp(`\\.(${["42.wixprod.net","uw2-edt-1.wixprod.net"].join("|")})$`),Ch=new RegExp(".*\\.dev.wix-code.com$");function Oh(e){const t=function(e,t){const r=t[e]||t._;if(r)return r;const n=function(e,t){return Object.entries(t).find(([t])=>{const[r,...n]=e.split(".");return n.join(".")===t})?.[1]}(e,t);if(!n&&function(e){return!!e.match(/\._base_domain_$/)}(e))return t[bh];return n??[]}(function(e){return e.replace("create.editorx.com","editor.editorx.com")}(e.host).replace(Rh,"._base_domain_").replace(Ph,"._api_base_domain_").replace(Ch,"*.dev.wix-code.com"),e.domainToMappings);var r,n;return function(e,t){const r=t?.find(t=>e.startsWith(t.destPath));if(!r)return e;return r.srcPath+e.slice(r.destPath.length)}((r=e.protoPath,n=e.data||{},r.split("/").map(e=>function(e,t){const r=e.match(wh)||[],n=r[1];if(n){const o=e.replace(r[0],"");return function(e,t,r,n){let o=e;for(const e of t.split(".")){if(!o)return r;o=o[e]}return`${o}${n}`}(t,n,e,o)}return e}(e,n)).join("/")),t)}const bh="www._base_domain_",Nh="function"==typeof Buffer,Dh=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),Ah=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Fh=(e=>{let t={};return e.forEach((e,r)=>t[e]=r),t})(Ah),xh=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Lh=String.fromCharCode.bind(String),Uh=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_")),Mh=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),kh=e=>{let t,r,n,o,a="";const i=e.length%3;for(let i=0;i<e.length;){if((r=e.charCodeAt(i++))>255||(n=e.charCodeAt(i++))>255||(o=e.charCodeAt(i++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|o,a+=Ah[t>>18&63]+Ah[t>>12&63]+Ah[t>>6&63]+Ah[63&t]}return i?a.slice(0,i-3)+"===".substring(i):a},Bh="function"==typeof btoa?e=>btoa(e):Nh?e=>Buffer.from(e,"binary").toString("base64"):kh,Vh=Nh?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let r=0,n=e.length;r<n;r+=4096)t.push(Lh.apply(null,e.subarray(r,r+4096)));return Bh(t.join(""))},Gh=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?Lh(192|t>>>6)+Lh(128|63&t):Lh(224|t>>>12&15)+Lh(128|t>>>6&63)+Lh(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return Lh(240|t>>>18&7)+Lh(128|t>>>12&63)+Lh(128|t>>>6&63)+Lh(128|63&t)},jh=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,$h=e=>e.replace(jh,Gh),qh=Nh?e=>Buffer.from(e,"utf8").toString("base64"):Dh?e=>Vh(Dh.encode(e)):e=>Bh($h(e)),Wh=(e,t=!1)=>t?Uh(qh(e)):qh(e),zh=e=>{if(e=e.replace(/\s+/g,""),!xh.test(e))throw new TypeError("malformed base64.");let t,r,n;e+="==".slice(2-(3&e.length));let o=[];for(let a=0;a<e.length;)t=Fh[e.charAt(a++)]<<18|Fh[e.charAt(a++)]<<12|(r=Fh[e.charAt(a++)])<<6|(n=Fh[e.charAt(a++)]),64===r?o.push(Lh(t>>16&255)):64===n?o.push(Lh(t>>16&255,t>>8&255)):o.push(Lh(t>>16&255,t>>8&255,255&t));return o.join("")};function Hh(e,t=""){const r={};return Object.entries(e).forEach(([e,n])=>{const o=null!==n&&"object"==typeof n&&!Array.isArray(n),a=function(e,t){return`${e}${e?".":""}${t}`}(t,e);if(o){const e=Hh(n,a);Object.assign(r,e)}else r[a]=n}),r}function Yh(e,t){const r=Hh(e),n=Object.entries(r).some(([e,t])=>e.includes(".")||Array.isArray(t)&&t.some(e=>"object"==typeof e));return t&&n?new URLSearchParams({".r":Wh(JSON.stringify(e),!0)}):Object.entries(r).reduce((e,[t,r])=>((Array.isArray(r)?r:[r]).forEach(n=>{null==n||Array.isArray(r)&&"object"==typeof n||e.append(t,n)}),e),new URLSearchParams)}var Jh;function Kh(e,t={},r){return function(n={},o){return"string"==typeof n?n:a(e,n);function a(e,t){const r={};return[null,void 0].includes(t)?t:(Object.entries(t).forEach(([t,n])=>{const o=e[t],{schemaName:a,schemaType:l}=function(e=""){const[t,r]=Sh(e);return r?{schemaName:r,schemaType:t}:{schemaName:t}}(o),c="Map"===l;let d;d=s(a)?.checkRepetable?.(n)??Array.isArray(n)?n.map(e=>i(e,a)):c?function(e,t){return Object.entries(e).reduce((e,[r,n])=>(e[r]=i(n,t),e),{})}(n,a):i(n,a),r[t]=d}),r)}function i(e,r){if(!r)return e;const n=t[r];if(s(r))return s(r).transform(e);if(n)return a(n,e);throw new Error(`${r} is neither schema nor serializable type`)}function s(e){return r[e]?.[o]}}}!function(e){e[e.TO_JSON=0]="TO_JSON",e[e.FROM_JSON=1]="FROM_JSON"}(Jh||(Jh={}));const Qh={types:["google.protobuf.Timestamp"],[Jh.TO_JSON]:{transform:e=>"string"!=typeof e&&e?e.toISOString():e},[Jh.FROM_JSON]:{transform:e=>e?new Date(e):e}},Xh={types:["google.protobuf.FieldMask"],[Jh.TO_JSON]:{transform:e=>e.join(","),checkRepetable:e=>e.some(e=>Array.isArray(e))},[Jh.FROM_JSON]:{transform:e=>"object"==typeof e?e.paths:e.split(",")}},Zh={types:["google.protobuf.BytesValue","BYTES"],[Jh.TO_JSON]:{transform:e=>{const t=e.reduce((e,t)=>e+String.fromCharCode(t),"");return btoa(t)}},[Jh.FROM_JSON]:{transform:e=>Uint8Array.from(atob(e),e=>e.charCodeAt(0))}},em={types:["google.protobuf.Duration"],[Jh.TO_JSON]:{transform:({seconds:e="0",nanos:t=0})=>{let r="";return 0!==t&&(r=`.${t.toString().padStart(9,"0")}`),`${e}${r}s`}},[Jh.FROM_JSON]:{transform:e=>{const[t,r]=e.substring(0,e.length-1).split(".");return{seconds:t,nanos:tm(r)}}}};function tm(e){let t=0;if(void 0!==e){const r=3-e.length/3;t=parseInt(e,10)*Math.pow(1e3,r)}return t}const rm={types:["FLOAT","DOUBLE","google.protobuf.FloatValue","google.protobuf.DoubleValue"],[Jh.TO_JSON]:{transform:e=>isFinite(e)?e:e.toString()},[Jh.FROM_JSON]:{transform:e=>"NaN"===e?NaN:"Infinity"===e?1/0:"-Infinity"===e?-1/0:e}};const nm=[...[Qh,Xh,Zh,em,rm]].reduce((e,t)=>({...e,...t.types.reduce((e,r)=>({...e,[r]:t}),{})}),{});function om(e,t={}){const r=Kh(e,t,nm);return{fromJSON(e){const t=function(e){try{return JSON.parse(e)}catch(e){}}(e)||e;return r(t,Jh.FROM_JSON)},toJSON:e=>r(e,Jh.TO_JSON)}}var am={typeMetadata:"_typeMetadata"},im={},sm={activeCollections:"_dataCollection",deletedCollections:"_dataCollection"},lm={field:"_field"},cm={dataCollection:"_dataCollection"},dm={collection:"_dataCollection"},um={collection:"_dataCollection"},pm={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",fields:"_field"},fm={},hm={dataCollection:"_dataCollection"},mm={},gm={},ym={numberRange:"_numberRange",typeMetadata:"_typeMetadata"},vm={},_m={collection:"_dataCollection",referencedCollections:"_dataCollection"},Em={},Im={collections:"_dataCollection"},Tm={min:"google.protobuf.DoubleValue",max:"google.protobuf.DoubleValue"},Sm={fields:"_objectField"},wm={typeMetadata:"_typeMetadata"},Rm={},Pm={dataCollection:"_dataCollection"},Cm={object:"_object",array:"_array"},Om={field:"_field"},bm={dataCollection:"_dataCollection"},Nm={collection:"_dataCollection"},Dm={collection:"_dataCollection"};function Am(e){return Oh(Object.assign(e,{domainToMappings:{"api._api_base_domain_":[{srcPath:"/cloud-data",destPath:""}],"code._base_domain_":[{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"}],"cloud-data.wix-code.com":[{srcPath:"",destPath:""}],_:[{srcPath:"/_api/cloud-data",destPath:""}],"www._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""},{srcPath:"/_api/cloud-data",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/cloud-data/v1",destPath:"/v1"},{srcPath:"/_api/cloud-data/v2",destPath:"/v2"}],"wixbo.ai":[{srcPath:"/_api/cloud-data/v1",destPath:"/v1"},{srcPath:"/_api/cloud-data/v2",destPath:"/v2"}],"wix-bo.com":[{srcPath:"/_api/cloud-data/v1",destPath:"/v1"},{srcPath:"/_api/cloud-data/v2",destPath:"/v2"}],"manage._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""},{srcPath:"/_api/cloud-data",destPath:""}],"editor._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"},{srcPath:"/_api/cloud-data/v2/items",destPath:"/v2/items"},{srcPath:"/_api/cloud-data/v2/dbs/tasks",destPath:"/v2/dbs/tasks"}],"blocks._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"},{srcPath:"/_api/cloud-data/v2/items",destPath:"/v2/items"},{srcPath:"/_api/cloud-data/v2/dbs/tasks",destPath:"/v2/dbs/tasks"}],"create.editorx":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"},{srcPath:"/_api/cloud-data/v2/items",destPath:"/v2/items"},{srcPath:"/_api/cloud-data/v2/dbs/tasks",destPath:"/v2/dbs/tasks"}],"www.wixapis.com":[{srcPath:"/wix-data/v1/collections",destPath:"/v1/wix-data/collections"},{srcPath:"/wix-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/wix-data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"},{srcPath:"/wix-data/v1/external-databases",destPath:"/v1/external-databases"},{srcPath:"/wix-data/v2",destPath:"/v2"},{srcPath:"/data/v2/collections",destPath:"/v2/collections"},{srcPath:"/data/v2/items",destPath:"/v2/items"},{srcPath:"/data/v2/bulk/items",destPath:"/v2/bulk/items"},{srcPath:"/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/data/v1/external-database-connections",destPath:"/v1/external-database-connections"}],"www.wixgateway.com":[{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"}],"*.dev.wix-code.com":[{srcPath:"/_api/cloud-data/v2",destPath:"/v2"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"}]}}))}var Fm=function(){return Fm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fm.apply(this,arguments)},xm=function(){function e(e,t,r){this.httpClient=e,this.signedInstance=t,this.baseUrl=function(e){var t=null==e?void 0:e.baseUrl;if(!t)return"https://cloud-data.wix-code.com";return t=Um(t,"/"),t=Um(t,"/v1/schemas")}(r)}return e.prototype._call=function(e){var t=this;return this.httpClient.request(function(r){var n=e(r),o=t.baseUrl+function(e,t){return e.startsWith(t)?e.substring(t.length):e}(n.url,"/_api/cloud-data");return Fm(Fm({},n),{url:o,headers:Fm(Fm({},n.headers),{authorization:t.signedInstance})})},{signedInstance:this.signedInstance}).then(function(e){return e.data})},e.prototype.create=function(e){return this._call(function(e){var t=om(dm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}),r=t.toJSON,n=t.fromJSON,o=om(um,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.CreateDataCollection",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.delete=function(e){return this._call(function(e){var t=om(mm,{}),r=t.toJSON,n=t.fromJSON,o=om(gm,{}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"DELETE",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.DeleteDataCollection",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Yh(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.restore=function(e){return this._call(function(e){var t=om(Rm,{}),r=t.toJSON,n=t.fromJSON,o=om(Pm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.RestoreDataCollection",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/restore/{dataCollectionId}",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.get=function(e){return this._call(function(e){var t=om(vm,{}),r=t.toJSON,n=t.fromJSON,o=om(_m,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"GET",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.GetDataCollection",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Yh(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.getBulk=function(e){return this._call(function(e){var t=om(im,{}),r=t.toJSON,n=t.fromJSON,o=om(sm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.BulkGetDataCollections",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/bulk/collections/get",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.list=function(e){return this._call(function(e){var t=om(Em,{}),r=t.toJSON,n=t.fromJSON,o=om(Im,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"GET",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.ListDataCollections",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections",data:a,host:n}),params:Yh(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.update=function(e){return this._call(function(e){var t=om(Nm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}),r=t.toJSON,n=t.fromJSON,o=om(Dm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"PUT",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.UpdateDataCollection",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.createField=function(e){return this._call(function(e){var t=om(lm,{_array:am,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}),r=t.toJSON,n=t.fromJSON,o=om(cm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.CreateDataCollectionField",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/create-field",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.updateField=function(e){return this._call(function(e){var t=om(Om,{_array:am,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}),r=t.toJSON,n=t.fromJSON,o=om(bm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.UpdateDataCollectionField",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/update-field",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.deleteField=function(e){return this._call(function(e){var t=om(fm,{}),r=t.toJSON,n=t.fromJSON,o=om(hm,{_array:am,_dataCollection:pm,_field:ym,_numberRange:Tm,_object:Sm,_objectField:wm,_typeMetadata:Cm}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.DeleteDataCollectionField",migrationOptions:{optInTransformResponse:!0},url:Am({protoPath:"/v2/collections/delete-field",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e}();const Lm=xm;function Um(e,t){return e.endsWith(t)?e.substring(0,e.length-t.length):e}var Mm=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}l((n=n.apply(e,t||[])).next())})},km=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};const Bm=function(){function e(e,t,r,n){this._mapDefaults=function(e){return e.displayField||(e.fields&&e.fields.title?e.displayField="title":e.displayField="_id"),e},(null==n?void 0:n.client)?this._client=n.client:this._client=new yh(new Lm(e,t,n))}return e.prototype.get=function(e,t){var r=this;return this._client.get(e,t).then(function(e){return r._mapDefaults(e)})},e.prototype.bulkGet=function(e,t){return Mm(this,void 0,void 0,function(){var r=this;return km(this,function(n){return e&&0!==e.length?[2,this._client.bulkGet(e,t).then(function(e){return r._mapDefaultsForSchemas(e)})]:[2,{}]})})},e.prototype.list=function(e){var t=this;return this._client.list(e).then(function(e){return t._mapDefaultsForSchemas(e)})},e.prototype.save=function(e,t){return this._client.save(e,t)},e.prototype.create=function(e,t){return this._client.create(e,t)},e.prototype.update=function(e,t){return this._client.update(e,t)},e.prototype.remove=function(e){return this._client.remove(e)},e.prototype.restore=function(e){return this._client.restore(e)},e.prototype.createField=function(e,t,r){return this._client.createField(e,t,r).then(this._mapDefaults)},e.prototype.updateField=function(e,t,r){return this._client.updateField(e,t,r).then(this._mapDefaults)},e.prototype.deleteField=function(e,t){return this._client.deleteField(e,t).then(this._mapDefaults)},e.prototype._mapDefaultsForSchemas=function(e){var t=this;return Object.keys(e).reduce(function(r,n){var o=e[n];return r[n]=t._mapDefaults(o),r},{})},e}();var Vm=function(e,t,r,n){return new Bm(e,t,r,n)};const Gm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0627\u0644\u0643\u0644","USER_INPUT_FILTER_OPTION_NONE":"None"}');var jm=a.t(Gm,2);const $m=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0438\u0447\u043a\u0438"}');var qm=a.t($m,2);const Wm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tot","USER_INPUT_FILTER_OPTION_NONE":"None"}');var zm=a.t(Wm,2);const Hm=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"\u017d\xe1dn\xe9","USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161e"}');var Ym=a.t(Hm,2);const Jm=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Ingen","USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Km=a.t(Jm,2);const Qm=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Keine","USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Xm=a.t(Qm,2);const Zm=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"\u038c\u03bb\u03b1"}');var eg=a.t(Zm,2);const tg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"All","USER_INPUT_FILTER_OPTION_NONE":"None"}');var rg=a.t(tg,2);const ng=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Ninguno","USER_INPUT_FILTER_OPTION_RESET_ALL":"Todo"}');var og=a.t(ng,2);const ag=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Aucun","USER_INPUT_FILTER_OPTION_RESET_ALL":"Tout"}');var ig=a.t(ag,2);const sg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"\u05d4\u05db\u05dc"}');var lg=a.t(sg,2);const cg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0938\u092d\u0940","USER_INPUT_FILTER_OPTION_NONE":"None"}');var dg=a.t(cg,2);const ug=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\xd6sszes","USER_INPUT_FILTER_OPTION_NONE":"None"}');var pg=a.t(ug,2);const fg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua","USER_INPUT_FILTER_OPTION_NONE":"Tidak ada"}');var hg=a.t(fg,2);const mg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Nessuno","USER_INPUT_FILTER_OPTION_RESET_ALL":"Tutti"}');var gg=a.t(mg,2);const yg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u3059\u3079\u3066","USER_INPUT_FILTER_OPTION_NONE":"\u306a\u3057"}');var vg=a.t(yg,2);const _g=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\uc804\uccb4","USER_INPUT_FILTER_OPTION_NONE":"\uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc74c"}');var Eg=a.t(_g,2);const Ig=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Viskas","USER_INPUT_FILTER_OPTION_NONE":"None"}');var Tg=a.t(Ig,2);const Sg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua","USER_INPUT_FILTER_OPTION_NONE":"None"}');var wg=a.t(Sg,2);const Rg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle","USER_INPUT_FILTER_OPTION_NONE":"Geen"}');var Pg=a.t(Rg,2);const Cg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Ingen","USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Og=a.t(Cg,2);const bg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Brak","USER_INPUT_FILTER_OPTION_RESET_ALL":"Wszystkie"}');var Ng=a.t(bg,2);const Dg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Todos","USER_INPUT_FILTER_OPTION_NONE":"Nenhum"}');var Ag=a.t(Dg,2);const Fg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"Toate"}');var xg=a.t(Fg,2);const Lg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0435","USER_INPUT_FILTER_OPTION_NONE":"\u041d\u0435\u0442"}');var Ug=a.t(Lg,2);const Mg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161etky"}');var kg=a.t(Mg,2);const Bg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"None","USER_INPUT_FILTER_OPTION_RESET_ALL":"Vse"}');var Vg=a.t(Bg,2);const Gg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Inget","USER_INPUT_FILTER_OPTION_RESET_ALL":"Alla"}');var jg=a.t(Gg,2);const $g=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14","USER_INPUT_FILTER_OPTION_NONE":"\u0e44\u0e21\u0e48\u0e21\u0e35"}');var qg=a.t($g,2);const Wg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Lahat","USER_INPUT_FILTER_OPTION_NONE":"None"}');var zg=a.t(Wg,2);const Hg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Hepsi","USER_INPUT_FILTER_OPTION_NONE":"Yok"}');var Yg=a.t(Hg,2);const Jg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0423\u0441\u0456","USER_INPUT_FILTER_OPTION_NONE":"\u041d\u0435\u043c\u0430\u0454"}');var Kg=a.t(Jg,2);const Qg=JSON.parse('{"USER_INPUT_FILTER_OPTION_NONE":"Kh\xf4ng","USER_INPUT_FILTER_OPTION_RESET_ALL":"T\u1ea5t c\u1ea3"}');var Xg=a.t(Qg,2);const Zg=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u6240\u6709","USER_INPUT_FILTER_OPTION_NONE":"\u7121"}');const ey={ar:jm,bg:qm,ca:zm,cs:Ym,da:Km,de:Xm,el:eg,en:rg,es:og,fr:ig,he:lg,hi:dg,hu:pg,id:hg,it:gg,ja:vg,ko:Eg,lt:Tg,ms:wg,nl:Pg,no:Og,pl:Ng,pt:Ag,ro:xg,ru:Ug,sk:kg,sl:Vg,sv:jg,th:qg,tl:zg,tr:Yg,uk:Kg,vi:Xg,zh:a.t(Zg,2)},ty=ey.en;var ry=a(5583);const{initAppForPage:ny,createControllers:oy}=function(e){let t,o,i,s,{verbose:c=!1,wixDataSchemasForItTests:d,tpaActionImplementations:u=r}=void 0===e?{}:e;const p=e=>{if(!e.length)return[];const r=(e=>{let{makeDataset:t,features:r}=e;return(e,n)=>e.map(e=>{let{compId:o,type:a,connections:i,config:{dataset:s={}},essentials:{env:{compId:l}},livePreviewOptions:{shouldFetchData:c,compsIdsToReset:d}={}}=e;const u=a===yr?l:o,{readWriteType:p,deferred:f,onlyUsedFields:h,cursor:m,nested:g,private:y}=s,{collectionName:v,pageSize:_,filter:E,sort:I,includes:T}=a===gr?(null==n?void 0:n.config.dataset)??{}:s;return t({config:{id:u,type:Ai[a],collectionId:a===yr?u:v,readWriteType:p?Ni[p]:void 0,deferred:!r.deferredIsDead&&f,private:y,pagination:{pageSize:_,type:m?"cursor":"offset"},rendering:{connections:i,nestedFieldIds:g,componentIdsToRender:d},dataLoading:{filter:E,sort:I,fieldIdsToFetch:!r.fetchOnlyConnectedFields||r.fetchOnlyConnectedFieldsIsBlockedByAnotherApp&&!h||"READ"!==p?void 0:Di(i),referenceFieldIdsToFetch:T??void 0,dataIsInvalidated:c},routerConfig:n?{dynamicUrl:n.dynamicUrl,userDefinedFilter:n.userDefinedFilter,seoEnabled:n.config.dataset.seoV2}:null}})})})({makeDataset:ji.make,features:i}),a=r(e,t),s=e.reduce((e,t)=>{let{$w:r,compId:n}=t;return e[n]=r.fireEvent,e},{});return o.initializeDatasets({datasetConfigs:a,firePlatformEvent:e=>s[e]}).map((e,t)=>{"widget"===a[t].config.type&&(e.staticExports.initWidgetDataSource=t=>{let{getData:r,onDataChanged:o}=t;((e,t)=>{if(!t||!(0,l.isFunction)(t.getData)||!(0,l.isFunction)(t.onDataChanged))throw new n.DatasetError(`The callbacks {getData, onDataChanged} passed to (${e}) must be functions`,{code:"DS_INVALID_ARGUMENT"})})("initWidgetDataSource",{getData:r,onDataChanged:o});const a=e=>({...e,_id:"widget_record_id"});return e.api.initDataSource({getData:()=>[a(r())],onDataChanged:e=>o((t,r)=>e([a(t)],[a(r)])),getSchema:()=>({fields:{},displayName:"",id:"WIDGET"})})});return{pageReady:t=>e.pageReady(pu(t)),exports:t=>t.type===ry.$.COMPONENT?e.staticExports.inScope(t.compId,t.additionalData.itemId):e.staticExports,dispose:e.dispose}})},f=e=>{let{envIsEditor:t,baseUrl:r}=e;const n="_api/cloud-data";return t?`/${n}`:`${r}/${n}`};return{initAppForPage:function(e,r,l,p){let h,{bi:m={},fedOpsLoggerFactory:g,biLoggerFactory:y,essentials:{httpClient:v,experiments:_,createErrorMonitor:E}}=void 0===p?{}:p;try{s=new bi({platformUtils:r,platformSettings:e,wixSdk:l,bi:m,tpaActionImplementations:u,devMode:!1,verbose:c});const{settings:n}=s;(e=>{try{a.p=e.substr(0,e.lastIndexOf("/")+1)}catch{}})(s.settings.url);const{data:p,window:{warmupData:I,getRouterData:T},location:{baseUrl:S},site:{currentPage:w}}=l;t=T(),h=new go({fedops:{factory:g,hooks:{start:e=>{let{name:t}=e;return h.log(new Ue({category:"interaction start",message:`interaction ${t} started`}))},end:e=>{let{name:t,duration:r}=e;return h.log(new Ue({category:"interaction end",message:`interaction ${t} ended after ${r} ms`}))}}},bi:{factory:y},monitor:{createErrorMonitor:E},verbose:{factory:()=>({log:function(){var e;return((null==(e=l.telemetry)?void 0:e.console)||console).verbose(...arguments)}})},console:{factory:()=>{var e;return(null==(e=l.telemetry)?void 0:e.console)||console}},platform:s}),h.log(new Le("databinding/initAppForPage",Le.types.START));const R=(e=>{const t=ey[e]??ty;return{t:e=>(null==t?void 0:t[e])??e}})(s.settings.language);i=(e=>{let{experiments:t,settings:{env:r}}=e;return{get fes(){return t.enabled("specs.wixDataViewer.EnableFES")},get warmupData(){return r.live},get newCurrentPageIndex(){return t.enabled("specs.wixDataViewer.NewCurrentPageIndex")},get fetchOnlyConnectedFields(){return t.enabled("specs.wixDataViewer.fetchOnlyConnectedFields")&&!r.livePreview},get fetchOnlyConnectedFieldsIsBlockedByAnotherApp(){return r.veloCodeIsPresentOnCurrentPage||r.blocksAppIsPresentOnSite},get accessibilityBindings(){return t.enabled("specs.wixDataClient.accessibilityBindingsViewer")},get deferredIsDead(){return t.enabled("specs.wixDataViewer.deferredIsDead")},get enableNewCore(){return t.enabled("specs.wixDataViewer.EnableNewCore")},get newCoreFormatters(){return t.enabled("specs.wixDataViewer.NewCoreFormatters")},get newCoreReferences(){return t.enabled("specs.wixDataViewer.NewCoreReferences")},get newCoreLivePreview(){return t.enabled("specs.wixDataViewer.NewCoreLivePreview")},get newCoreExpressions(){return t.enabled("specs.wixDataViewer.NewCoreExpressions")},get newCoreImageStaticBinding(){return t.enabled("specs.wixDataViewer.NewCoreImageStaticBinding")},get newCoreSiteButtonStaticBinding(){return t.enabled("specs.wixDataViewer.NewCoreSiteButtonStaticBinding")}}})({experiments:_,settings:n});const{instance:P,gridAppId:C}=s.settings,O=i.fes?new Cn({httpClient:v,getRequestParams:()=>({instance:P,gridAppId:C})}):new Zn({wixData:p,wixDataSchemas:d||Vm(v,P,C,{baseUrl:f({envIsEditor:n.env.editor,baseUrl:S}),useApiV2:!0})}),b=new so(I),N=new lo(t),D=Wp({automationsClientCreator:()=>(e=>({reportFormEventToAutomationCreator:()=>async(t,r,n,o)=>{const a=t.detailedEventPayload["form-id"].value,i=Ge(t.detailedEventPayload).filter(e=>"form-id"!==e).reduce((e,r)=>{const n=r.split(".").join(":"),{keyName:o,valueType:a,value:i}=t.detailedEventPayload[r];return e[n]={displayName:o,value:i,type:a},e},{}),s={formId:a,pageId:n,submissionTime:new Date,submitterId:o,fields:i,collectionId:r};await e.post("/_serverless/cms-automations/report-cms-form-submission",s)}}))(v),pageId:w.id});return o=new Cp({platform:s,dataFetcher:O,warmupCache:b,staticCache:N,features:i,listenersByEvent:D,logger:h,i18n:R,global:self}),h.log(new Le("databinding/initAppForPage",Le.types.END)),Promise.resolve()}catch(e){return h&&h.log(new n.AppError("App initialisation failed",{cause:e})),Promise.reject(e)}},createControllers:e=>{var t,r;return null!=(t=s)&&t.settings.env.livePreview&&null!=(r=s)&&r.location.baseUrl.startsWith("https://blocks.wix.com")?((e,t)=>{const r=[],n=e(t.filter((e,t)=>"widget"!==e.type||(r.push(t),!1)));return 0===r.length?n:new Array(t.length).fill(void 0).map((e,t)=>{if(!r.length||r[0]!==t)return n.shift();r.shift()})})(p,e):p(e)}}}()})(),i})());
//# sourceMappingURL=app.js.map